(self.webpackChunkrtl=self.webpackChunkrtl||[]).push([[432],{1432:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ECLModule:()=>yc});var a=n(1511),i=n(4573),o=n(2865),s=n(1572),l=n(3722),r=n(5994);function c(t,e){1&t&&s._UZ(0,"mat-progress-bar",3)}let u=(()=>{class t{constructor(t){this.router=t,this.loading=!1,this.router.events.subscribe(t=>{switch(!0){case t instanceof i.OD:this.loading=!0;break;case t instanceof i.m2:case t instanceof i.gk:case t instanceof i.Q3:this.loading=!1}})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-root"]],decls:4,vars:1,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","start stretch",1,"inner-sidenav-content"],["color","primary","mode","indeterminate",4,"ngIf"],["outlet","outlet"],["color","primary","mode","indeterminate"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.YNc(1,c,1,0,"mat-progress-bar",1),s._UZ(2,"router-outlet",null,2),s.qZA()),2&t&&(s.xp6(1),s.Q6J("ngIf",e.loading))},directives:[l.xw,l.yH,l.Wh,a.O5,i.lC,r.pW],styles:[""],data:{animation:[o.g]}}),t})();var d=n(9666),p=n(9568),m=n(5653),h=n(7810),g=n(5291),f=n(9421),x=n(3477),Z=n(3869),y=n(964),A=n(1084),C=n(7592),T=n(7271),S=n(7439),w=n(8055),v=n(377),b=n(5980),q=n(3691);const L=function(t){return{backgroundColor:t}};function _(t,e){if(1&t&&s._UZ(0,"span",6),2&t){const t=s.oxw();s.Q6J("ngStyle",s.VKq(1,L,null==t.information?null:t.information.color))}}function I(t,e){if(1&t&&(s.TgZ(0,"div"),s.TgZ(1,"h4",1),s._uU(2,"Color"),s.qZA(),s.TgZ(3,"div",2),s._UZ(4,"span",7),s._uU(5),s.ALo(6,"uppercase"),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(4),s.Q6J("ngStyle",s.VKq(4,L,null==t.information?null:t.information.color)),s.xp6(1),s.hij(" ",s.lcZ(6,2,null==t.information?null:t.information.color)," ")}}function N(t,e){if(1&t&&(s.TgZ(0,"span",2),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(t)}}let D=(()=>{class t{constructor(t){this.commonService=t,this.chains=[""]}ngOnChanges(){this.chains=[],this.chains.push("Bitcoin "+(this.information.network?this.commonService.titleCase(this.information.network):"Testnet"))}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(A.v))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-node-info"]],inputs:{information:"information",showColorFieldSeparately:"showColorFieldSeparately"},features:[s.TTD],decls:17,vars:5,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch"],[1,"dashboard-info-title"],[1,"overflow-wrap","dashboard-info-value"],["class","dashboard-node-dot dot",3,"ngStyle",4,"ngIf"],[4,"ngIf"],["class","overflow-wrap dashboard-info-value",4,"ngFor","ngForOf"],[1,"dashboard-node-dot","dot",3,"ngStyle"],[1,"dashboard-node-square",3,"ngStyle"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div"),s.TgZ(2,"h4",1),s._uU(3,"Alias"),s.qZA(),s.TgZ(4,"div",2),s._uU(5),s.YNc(6,_,1,3,"span",3),s.qZA(),s.qZA(),s.YNc(7,I,7,6,"div",4),s.TgZ(8,"div"),s.TgZ(9,"h4",1),s._uU(10,"Implementation"),s.qZA(),s.TgZ(11,"div",2),s._uU(12),s.qZA(),s.qZA(),s.TgZ(13,"div"),s.TgZ(14,"h4",1),s._uU(15,"Chain"),s.qZA(),s.YNc(16,N,2,1,"span",5),s.qZA(),s.qZA()),2&t&&(s.xp6(5),s.hij(" ",null==e.information?null:e.information.alias," "),s.xp6(1),s.Q6J("ngIf",!e.showColorFieldSeparately),s.xp6(1),s.Q6J("ngIf",e.showColorFieldSeparately),s.xp6(5),s.Oqu(null!=e.information&&e.information.lnImplementation||null!=e.information&&e.information.version?(null==e.information?null:e.information.lnImplementation)+" "+(null==e.information?null:e.information.version):""),s.xp6(4),s.Q6J("ngForOf",e.chains))},directives:[l.xw,l.yH,l.Wh,a.O5,a.sg,a.PC,v.Zl],pipes:[a.gd],styles:[""]}),t})();function F(t,e){if(1&t&&(s.TgZ(0,"div",2),s.TgZ(1,"div"),s.TgZ(2,"h4",3),s._uU(3,"Lightning"),s.qZA(),s.TgZ(4,"div",4),s._uU(5),s.ALo(6,"number"),s.qZA(),s._UZ(7,"mat-progress-bar",5),s.qZA(),s.TgZ(8,"div"),s.TgZ(9,"h4",3),s._uU(10,"On-chain"),s.qZA(),s.TgZ(11,"div",4),s._uU(12),s.ALo(13,"number"),s.qZA(),s._UZ(14,"mat-progress-bar",5),s.qZA(),s.TgZ(15,"div"),s.TgZ(16,"h4",3),s._uU(17,"Total"),s.qZA(),s.TgZ(18,"div",4),s._uU(19),s.ALo(20,"number"),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(5),s.hij("",s.lcZ(6,5,t.balances.lightning)," Sats"),s.xp6(2),s.s9C("value",t.balances.lightning/t.balances.total*100),s.xp6(5),s.hij("",s.lcZ(13,7,t.balances.onchain)," Sats"),s.xp6(2),s.s9C("value",t.balances.onchain/t.balances.total*100),s.xp6(5),s.hij("",s.lcZ(20,9,t.balances.total)," Sats")}}function U(t,e){if(1&t&&(s.TgZ(0,"div",6),s.TgZ(1,"p"),s._uU(2),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(2),s.Oqu(t.errorMessage)}}let O=(()=>{class t{constructor(){this.balances={onchain:0,lightning:0,total:0}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-balances-info"]],inputs:{balances:"balances",errorMessage:"errorMessage"},decls:3,vars:2,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch",4,"ngIf","ngIfElse"],["errorBlock",""],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch"],["fxLayoutAlign","start",1,"dashboard-info-title"],[1,"overflow-wrap","dashboard-info-value"],["mode","determinate",1,"dashboard-progress-bar",3,"value"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between",1,"p-2"]],template:function(t,e){if(1&t&&(s.YNc(0,F,21,11,"div",0),s.YNc(1,U,3,1,"ng-template",null,1,s.W1O)),2&t){const t=s.MAs(2);s.Q6J("ngIf",""===(null==e.errorMessage?null:e.errorMessage.trim()))("ngIfElse",t)}},directives:[a.O5,l.xw,l.yH,l.Wh,r.pW],pipes:[a.JJ],styles:[""]}),t})();var k=n(6283),R=n(6828),E=n(7679),M=n(7038);function J(t,e){if(1&t&&(s.TgZ(0,"div",19),s.TgZ(1,"span",20),s._uU(2),s.ALo(3,"slice"),s.qZA(),s.TgZ(4,"div",6),s.TgZ(5,"mat-hint",21),s.TgZ(6,"strong",8),s._uU(7,"Local:"),s.qZA(),s._uU(8),s.ALo(9,"number"),s.qZA(),s.TgZ(10,"mat-hint",22),s._UZ(11,"fa-icon",23),s._uU(12),s.ALo(13,"number"),s.qZA(),s.TgZ(14,"mat-hint",24),s.TgZ(15,"strong",8),s._uU(16,"Remote:"),s.qZA(),s._uU(17),s.ALo(18,"number"),s.qZA(),s.qZA(),s._UZ(19,"mat-progress-bar",25),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(3);s.xp6(1),s.s9C("matTooltip",t.alias||t.shortChannelId),s.s9C("matTooltipDisabled",(t.alias||t.shortChannelId).length<26),s.xp6(1),s.AsE("",s.Dn7(3,9,(null==t?null:t.alias)||(null==t?null:t.shortChannelId),0,24),"",((null==t?null:t.alias)||(null==t?null:t.shortChannelId)).length>25?"...":"",""),s.xp6(6),s.hij("",s.xi3(9,13,(null==t?null:t.toLocal)||0,"1.0-0")," Sats"),s.xp6(3),s.Q6J("icon",n.faBalanceScale),s.xp6(1),s.hij(" (",s.lcZ(13,16,(null==t?null:t.balancedness)||0),") "),s.xp6(5),s.hij("",s.xi3(18,18,(null==t?null:t.toRemote)||0,"1.0-0")," Sats"),s.xp6(2),s.s9C("value",t.toLocal&&t.toLocal>0?+t.toLocal/(+t.toLocal+ +t.toRemote)*100:0)}}function P(t,e){if(1&t&&(s.TgZ(0,"div",17),s.YNc(1,J,20,21,"div",18),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngForOf",t.allChannels)}}function Y(t,e){if(1&t&&(s.TgZ(0,"div",3),s.TgZ(1,"div",4),s.TgZ(2,"span",5),s._uU(3,"Total Capacity"),s.qZA(),s.TgZ(4,"div",6),s.TgZ(5,"mat-hint",7),s.TgZ(6,"strong",8),s._uU(7,"Local:"),s.qZA(),s._uU(8),s.ALo(9,"number"),s.qZA(),s.TgZ(10,"mat-hint",9),s._UZ(11,"fa-icon",10),s._uU(12),s.ALo(13,"number"),s.qZA(),s.TgZ(14,"mat-hint",11),s.TgZ(15,"strong",8),s._uU(16,"Remote:"),s.qZA(),s._uU(17),s.ALo(18,"number"),s.qZA(),s.qZA(),s._UZ(19,"mat-progress-bar",12),s.qZA(),s.TgZ(20,"div",13),s._UZ(21,"mat-divider",14),s.qZA(),s.TgZ(22,"div",15),s.YNc(23,P,2,1,"div",16),s.qZA(),s.qZA()),2&t){const t=s.oxw(),e=s.MAs(2);s.xp6(8),s.hij("",s.xi3(9,7,(null==t.channelBalances?null:t.channelBalances.localBalance)||0,"1.0-0")," Sats"),s.xp6(3),s.Q6J("icon",t.faBalanceScale),s.xp6(1),s.hij(" (",s.lcZ(13,10,(null==t.channelBalances?null:t.channelBalances.balancedness)||0),") "),s.xp6(5),s.hij("",s.xi3(18,12,(null==t.channelBalances?null:t.channelBalances.remoteBalance)||0,"1.0-0")," Sats"),s.xp6(2),s.s9C("value",null!=t.channelBalances&&t.channelBalances.localBalance&&(null==t.channelBalances?null:t.channelBalances.localBalance)>0?+(null==t.channelBalances?null:t.channelBalances.localBalance)/(+(null==t.channelBalances?null:t.channelBalances.localBalance)+ +(null==t.channelBalances?null:t.channelBalances.remoteBalance))*100:0),s.xp6(4),s.Q6J("ngIf",t.allChannels&&(null==t.allChannels?null:t.allChannels.length)>0)("ngIfElse",e)}}function Q(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",26),s._uU(1," No channels available. "),s.TgZ(2,"button",27),s.NdJ("click",function(){return s.CHM(t),s.oxw().goToChannels()}),s._uU(3,"Open Channel"),s.qZA(),s.qZA()}}function B(t,e){if(1&t&&(s.TgZ(0,"div",28),s.TgZ(1,"p"),s._uU(2),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(2),s.Oqu(t.errorMessage)}}let H=(()=>{class t{constructor(t){this.router=t,this.faBalanceScale=g.DL8,this.faDumbbell=g.FlN,this.sortBy="Balance Score"}goToChannels(){this.router.navigateByUrl("/ecl/connections")}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channel-capacity-info"]],inputs:{channelBalances:"channelBalances",allChannels:"allChannels",sortBy:"sortBy",errorMessage:"errorMessage"},decls:5,vars:2,consts:[["fxLayout","column","fxLayoutAlign","space-between stretch","fxFlex","100",4,"ngIf","ngIfElse"],["noChannelBlock",""],["errorBlock",""],["fxLayout","column","fxLayoutAlign","space-between stretch","fxFlex","100"],["fxLayout","column","fxFlex","9","fxLayoutAlign","end start"],[1,"dashboard-capacity-header","this-channel-capacity"],["fxLayout","row","fxLayoutAlign","space-between start",1,"w-100"],["fxFlex","40","fxLayoutAlign","start center",1,"font-size-90"],[1,"font-weight-900","mr-5px"],["fxFlex","20","fxLayoutAlign","center center",1,"font-size-90"],["matTooltip","Balance Score",1,"mr-3px",3,"icon"],["fxFlex","40","fxLayoutAlign","end center",1,"font-size-90"],["mode","determinate","color","accent",1,"dashboard-progress-bar","this-channel-bar",3,"value"],["fxLayout","column","fxFlex","3","fxLayoutAlign","end stretch"],[1,"dashboard-divider"],[1,"channels-capacity-scroll",3,"perfectScrollbar"],["fxLayout","column","fxFlex","100",4,"ngIf","ngIfElse"],["fxLayout","column","fxFlex","100"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"dashboard-capacity-header",3,"matTooltip","matTooltipDisabled"],["fxFlex","40","fxLayoutAlign","start center",1,"font-size-90","color-primary"],["fxFlex","20","fxLayoutAlign","center center",1,"font-size-90","color-primary"],["matTooltip","Balance Score",1,"color-primary","mr-3px",3,"icon"],["fxFlex","40","fxLayoutAlign","end center",1,"font-size-90","color-primary"],["mode","determinate",1,"dashboard-progress-bar",3,"value"],["fxLayout","row","fxFlex","100","fxLayoutAlign","space-between start",1,"mt-1","w-100"],["mat-stroked-button","","color","primary","tabindex","1",3,"click"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between",1,"p-2"]],template:function(t,e){if(1&t&&(s.YNc(0,Y,24,15,"div",0),s.YNc(1,Q,4,0,"ng-template",null,1,s.W1O),s.YNc(3,B,3,1,"ng-template",null,2,s.W1O)),2&t){const t=s.MAs(4);s.Q6J("ngIf",""===(null==e.errorMessage?null:e.errorMessage.trim()))("ngIfElse",t)}},directives:[a.O5,l.xw,l.Wh,l.yH,k.bx,C.BN,R.gM,r.pW,E.d,M.$V,a.sg,b.lW],pipes:[a.JJ,a.OU],styles:[".channels-capacity-scroll[_ngcontent-%COMP%]{width:100%;height:100%;overflow-y:hidden}"]}),t})();function z(t,e){if(1&t&&(s.TgZ(0,"div",2),s.TgZ(1,"div",3),s.TgZ(2,"div"),s.TgZ(3,"h4",4),s._uU(4,"Daily"),s.qZA(),s.TgZ(5,"div",5),s._uU(6),s.ALo(7,"number"),s.qZA(),s.qZA(),s.TgZ(8,"div"),s.TgZ(9,"h4",4),s._uU(10,"Weekly"),s.qZA(),s.TgZ(11,"div",5),s._uU(12),s.ALo(13,"number"),s.qZA(),s.qZA(),s.TgZ(14,"div"),s.TgZ(15,"h4",4),s._uU(16,"Monthly"),s.qZA(),s.TgZ(17,"div",5),s._uU(18),s.ALo(19,"number"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(20,"div",3),s.TgZ(21,"div"),s.TgZ(22,"h4",4),s._uU(23,"Transactions"),s.qZA(),s.TgZ(24,"div",5),s._uU(25),s.ALo(26,"number"),s.qZA(),s.qZA(),s.TgZ(27,"div"),s.TgZ(28,"h4",4),s._uU(29,"Transactions"),s.qZA(),s.TgZ(30,"div",5),s._uU(31),s.ALo(32,"number"),s.qZA(),s.qZA(),s.TgZ(33,"div"),s.TgZ(34,"h4",4),s._uU(35,"Transactions"),s.qZA(),s.TgZ(36,"div",5),s._uU(37),s.ALo(38,"number"),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(6),s.hij("",s.lcZ(7,6,null==t.fees?null:t.fees.daily_fee)," Sats"),s.xp6(6),s.hij("",s.lcZ(13,8,null==t.fees?null:t.fees.weekly_fee)," Sats"),s.xp6(6),s.hij("",s.lcZ(19,10,null==t.fees?null:t.fees.monthly_fee)," Sats"),s.xp6(7),s.Oqu(s.lcZ(26,12,null==t.fees?null:t.fees.daily_txs)),s.xp6(6),s.Oqu(s.lcZ(32,14,null==t.fees?null:t.fees.weekly_txs)),s.xp6(6),s.Oqu(s.lcZ(38,16,null==t.fees?null:t.fees.monthly_txs))}}function V(t,e){if(1&t&&(s.TgZ(0,"div",6),s.TgZ(1,"p"),s._uU(2),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(2),s.Oqu(t.errorMessage)}}let G=(()=>{class t{constructor(){this.totalFees=[{name:"Monthly",value:0},{name:"Weekly",value:0},{name:"Daily",value:0}],this.maxFeeValue=100}ngOnChanges(){var t;if(null===(t=this.fees)||void 0===t?void 0:t.monthly_fee){this.totalFees=[{name:"Monthly",value:this.fees.monthly_fee},{name:"Weekly",value:this.fees.weekly_fee},{name:"Daily ",value:this.fees.daily_fee}];const t=Math.ceil(Math.log(this.fees.monthly_fee+1)/Math.LN10),e=Math.pow(10,t-1);this.maxFeeValue=Math.ceil(this.fees.monthly_fee/e)*e/5||100,Object.assign(this,this.totalFees)}else this.totalFees=[{name:"Monthly",value:0},{name:"Weekly",value:0},{name:"Daily",value:0}],this.maxFeeValue=100,Object.assign(this,this.totalFees)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-fee-info"]],inputs:{fees:"fees",errorMessage:"errorMessage"},features:[s.TTD],decls:3,vars:2,consts:[["fxLayout","row","fxFlex","100","fxLayoutAlign","start stretch",4,"ngIf","ngIfElse"],["errorBlock",""],["fxLayout","row","fxFlex","100","fxLayoutAlign","start stretch"],["fxLayout","column","fxFlex","50","fxLayoutAlign","space-between stretch"],["fxLayoutAlign","start",1,"dashboard-info-title"],[1,"overflow-wrap","dashboard-info-value"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between",1,"p-2"]],template:function(t,e){if(1&t&&(s.YNc(0,z,39,18,"div",0),s.YNc(1,V,3,1,"ng-template",null,1,s.W1O)),2&t){const t=s.MAs(2);s.Q6J("ngIf",""===(null==e.errorMessage?null:e.errorMessage.trim()))("ngIfElse",t)}},directives:[a.O5,l.xw,l.yH,l.Wh],pipes:[a.JJ],styles:[""]}),t})();function X(t,e){if(1&t&&(s.TgZ(0,"div",2),s.TgZ(1,"div",3),s.TgZ(2,"div"),s.TgZ(3,"h4",4),s._uU(4,"Active"),s.qZA(),s.TgZ(5,"div",5),s._UZ(6,"span",6),s._uU(7),s.ALo(8,"number"),s.qZA(),s.qZA(),s.TgZ(9,"div"),s.TgZ(10,"h4",4),s._uU(11,"Pending"),s.qZA(),s.TgZ(12,"div",5),s._UZ(13,"span",7),s._uU(14),s.ALo(15,"number"),s.qZA(),s.qZA(),s.TgZ(16,"div"),s.TgZ(17,"h4",4),s._uU(18,"Inactive"),s.qZA(),s.TgZ(19,"div",5),s._UZ(20,"span",8),s._uU(21),s.ALo(22,"number"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(23,"div",3),s.TgZ(24,"div"),s.TgZ(25,"h4",4),s._uU(26,"Capacity"),s.qZA(),s.TgZ(27,"div",5),s._uU(28),s.ALo(29,"number"),s.qZA(),s.qZA(),s.TgZ(30,"div"),s.TgZ(31,"h4",4),s._uU(32,"Capacity"),s.qZA(),s.TgZ(33,"div",5),s._uU(34),s.ALo(35,"number"),s.qZA(),s.qZA(),s.TgZ(36,"div"),s.TgZ(37,"h4",4),s._uU(38,"Capacity"),s.qZA(),s.TgZ(39,"div",5),s._uU(40),s.ALo(41,"number"),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(7),s.Oqu(s.lcZ(8,6,(null==t.channelsStatus.active?null:t.channelsStatus.active.channels)||0)),s.xp6(7),s.Oqu(s.lcZ(15,8,(null==t.channelsStatus.pending?null:t.channelsStatus.pending.channels)||0)),s.xp6(7),s.Oqu(s.lcZ(22,10,(null==t.channelsStatus.inactive?null:t.channelsStatus.inactive.channels)||0)),s.xp6(7),s.hij("",s.lcZ(29,12,(null==t.channelsStatus.active?null:t.channelsStatus.active.capacity)||0)," Sats"),s.xp6(6),s.hij("",s.lcZ(35,14,(null==t.channelsStatus.pending?null:t.channelsStatus.pending.capacity)||0)," Sats"),s.xp6(6),s.hij("",s.lcZ(41,16,(null==t.channelsStatus.inactive?null:t.channelsStatus.inactive.capacity)||0)," Sats")}}function $(t,e){if(1&t&&(s.TgZ(0,"div",9),s.TgZ(1,"p"),s._uU(2),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(2),s.Oqu(t.errorMessage)}}let W=(()=>{class t{constructor(){this.channelsStatus={}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channel-status-info"]],inputs:{channelsStatus:"channelsStatus",errorMessage:"errorMessage"},decls:3,vars:2,consts:[["fxLayout","row","fxFlex","100","fxLayoutAlign","start stretch",4,"ngIf","ngIfElse"],["errorBlock",""],["fxLayout","row","fxFlex","100","fxLayoutAlign","start stretch"],["fxLayout","column","fxFlex","50","fxLayoutAlign","space-between stretch"],["fxLayoutAlign","start",1,"dashboard-info-title"],[1,"overflow-wrap","dashboard-info-value"],[1,"dot","tiny-dot","green"],[1,"dot","tiny-dot","yellow"],[1,"dot","tiny-dot","grey"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between",1,"p-2"]],template:function(t,e){if(1&t&&(s.YNc(0,X,42,18,"div",0),s.YNc(1,$,3,1,"ng-template",null,1,s.W1O)),2&t){const t=s.MAs(2);s.Q6J("ngIf",""===(null==e.errorMessage?null:e.errorMessage.trim()))("ngIfElse",t)}},directives:[a.O5,l.xw,l.yH,l.Wh],pipes:[a.JJ],styles:[""]}),t})();function K(t,e){if(1&t&&(s.TgZ(0,"mat-hint",19),s.TgZ(1,"strong",20),s._uU(2,"Capacity: "),s.qZA(),s._uU(3),s.ALo(4,"number"),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(3),s.hij("",s.xi3(4,1,t.toRemote||0,"1.0-0")," Sats")}}function j(t,e){if(1&t&&(s.TgZ(0,"mat-hint",19),s.TgZ(1,"strong",20),s._uU(2,"Capacity: "),s.qZA(),s._uU(3),s.ALo(4,"number"),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(3),s.hij("",s.xi3(4,1,t.toLocal||0,"1.0-0")," Sats")}}function tt(t,e){if(1&t&&s._UZ(0,"mat-progress-bar",21),2&t){const t=s.oxw().$implicit,e=s.oxw(3);s.s9C("value",e.totalLiquidity>0?(+t.toRemote||0)/e.totalLiquidity*100:0)}}function et(t,e){if(1&t&&s._UZ(0,"mat-progress-bar",21),2&t){const t=s.oxw().$implicit,e=s.oxw(3);s.s9C("value",e.totalLiquidity>0?(+t.toLocal||0)/e.totalLiquidity*100:0)}}function nt(t,e){if(1&t&&(s.TgZ(0,"div",14),s.TgZ(1,"span",15),s._uU(2),s.ALo(3,"slice"),s.qZA(),s.TgZ(4,"div",16),s.YNc(5,K,5,4,"mat-hint",17),s.YNc(6,j,5,4,"mat-hint",17),s.qZA(),s.YNc(7,tt,1,1,"mat-progress-bar",18),s.YNc(8,et,1,1,"mat-progress-bar",18),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(3);s.xp6(1),s.s9C("matTooltip",t.alias||t.shortChannelId),s.s9C("matTooltipDisabled",(t.alias||t.shortChannelId).length<26),s.xp6(1),s.AsE("",s.Dn7(3,8,t.alias||t.shortChannelId,0,24),"",(t.alias||t.shortChannelId).length>25?"...":"",""),s.xp6(3),s.Q6J("ngIf","In"===n.direction),s.xp6(1),s.Q6J("ngIf","Out"===n.direction),s.xp6(1),s.Q6J("ngIf","In"===n.direction),s.xp6(1),s.Q6J("ngIf","Out"===n.direction)}}function at(t,e){if(1&t&&(s.TgZ(0,"div",12),s.YNc(1,nt,9,12,"div",13),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngForOf",t.allChannels)}}const it=function(t,e,n){return{"mb-4":t,"mb-2":e,"mb-1":n}};function ot(t,e){if(1&t&&(s.TgZ(0,"div",3),s.TgZ(1,"div",4),s.TgZ(2,"span",5),s._uU(3,"Total Capacity"),s.qZA(),s.TgZ(4,"mat-hint",6),s._uU(5),s.ALo(6,"number"),s.qZA(),s._UZ(7,"mat-progress-bar",7),s.qZA(),s.TgZ(8,"div",8),s._UZ(9,"mat-divider",9),s.qZA(),s.TgZ(10,"div",10),s.YNc(11,at,2,1,"div",11),s.qZA(),s.qZA()),2&t){const t=s.oxw(),e=s.MAs(2);s.Q6J("ngClass",s.kEZ(7,it,t.screenSize===t.screenSizeEnum.XS||t.screenSize===t.screenSizeEnum.SM,t.screenSize===t.screenSizeEnum.MD,t.screenSize===t.screenSizeEnum.LG||t.screenSize===t.screenSizeEnum.XL)),s.xp6(5),s.hij("",s.xi3(6,4,t.totalLiquidity,"1.0-0")," Sats"),s.xp6(6),s.Q6J("ngIf",t.allChannels&&t.allChannels.length>0)("ngIfElse",e)}}function st(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",24),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).goToChannels()}),s._uU(1,"Open Channel"),s.qZA()}}function lt(t,e){if(1&t&&(s.TgZ(0,"div",22),s._uU(1," No channels available. "),s.YNc(2,st,2,0,"button",23),s.qZA()),2&t){const t=s.oxw();s.xp6(2),s.Q6J("ngIf","Out"===t.direction)}}function rt(t,e){if(1&t&&(s.TgZ(0,"div",25),s.TgZ(1,"p"),s._uU(2),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(2),s.Oqu(t.errorMessage)}}let ct=(()=>{class t{constructor(t,e){this.router=t,this.commonService=e,this.screenSize="",this.screenSizeEnum=f.cu}ngOnInit(){this.screenSize=this.commonService.getScreenSize()}goToChannels(){this.router.navigateByUrl("/ecl/connections")}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(i.F0),s.Y36(A.v))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channel-liquidity-info"]],inputs:{direction:"direction",totalLiquidity:"totalLiquidity",allChannels:"allChannels",errorMessage:"errorMessage"},decls:5,vars:2,consts:[["fxLayout","column","fxLayoutAlign","space-between stretch","fxFlex","100",3,"ngClass",4,"ngIf","ngIfElse"],["noChannelBlock",""],["errorBlock",""],["fxLayout","column","fxLayoutAlign","space-between stretch","fxFlex","100",3,"ngClass"],["fxLayout","column","fxFlex","9","fxLayoutAlign","end start"],[1,"dashboard-capacity-header","this-channel-capacity"],[1,"font-size-90"],["mode","determinate","color","accent","value","100",1,"dashboard-progress-bar","this-channel-bar"],["fxLayout","column","fxFlex","3","fxLayoutAlign","end stretch"],[1,"dashboard-divider"],["fxLayout","column","fxFlex.gt-sm","88","fxFlex","84","fxLayoutAlign","start start",3,"perfectScrollbar"],["fxLayout","column","fxFlex","100","class","w-100",4,"ngIf","ngIfElse"],["fxLayout","column","fxFlex","100",1,"w-100"],["class","mt-2",4,"ngFor","ngForOf"],[1,"mt-2"],[1,"dashboard-capacity-header",3,"matTooltip","matTooltipDisabled"],["fxLayout","row","fxLayoutAlign","space-between start",1,"w-100"],["fxFlex","100","fxLayoutAlign","start center","class","font-size-90 color-primary",4,"ngIf"],["class","dashboard-progress-bar","mode","determinate",3,"value",4,"ngIf"],["fxFlex","100","fxLayoutAlign","start center",1,"font-size-90","color-primary"],[1,"font-weight-900","mr-5px"],["mode","determinate",1,"dashboard-progress-bar",3,"value"],["fxLayout","row","fxFlex","100","fxLayoutAlign","space-between center",1,"mt-1"],["mat-stroked-button","","color","primary","tabindex","1",3,"click",4,"ngIf"],["mat-stroked-button","","color","primary","tabindex","1",3,"click"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between",1,"p-2"]],template:function(t,e){if(1&t&&(s.YNc(0,ot,12,11,"div",0),s.YNc(1,lt,3,1,"ng-template",null,1,s.W1O),s.YNc(3,rt,3,1,"ng-template",null,2,s.W1O)),2&t){const t=s.MAs(4);s.Q6J("ngIf",""===(null==e.errorMessage?null:e.errorMessage.trim()))("ngIfElse",t)}},directives:[a.O5,l.xw,l.Wh,l.yH,a.mk,v.oO,k.bx,r.pW,E.d,M.$V,a.sg,R.gM,b.lW],pipes:[a.JJ,a.OU],styles:[""]}),t})();var ut=n(5109),dt=n(8868),pt=n(3005),mt=n(2464),ht=n(7033),gt=n(4608),ft=n(6124),xt=n(5573),Zt=n(6073),yt=n(6756),At=n(6880),Ct=n(5095),Tt=n(4786),St=n(1522);function wt(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Description is required."),s.qZA())}function vt(t,e){if(1&t&&(s.TgZ(0,"mat-option",25),s._uU(1),s.ALo(2,"titlecase"),s.qZA()),2&t){const t=e.$implicit;s.Q6J("value",t),s.xp6(1),s.Oqu(s.lcZ(2,2,t))}}function bt(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.invoiceError)}}function qt(t,e){if(1&t&&(s.TgZ(0,"div",26),s._UZ(1,"fa-icon",27),s.YNc(2,bt,2,1,"span",11),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("icon",t.faExclamationTriangle),s.xp6(1),s.Q6J("ngIf",""!==t.invoiceError)}}let Lt=(()=>{class t{constructor(t,e,n,a,i,o){this.dialogRef=t,this.data=e,this.store=n,this.decimalPipe=a,this.commonService=i,this.actions=o,this.faExclamationTriangle=g.eHv,this.selNode={},this.description="",this.invoiceValue=null,this.invoiceValueHint="",this.invoicePaymentReq="",this.information={},this.private=!1,this.expiryStep=100,this.pageSize=f.IV,this.timeUnitEnum=f.Qk,this.timeUnits=f.LO,this.selTimeUnit=f.Qk.SECS,this.invoiceError="",this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x]}ngOnInit(){this.pageSize=this.data.pageSize,this.store.select(x.LR).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.selNode=t}),this.store.select(x.yD).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.information=t}),this.actions.pipe((0,p.R)(this.unSubs[2]),(0,dt.h)(t=>t.type===f.lr.UPDATE_API_CALL_STATUS_ECL||t.type===f.lr.ADD_INVOICE_ECL)).subscribe(t=>{t.type===f.lr.ADD_INVOICE_ECL&&this.dialogRef.close(),t.type===f.lr.UPDATE_API_CALL_STATUS_ECL&&t.payload.status===f.Bn.ERROR&&"CreateInvoice"===t.payload.action&&(this.invoiceError=t.payload.message)})}onAddInvoice(t){if(this.invoiceError="",!this.description)return!0;let e=this.expiry?this.expiry:3600;this.selTimeUnit!==f.Qk.SECS&&(e=this.commonService.convertTime(this.expiry,this.selTimeUnit,f.Qk.SECS));let n=null;n=this.invoiceValue?{description:this.description,expireIn:e,amountMsat:1e3*this.invoiceValue}:{description:this.description,expireIn:e},this.store.dispatch((0,ft.Z$)({payload:n}))}resetData(){this.description="",this.invoiceValue=null,this.private=!1,this.expiry=null,this.invoiceValueHint="",this.selTimeUnit=f.Qk.SECS,this.invoiceError=""}onInvoiceValueChange(){this.selNode.fiatConversion&&this.invoiceValue>99&&(this.invoiceValueHint="",this.commonService.convertCurrency(this.invoiceValue,f.NT.SATS,f.NT.OTHER,this.selNode.currencyUnits[2],this.selNode.fiatConversion).pipe((0,p.R)(this.unSubs[3])).subscribe({next:t=>{this.invoiceValueHint="= "+t.symbol+this.decimalPipe.transform(t.OTHER,f.Xz.OTHER)+" "+t.unit},error:t=>{this.invoiceValueHint="Conversion Error: "+t}}))}onTimeUnitChange(t){this.expiry&&this.selTimeUnit!==t.value&&(this.expiry=this.commonService.convertTime(this.expiry,this.selTimeUnit,t.value)),this.selTimeUnit=t.value}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(gt.so),s.Y36(gt.WI),s.Y36(y.yh),s.Y36(a.JJ),s.Y36(A.v),s.Y36(xt.eX))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-create-invoices"]],decls:35,vars:16,consts:[["fxLayout","row"],["fxFlex","100"],["fxLayout","row","fxLayoutAlign","space-between center",1,"modal-info-header"],["fxFlex","95","fxLayoutAlign","start start"],[1,"page-title"],["tabindex","8","fxFlex","5","fxLayoutAlign","center","default","","mat-button","",1,"btn-close-x","p-0",3,"mat-dialog-close"],[1,"padding-gap-x-large"],["fxLayout","row wrap","fxLayoutAlign","start space-between","fxFlex","100"],["addInvoiceForm","ngForm"],["fxFlex","100","fxLayoutAlign","start end"],["matInput","","autoFocus","","placeholder","Description","tabindex","2","name","description","required","",3,"ngModel","ngModelChange"],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","space-between start","fxFlex","100"],["fxFlex","40"],["matInput","","placeholder","Amount","type","number","tabindex","3","name","invValue",3,"ngModel","step","min","ngModelChange","keyup"],["matSuffix",""],["fxFlex","30"],["matInput","","placeholder","Expiry","type","number","name","exp","tabindex","4",3,"ngModel","step","min","ngModelChange"],["fxFlex","26"],["tabindex","5","name","timeUnit",3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","100","class","alert alert-danger mt-1",4,"ngIf"],["fxLayout","row","fxFlex","100","fxLayoutAlign","end center",1,"mt-2"],["mat-stroked-button","","color","primary","tabindex","7","type","reset",1,"mr-1",3,"click"],["mat-flat-button","","color","primary","tabindex","8",3,"click"],[3,"value"],["fxFlex","100",1,"alert","alert-danger","mt-1"],[1,"mr-1","alert-icon",3,"icon"]],template:function(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-card-header",2),s.TgZ(3,"div",3),s.TgZ(4,"span",4),s._uU(5,"Create Invoice"),s.qZA(),s.qZA(),s.TgZ(6,"button",5),s._uU(7,"X"),s.qZA(),s.qZA(),s.TgZ(8,"mat-card-content",6),s.TgZ(9,"form",7,8),s.TgZ(11,"mat-form-field",9),s.TgZ(12,"input",10),s.NdJ("ngModelChange",function(t){return e.description=t}),s.qZA(),s.YNc(13,wt,2,0,"mat-error",11),s.qZA(),s.TgZ(14,"div",12),s.TgZ(15,"mat-form-field",13),s.TgZ(16,"input",14),s.NdJ("ngModelChange",function(t){return e.invoiceValue=t})("keyup",function(){return e.onInvoiceValueChange()}),s.qZA(),s.TgZ(17,"span",15),s._uU(18," Sats "),s.qZA(),s.TgZ(19,"mat-hint"),s._uU(20),s.qZA(),s.qZA(),s.TgZ(21,"mat-form-field",16),s.TgZ(22,"input",17),s.NdJ("ngModelChange",function(t){return e.expiry=t}),s.qZA(),s.TgZ(23,"span",15),s._uU(24),s.ALo(25,"titlecase"),s.qZA(),s.qZA(),s.TgZ(26,"mat-form-field",18),s.TgZ(27,"mat-select",19),s.NdJ("selectionChange",function(t){return e.onTimeUnitChange(t)}),s.YNc(28,vt,3,4,"mat-option",20),s.qZA(),s.qZA(),s.qZA(),s.YNc(29,qt,3,2,"div",21),s.TgZ(30,"div",22),s.TgZ(31,"button",23),s.NdJ("click",function(){return e.resetData()}),s._uU(32,"Clear Field"),s.qZA(),s.TgZ(33,"button",24),s.NdJ("click",function(){s.CHM(t);const n=s.MAs(10);return e.onAddInvoice(n)}),s._uU(34,"Create Invoice"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()}2&t&&(s.xp6(6),s.Q6J("mat-dialog-close",!1),s.xp6(6),s.Q6J("ngModel",e.description),s.xp6(1),s.Q6J("ngIf",!e.description),s.xp6(3),s.Q6J("ngModel",e.invoiceValue)("step",100)("min",1),s.xp6(4),s.Oqu(e.invoiceValueHint),s.xp6(2),s.Q6J("ngModel",e.expiry)("step",e.selTimeUnit===e.timeUnitEnum.SECS?300:e.selTimeUnit===e.timeUnitEnum.MINS?10:e.selTimeUnit===e.timeUnitEnum.HOURS?2:1)("min",1),s.xp6(2),s.hij(" ",s.lcZ(25,14,e.selTimeUnit)," "),s.xp6(3),s.Q6J("value",e.selTimeUnit),s.xp6(1),s.Q6J("ngForOf",e.timeUnits),s.xp6(1),s.Q6J("ngIf",""!==e.invoiceError))},directives:[l.xw,l.yH,S.dk,l.Wh,b.lW,gt.ZT,S.dn,Zt._Y,Zt.JL,Zt.F,k.KE,yt.Nt,Zt.Fj,At.h,Zt.Q7,Zt.JJ,Zt.On,a.O5,Zt.wV,Zt.qQ,Ct.q,k.R9,k.bx,Tt.gD,a.sg,k.TO,St.ey,C.BN],pipes:[a.rS],styles:[".mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}"]}),t})();var _t=n(3921),It=n(3929);function Nt(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Description is required."),s.qZA())}function Dt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"form",4,5),s.TgZ(2,"mat-form-field",6),s.TgZ(3,"input",7),s.NdJ("ngModelChange",function(e){return s.CHM(t),s.oxw().description=e}),s.qZA(),s.YNc(4,Nt,2,0,"mat-error",8),s.qZA(),s.TgZ(5,"mat-form-field",9),s.TgZ(6,"input",10,11),s.NdJ("ngModelChange",function(e){return s.CHM(t),s.oxw().invoiceValue=e})("keyup",function(){return s.CHM(t),s.oxw().onInvoiceValueChange()}),s.qZA(),s.TgZ(8,"span",12),s._uU(9," Sats "),s.qZA(),s.TgZ(10,"mat-hint"),s._uU(11),s.qZA(),s.qZA(),s.TgZ(12,"div",13),s.TgZ(13,"button",14),s.NdJ("click",function(){return s.CHM(t),s.oxw().resetData()}),s._uU(14,"Clear Field"),s.qZA(),s.TgZ(15,"button",15),s.NdJ("click",function(){s.CHM(t);const e=s.MAs(1);return s.oxw().onAddInvoice(e)}),s._uU(16,"Create Invoice"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("ngModel",t.description),s.xp6(1),s.Q6J("ngIf",!t.description),s.xp6(2),s.Q6J("ngModel",t.invoiceValue)("step",100)("min",1),s.xp6(5),s.Oqu(t.invoiceValueHint)}}function Ft(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",16),s.TgZ(1,"button",17),s.NdJ("click",function(){return s.CHM(t),s.oxw().openCreateInvoiceModal()}),s._uU(2,"Create Invoice"),s.qZA(),s.qZA()}}function Ut(t,e){1&t&&s._UZ(0,"mat-progress-bar",47)}function Ot(t,e){1&t&&(s.TgZ(0,"th",48),s._uU(1," Date Created "),s.qZA())}const kt=function(t){return{"mr-0":t}};function Rt(t,e){if(1&t&&s._UZ(0,"span",53),2&t){const t=s.oxw(3);s.Q6J("ngClass",s.VKq(1,kt,t.screenSize===t.screenSizeEnum.XS))}}function Et(t,e){if(1&t&&s._UZ(0,"span",54),2&t){const t=s.oxw(3);s.Q6J("ngClass",s.VKq(1,kt,t.screenSize===t.screenSizeEnum.XS))}}function Mt(t,e){if(1&t&&s._UZ(0,"span",55),2&t){const t=s.oxw(3);s.Q6J("ngClass",s.VKq(1,kt,t.screenSize===t.screenSizeEnum.XS))}}function Jt(t,e){if(1&t&&(s.TgZ(0,"td",49),s.YNc(1,Rt,1,3,"span",50),s.YNc(2,Et,1,3,"span",51),s.YNc(3,Mt,1,3,"span",52),s._uU(4),s.ALo(5,"date"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf","received"===t.status),s.xp6(1),s.Q6J("ngIf","unpaid"===t.status),s.xp6(1),s.Q6J("ngIf",!t.status||"expired"===t.status||"unknown"===t.status),s.xp6(1),s.hij(" ",s.xi3(5,4,1e3*t.timestamp,"dd/MMM/YYYY HH:mm")," ")}}function Pt(t,e){1&t&&(s.TgZ(0,"th",48),s._uU(1," Date Settled "),s.qZA())}function Yt(t,e){if(1&t&&(s.TgZ(0,"td",49),s._uU(1),s.ALo(2,"date"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.xi3(2,1,1e3*t.receivedAt,"dd/MMM/YYYY HH:mm")||"-")}}function Qt(t,e){1&t&&(s.TgZ(0,"th",48),s._uU(1," Description "),s.qZA())}const Bt=function(t){return{"max-width":t}};function Ht(t,e){if(1&t&&(s.TgZ(0,"td",49),s.TgZ(1,"div",56),s.TgZ(2,"span",57),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(1),s.Q6J("ngStyle",s.VKq(2,Bt,n.screenSize===n.screenSizeEnum.XS?"10rem":"32rem")),s.xp6(2),s.Oqu(t.description)}}function zt(t,e){1&t&&(s.TgZ(0,"th",58),s._uU(1," Amount (Sats) "),s.qZA())}function Vt(t,e){if(1&t&&(s.TgZ(0,"td",59),s.TgZ(1,"span",60),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",t.amount?s.xi3(3,1,t.amount,"1.0-0"):"-","")}}function Gt(t,e){1&t&&(s.TgZ(0,"th",58),s._uU(1," Amount Settled (Sats) "),s.qZA())}function Xt(t,e){if(1&t&&(s.TgZ(0,"td",59),s.TgZ(1,"span",60),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",t.amountSettled?s.xi3(3,1,t.amountSettled,"1.0-0"):"-","")}}function $t(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",61),s.TgZ(1,"div",62),s.TgZ(2,"mat-select",63),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",64),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).onDownloadCSV()}),s._uU(5,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}const Wt=function(t){return{"px-3":t}};function Kt(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",65),s.TgZ(1,"div",66),s.TgZ(2,"mat-select",67),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",64),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).onInvoiceClick(e)}),s._uU(5,"View Info"),s.qZA(),s.TgZ(6,"mat-option",64),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).onRefreshInvoice(e)}),s._uU(7,"Refresh"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,Wt,t.screenSize!==t.screenSizeEnum.XS))}}function jt(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No invoice available."),s.qZA())}function te(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting invoices..."),s.qZA())}function ee(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Oqu(t.errorMessage)}}function ne(t,e){if(1&t&&(s.TgZ(0,"td",68),s.YNc(1,jt,2,0,"p",8),s.YNc(2,te,2,0,"p",8),s.YNc(3,ee,2,1,"p",8),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",(!(null!=t.invoices&&t.invoices.data)||(null==t.invoices||null==t.invoices.data?null:t.invoices.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.invoices&&t.invoices.data)||(null==t.invoices||null==t.invoices.data?null:t.invoices.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.invoices&&t.invoices.data)||(null==t.invoices||null==t.invoices.data?null:t.invoices.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const ae=function(t){return{"display-none":t}};function ie(t,e){if(1&t&&s._UZ(0,"tr",69),2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,ae,(null==t.invoices?null:t.invoices.data)&&(null==t.invoices||null==t.invoices.data?null:t.invoices.data.length)>0))}}function oe(t,e){1&t&&s._UZ(0,"tr",70)}function se(t,e){1&t&&s._UZ(0,"tr",71)}const le=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}},re=function(){return["no_invoice"]};function ce(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",18),s.TgZ(1,"div",19),s.TgZ(2,"div",20),s._UZ(3,"fa-icon",21),s.TgZ(4,"span",22),s._uU(5,"Invoices History"),s.qZA(),s.qZA(),s.TgZ(6,"mat-form-field",23),s.TgZ(7,"input",24),s.NdJ("keyup",function(){return s.CHM(t),s.oxw().applyFilter()})("ngModelChange",function(e){return s.CHM(t),s.oxw().selFilter=e}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"div",25),s.YNc(9,Ut,1,0,"mat-progress-bar",26),s.TgZ(10,"table",27,28),s.ynx(12,29),s.YNc(13,Ot,2,0,"th",30),s.YNc(14,Jt,6,7,"td",31),s.BQk(),s.ynx(15,32),s.YNc(16,Pt,2,0,"th",30),s.YNc(17,Yt,3,4,"td",31),s.BQk(),s.ynx(18,33),s.YNc(19,Qt,2,0,"th",30),s.YNc(20,Ht,4,4,"td",31),s.BQk(),s.ynx(21,34),s.YNc(22,zt,2,0,"th",35),s.YNc(23,Vt,4,4,"td",36),s.BQk(),s.ynx(24,37),s.YNc(25,Gt,2,0,"th",35),s.YNc(26,Xt,4,4,"td",36),s.BQk(),s.ynx(27,38),s.YNc(28,$t,6,0,"th",39),s.YNc(29,Kt,8,3,"td",40),s.BQk(),s.ynx(30,41),s.YNc(31,ne,4,3,"td",42),s.BQk(),s.YNc(32,ie,1,3,"tr",43),s.YNc(33,oe,1,0,"tr",44),s.YNc(34,se,1,0,"tr",45),s.qZA(),s.qZA(),s._UZ(35,"mat-paginator",46),s.qZA()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("icon",t.faHistory),s.xp6(4),s.Q6J("ngModel",t.selFilter),s.xp6(2),s.Q6J("ngIf",t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",t.invoices)("ngClass",s.VKq(12,le,""!==t.errorMessage)),s.xp6(22),s.Q6J("matFooterRowDef",s.DdM(14,re)),s.xp6(1),s.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",t.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns),s.xp6(1),s.Q6J("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.screenSize!==t.screenSizeEnum.XS)}}let ue=(()=>{class t{constructor(t,e,n,a,i,o){this.logger=t,this.store=e,this.decimalPipe=n,this.commonService=a,this.datePipe=i,this.actions=o,this.calledFrom="transactions",this.faHistory=g.qO$,this.selNode={},this.newlyAddedInvoiceMemo="",this.newlyAddedInvoiceValue=0,this.description="",this.invoiceValue=null,this.invoiceValueHint="",this.displayedColumns=[],this.invoicePaymentReq="",this.invoiceJSONArr=[],this.information={},this.flgSticky=!1,this.selFilter="",this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["timestamp","amount","actions"]):this.screenSize===f.cu.SM||this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["timestamp","amount","amountSettled","actions"]):(this.flgSticky=!0,this.displayedColumns=["timestamp","receivedAt","description","amount","amountSettled","actions"])}ngOnInit(){this.store.select(x.LR).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.selNode=t}),this.store.select(x.yD).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.information=t}),this.store.select(x.Ef).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.invoiceJSONArr=t.invoices&&t.invoices.length>0?t.invoices:[],this.invoiceJSONArr&&this.invoiceJSONArr.length>0&&this.sort&&this.paginator&&this.loadInvoicesTable(this.invoiceJSONArr),this.logger.info(t)}),this.actions.pipe((0,p.R)(this.unSubs[3]),(0,dt.h)(t=>t.type===f.lr.SET_LOOKUP_ECL||t.type===f.lr.UPDATE_API_CALL_STATUS_ECL)).subscribe(t=>{t.type===f.lr.SET_LOOKUP_ECL&&this.invoiceJSONArr.length>0&&this.sort&&this.paginator&&t.payload&&(this.updateInvoicesData(JSON.parse(JSON.stringify(t.payload))),this.loadInvoicesTable(this.invoiceJSONArr))})}ngAfterViewInit(){this.invoiceJSONArr&&this.invoiceJSONArr.length>0&&this.sort&&this.paginator&&this.loadInvoicesTable(this.invoiceJSONArr)}openCreateInvoiceModal(){this.store.dispatch((0,It.qR)({payload:{data:{pageSize:this.pageSize,component:Lt}}}))}onAddInvoice(t){if(!this.description)return!0;const e=this.expiry?this.expiry:3600;this.newlyAddedInvoiceMemo="ulbl"+Math.random().toString(36).slice(2)+Date.now(),this.newlyAddedInvoiceValue=this.invoiceValue;let n=null;n=this.invoiceValue?{description:this.description,expireIn:e,amountMsat:1e3*this.invoiceValue}:{description:this.description,expireIn:e},this.store.dispatch((0,ft.Z$)({payload:n})),this.resetData()}onInvoiceClick(t){this.store.dispatch((0,It.qR)({payload:{data:{invoice:t,newlyAdded:!1,component:_t.R}}}))}onRefreshInvoice(t){this.store.dispatch((0,ft.n7)({payload:t.paymentHash}))}updateInvoicesData(t){this.invoiceJSONArr=this.invoiceJSONArr.map(e=>e.paymentHash===t.paymentHash?t:e)}loadInvoicesTable(t){this.invoices=new ht.by(t?[...t]:[]),this.invoices.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null,this.invoices.sort=this.sort,this.invoices.filterPredicate=(t,e)=>((t.timestamp?this.datePipe.transform(new Date(1e3*t.timestamp),"dd/MMM/YYYY HH:mm").toLowerCase():"")+JSON.stringify(t).toLowerCase()).includes(e),this.invoices.paginator=this.paginator,this.applyFilter()}resetData(){this.description="",this.invoiceValue=null,this.expiry=null,this.invoiceValueHint=""}applyFilter(){""!==this.selFilter&&(this.invoices.filter=this.selFilter.trim().toLowerCase())}onInvoiceValueChange(){this.selNode.fiatConversion&&this.invoiceValue>99&&(this.invoiceValueHint="",this.commonService.convertCurrency(this.invoiceValue,f.NT.SATS,f.NT.OTHER,this.selNode.currencyUnits[2],this.selNode.fiatConversion).pipe((0,p.R)(this.unSubs[4])).subscribe({next:t=>{this.invoiceValueHint="= "+t.symbol+this.decimalPipe.transform(t.OTHER,f.Xz.OTHER)+" "+t.unit},error:t=>{this.invoiceValueHint="Conversion Error: "+t}}))}onDownloadCSV(){this.invoices.data&&this.invoices.data.length>0&&this.commonService.downloadFile(this.invoices.data,"Invoices")}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(a.JJ),s.Y36(A.v),s.Y36(a.uU),s.Y36(xt.eX))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-lightning-invoices"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},inputs:{calledFrom:"calledFrom"},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Invoices")}])],decls:4,vars:3,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","start stretch"],["fxLayout","row wrap","fxLayoutAlign","stretch start","fxFlex","100",4,"ngIf"],["fxLayout","row",4,"ngIf"],["fxLayout","column","fxLayoutAlign","start stretch",4,"ngIf"],["fxLayout","row wrap","fxLayoutAlign","stretch start","fxFlex","100"],["addInvoiceForm","ngForm"],["fxFlex","100","fxLayoutAlign","space-between stretch"],["matInput","","placeholder","Description","tabindex","2","name","description","required","true",3,"ngModel","ngModelChange"],[4,"ngIf"],["fxFlex","100","fxLayoutAlign","start end"],["matInput","","placeholder","Amount","type","number","tabindex","3","name","invValue",3,"ngModel","step","min","ngModelChange","keyup"],["invcVal","ngModel"],["matSuffix",""],["fxLayout","row",1,"mt-1"],["mat-stroked-button","","color","primary","tabindex","9","type","reset",1,"mr-1",3,"click"],["mat-flat-button","","color","primary","tabindex","10",3,"click"],["fxLayout","row"],["mat-flat-button","","color","primary","tabindex","8",3,"click"],["fxLayout","column","fxLayoutAlign","start stretch"],["fxLayout","column","fxLayoutAlign","start stretch","fxLayout.gt-sm","row wrap",1,"page-sub-title-container","mt-1"],["fxFlex","70","fxLayoutAlign","start start","fxLayoutAlign.gt-sm","start center"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxFlex","30","fxLayoutAlign","start end"],["matInput","","placeholder","Filter",3,"ngModel","keyup","ngModelChange"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","timestamp"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","receivedAt"],["matColumnDef","description"],["matColumnDef","amount"],["mat-header-cell","","mat-sort-header","","arrowPosition","before","class","pr-3",4,"matHeaderCellDef"],["mat-cell","","class","pr-3",4,"matCellDef"],["matColumnDef","amountSettled"],["matColumnDef","actions"],["mat-header-cell","","class","px-3",4,"matHeaderCellDef"],["mat-cell","","fxLayoutAlign","end center",3,"ngClass",4,"matCellDef"],["matColumnDef","no_invoice"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["class","dot green","matTooltip","Received","matTooltipPosition","right",3,"ngClass",4,"ngIf"],["class","dot yellow","matTooltip","Unpaid","matTooltipPosition","right",3,"ngClass",4,"ngIf"],["class","dot red","matTooltip","Expired/Unknown","matTooltipPosition","right",3,"ngClass",4,"ngIf"],["matTooltip","Received","matTooltipPosition","right",1,"dot","green",3,"ngClass"],["matTooltip","Unpaid","matTooltipPosition","right",1,"dot","yellow",3,"ngClass"],["matTooltip","Expired/Unknown","matTooltipPosition","right",1,"dot","red",3,"ngClass"],[1,"ellipsis-parent",3,"ngStyle"],[1,"ellipsis-child"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",1,"pr-3"],["mat-cell","",1,"pr-3"],["fxLayoutAlign","end center"],["mat-header-cell","",1,"px-3"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",3,"ngClass"],["fxLayoutAlign","center center",1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","4",1,"mr-0"],["mat-footer-cell","","colspan","4"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.YNc(1,Dt,17,6,"form",1),s.YNc(2,Ft,3,0,"div",2),s.YNc(3,ce,36,15,"div",3),s.qZA()),2&t&&(s.xp6(1),s.Q6J("ngIf","home"===e.calledFrom),s.xp6(1),s.Q6J("ngIf","transactions"===e.calledFrom),s.xp6(1),s.Q6J("ngIf","transactions"===e.calledFrom))},directives:[l.xw,l.yH,l.Wh,a.O5,Zt._Y,Zt.JL,Zt.F,k.KE,yt.Nt,Zt.Fj,Zt.Q7,Zt.JJ,Zt.On,Zt.wV,Zt.qQ,Ct.q,k.R9,k.bx,b.lW,k.TO,C.BN,M.$V,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,R.gM,a.PC,v.Zl,Tt.gD,Tt.$L,St.ey,ht.yh,ht.Q2,ht.XQ,ht.Gk],pipes:[a.uU,a.JJ],styles:[".mat-column-description[_ngcontent-%COMP%]{flex:0 0 15%;width:15%}.mat-column-description[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%]{display:flex}.mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}"]}),t})();var de=n(9056),pe=n(4147),me=n(3556);const he=["paymentReq"];function ge(t,e){if(1&t&&(s.TgZ(0,"mat-hint"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.paymentDecodedHint)}}function fe(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Payment request is required."),s.qZA())}function xe(t,e){if(1&t&&(s.TgZ(0,"mat-error"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.paymentDecodedHint)}}function Ze(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Payment amount is required."),s.qZA())}function ye(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"mat-form-field",1),s.TgZ(1,"input",17,18),s.NdJ("ngModelChange",function(e){return s.CHM(t),s.oxw().paymentAmount=e})("change",function(e){return s.CHM(t),s.oxw().onAmountChange(e)}),s.qZA(),s.TgZ(3,"mat-hint"),s._uU(4,"It is a zero amount invoice, enter amount to be paid."),s.qZA(),s.YNc(5,Ze,2,0,"mat-error",11),s.qZA()}if(2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngModel",t.paymentAmount),s.xp6(4),s.Q6J("ngIf",!t.paymentAmount)}}function Ae(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.paymentError)}}function Ce(t,e){if(1&t&&(s.TgZ(0,"div",19),s._UZ(1,"fa-icon",20),s.YNc(2,Ae,2,1,"span",11),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("icon",t.faExclamationTriangle),s.xp6(1),s.Q6J("ngIf",""!==t.paymentError)}}let Te=(()=>{class t{constructor(t,e,n,a,i,o,s,l){this.dialogRef=t,this.store=e,this.eclEffects=n,this.logger=a,this.commonService=i,this.decimalPipe=o,this.actions=s,this.dataService=l,this.faExclamationTriangle=g.eHv,this.selNode={},this.paymentDecoded={},this.zeroAmtInvoice=!1,this.paymentAmount=null,this.paymentRequest="",this.paymentDecodedHint="",this.selActiveChannel={},this.activeChannels={},this.feeLimit=null,this.selFeeLimitType=f.Vc[0],this.feeLimitTypes=f.Vc,this.paymentError="",this.unSubs=[new d.x,new d.x,new d.x,new d.x]}ngOnInit(){this.store.select(x.LR).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.selNode=t}),this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.activeChannels=t.activeChannels,this.logger.info(t)}),this.actions.pipe((0,p.R)(this.unSubs[1]),(0,dt.h)(t=>t.type===f.lr.UPDATE_API_CALL_STATUS_ECL||t.type===f.lr.SEND_PAYMENT_STATUS_ECL)).subscribe(t=>{t.type===f.lr.SEND_PAYMENT_STATUS_ECL&&this.dialogRef.close(),t.type===f.lr.UPDATE_API_CALL_STATUS_ECL&&t.payload.status===f.Bn.ERROR&&"SendPayment"===t.payload.action&&(delete this.paymentDecoded.amount,this.paymentError=t.payload.message)})}onSendPayment(){if(!this.paymentRequest)return!0;this.paymentDecoded.timestamp?this.sendPayment():(this.paymentAmount=null,this.paymentError="",this.paymentDecodedHint="",this.paymentReq.control.setErrors(null),this.dataService.decodePayment(this.paymentRequest,!0).pipe((0,de.q)(1)).subscribe({next:t=>{this.paymentDecoded=t,this.paymentDecoded.timestamp&&!this.paymentDecoded.amount?(this.paymentDecoded.amount=0,this.zeroAmtInvoice=!0,this.paymentDecodedHint="Zero Amount Invoice | Memo: "+this.paymentDecoded.description):(this.zeroAmtInvoice=!1,this.selNode.fiatConversion?this.commonService.convertCurrency(+this.paymentDecoded.amount,f.NT.SATS,f.NT.OTHER,this.selNode.currencyUnits[2],this.selNode.fiatConversion).pipe((0,p.R)(this.unSubs[2])).subscribe({next:t=>{this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats ("+t.symbol+this.decimalPipe.transform(t.OTHER?t.OTHER:0,f.Xz.OTHER)+") | Memo: "+this.paymentDecoded.description},error:t=>{this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount/1e3:0)+" Sats | Memo: "+this.paymentDecoded.description+". Unable to convert currency."}}):this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats | Memo: "+this.paymentDecoded.description)},error:t=>{this.logger.error(t),this.paymentDecodedHint="ERROR: "+(t.message?t.message:"string"==typeof t?t:JSON.stringify(t)),this.paymentReq.control.setErrors({decodeError:!0})}}))}sendPayment(){this.store.dispatch((0,ft.oV)(this.zeroAmtInvoice?{payload:{invoice:this.paymentRequest,amountMsat:1e3*this.paymentAmount,fromDialog:!0}}:{payload:{invoice:this.paymentRequest,fromDialog:!0}}))}onPaymentRequestEntry(t){this.paymentRequest=t&&"string"==typeof t?t.trim():t,this.paymentError="",this.paymentDecodedHint="",this.zeroAmtInvoice=!1,this.paymentRequest&&this.paymentRequest.length>100&&(this.paymentReq.control.setErrors(null),this.zeroAmtInvoice=!1,this.dataService.decodePayment(this.paymentRequest,!0).pipe((0,de.q)(1)).subscribe({next:t=>{this.paymentDecoded=t,this.paymentDecoded.timestamp&&!this.paymentDecoded.amount?(this.paymentDecoded.amount=0,this.zeroAmtInvoice=!0,this.paymentDecodedHint="Zero Amount Invoice | Memo: "+this.paymentDecoded.description):(this.zeroAmtInvoice=!1,this.selNode.fiatConversion?this.commonService.convertCurrency(+this.paymentDecoded.amount,f.NT.SATS,f.NT.OTHER,this.selNode.currencyUnits[2],this.selNode.fiatConversion).pipe((0,p.R)(this.unSubs[3])).subscribe({next:t=>{this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats ("+t.symbol+this.decimalPipe.transform(t.OTHER?t.OTHER:0,f.Xz.OTHER)+") | Memo: "+this.paymentDecoded.description},error:t=>{this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats | Memo: "+this.paymentDecoded.description+". Unable to convert currency."}}):this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats | Memo: "+this.paymentDecoded.description)},error:t=>{this.logger.error(t),this.paymentDecodedHint="ERROR: "+(t.message?t.message:"string"==typeof t?t:JSON.stringify(t)),this.paymentReq.control.setErrors({decodeError:!0})}}))}onAmountChange(t){delete this.paymentDecoded.amount,this.paymentDecoded.amount=t}resetData(){this.paymentDecoded={},this.paymentRequest="",this.selActiveChannel=null,this.feeLimit=null,this.selFeeLimitType=f.Vc[0],this.paymentReq.control.setErrors(null),this.paymentError="",this.paymentDecodedHint="",this.zeroAmtInvoice=!1}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(gt.so),s.Y36(y.yh),s.Y36(pe.o),s.Y36(Z.mQ),s.Y36(A.v),s.Y36(a.JJ),s.Y36(xt.eX),s.Y36(me.D))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-lightning-send-payments"]],viewQuery:function(t,e){if(1&t&&s.Gf(he,5),2&t){let t;s.iGM(t=s.CRH())&&(e.paymentReq=t.first)}},decls:24,vars:7,consts:[["fxLayout","row"],["fxFlex","100"],["fxLayout","row","fxLayoutAlign","space-between center",1,"modal-info-header"],["fxFlex","95","fxLayoutAlign","start start"],[1,"page-title"],["tabindex","8","fxFlex","5","fxLayoutAlign","center","default","","mat-button","",1,"btn-close-x","p-0",3,"mat-dialog-close"],[1,"padding-gap-x-large"],["fxLayoutAlign","space-between stretch","fxLayout","column"],["sendPaymentForm","ngForm"],["autoFocus","","matInput","","placeholder","Payment Request","name","paymentRequest","tabindex","1","required","",3,"ngModel","ngModelChange","matTextareaAutosize"],["paymentReq","ngModel"],[4,"ngIf"],["fxFlex","100",4,"ngIf"],["fxFlex","100","class","alert alert-danger mt-1",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center",1,"mt-2"],["mat-stroked-button","","color","primary","tabindex","2","type","reset",1,"mr-1",3,"click"],["mat-flat-button","","color","primary","tabindex","3",3,"click"],["matInput","","placeholder","Amount (Sats)","name","amount","tabindex","2","required","",3,"ngModel","ngModelChange","change"],["paymentAmt","ngModel"],["fxFlex","100",1,"alert","alert-danger","mt-1"],[1,"mr-1","alert-icon",3,"icon"]],template:function(t,e){if(1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-card-header",2),s.TgZ(3,"div",3),s.TgZ(4,"span",4),s._uU(5,"Send Payment"),s.qZA(),s.qZA(),s.TgZ(6,"button",5),s._uU(7,"X"),s.qZA(),s.qZA(),s.TgZ(8,"mat-card-content",6),s.TgZ(9,"form",7,8),s.TgZ(11,"mat-form-field",1),s.TgZ(12,"textarea",9,10),s.NdJ("ngModelChange",function(t){return e.onPaymentRequestEntry(t)})("matTextareaAutosize",function(){return!0}),s.qZA(),s.YNc(14,ge,2,1,"mat-hint",11),s.YNc(15,fe,2,0,"mat-error",11),s.YNc(16,xe,2,1,"mat-error",11),s.qZA(),s.YNc(17,ye,6,2,"mat-form-field",12),s.YNc(18,Ce,3,2,"div",13),s.TgZ(19,"div",14),s.TgZ(20,"button",15),s.NdJ("click",function(){return e.resetData()}),s._uU(21,"Clear Fields"),s.qZA(),s.TgZ(22,"button",16),s.NdJ("click",function(){return e.onSendPayment()}),s._uU(23,"Send Payment"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.MAs(13);s.xp6(6),s.Q6J("mat-dialog-close",!1),s.xp6(6),s.Q6J("ngModel",e.paymentRequest),s.xp6(2),s.Q6J("ngIf",e.paymentRequest&&""!==e.paymentDecodedHint),s.xp6(1),s.Q6J("ngIf",!e.paymentRequest),s.xp6(1),s.Q6J("ngIf",null==t.errors?null:t.errors.decodeError),s.xp6(1),s.Q6J("ngIf",e.zeroAmtInvoice),s.xp6(1),s.Q6J("ngIf",""!==e.paymentError)}},directives:[l.xw,l.yH,S.dk,l.Wh,b.lW,gt.ZT,S.dn,Zt._Y,Zt.JL,Zt.F,k.KE,yt.Nt,Zt.Fj,yt.D7,At.h,Zt.Q7,Zt.JJ,Zt.On,a.O5,k.bx,k.TO,C.BN],styles:[".mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}.mat-column-payment_hash[_ngcontent-%COMP%]{flex:1 1 20%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),t})();var Se=n(5001);const we=["scrollContainer"];function ve(t,e){if(1&t&&(s.TgZ(0,"div",9),s.TgZ(1,"div",1),s.TgZ(2,"h4",11),s._uU(3,"Description"),s.qZA(),s.TgZ(4,"span",12),s._uU(5),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(5),s.Oqu(t.description)}}function be(t,e){1&t&&s._UZ(0,"mat-divider",14)}function qe(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"mat-expansion-panel",23),s.NdJ("opened",function(){return s.CHM(t),s.oxw().onExpansionOpen(!0)})("closed",function(){return s.CHM(t),s.oxw().onExpansionOpen(!1)}),s.TgZ(1,"mat-expansion-panel-header"),s.TgZ(2,"mat-panel-title"),s.TgZ(3,"h4",24),s._uU(4),s.qZA(),s.TgZ(5,"h4",25),s._uU(6),s.ALo(7,"number"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"div",8),s.TgZ(9,"div",9),s.TgZ(10,"div",26),s.TgZ(11,"h4",11),s._uU(12,"Fees (mSats)"),s.qZA(),s.TgZ(13,"span",12),s._uU(14),s.ALo(15,"number"),s.qZA(),s.qZA(),s.TgZ(16,"div",26),s.TgZ(17,"h4",11),s._uU(18,"Date/Time"),s.qZA(),s.TgZ(19,"span",12),s._uU(20),s.ALo(21,"date"),s.qZA(),s.qZA(),s.qZA(),s._UZ(22,"mat-divider",14),s.TgZ(23,"div",9),s.TgZ(24,"div",1),s.TgZ(25,"h4",11),s._uU(26,"ID"),s.qZA(),s.TgZ(27,"span",27),s._uU(28),s.qZA(),s.qZA(),s.qZA(),s._UZ(29,"mat-divider",14),s.TgZ(30,"div",9),s.TgZ(31,"div",1),s.TgZ(32,"h4",11),s._uU(33,"To Channel"),s.qZA(),s.TgZ(34,"span",27),s._uU(35),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,n=e.index,a=s.oxw();s.Q6J("expanded",a.expansionOpen),s.xp6(4),s.hij("Part ",n+1,""),s.xp6(2),s.hij("",s.lcZ(7,7,t.amount)," (Sats)"),s.xp6(8),s.Oqu(s.lcZ(15,9,t.feesPaid)),s.xp6(6),s.Oqu(s.xi3(21,11,t.timestamp,"dd/MMM/YYYY HH:mm")),s.xp6(8),s.Oqu(t.id),s.xp6(7),s.Oqu(t.toChannelAlias)}}let Le=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.description=null,this.shouldScroll=!0,this.expansionOpen=!0}ngOnInit(){this.payment=this.data.payment,this.data.sentPaymentInfo.length>0&&this.data.sentPaymentInfo[0].paymentRequest&&this.data.sentPaymentInfo[0].paymentRequest.description&&""!==this.data.sentPaymentInfo[0].paymentRequest.description&&(this.description=this.data.sentPaymentInfo[0].paymentRequest.description)}ngAfterViewChecked(){this.shouldScroll=this.scrollContainer.nativeElement.classList.value.includes("ps--active-y")}onScrollDown(){this.scrollContainer.nativeElement.scrollTop=this.scrollContainer.nativeElement.scrollTop+62.6}onExpansionOpen(t){this.expansionOpen=t}onClose(){this.dialogRef.close(!1)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(gt.so),s.Y36(gt.WI))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-payment-information"]],viewQuery:function(t,e){if(1&t&&s.Gf(we,5),2&t){let t;s.iGM(t=s.CRH())&&(e.scrollContainer=t.first)}},decls:66,vars:15,consts:[["fxLayout","column","fxLayout.gt-sm","row","fxLayoutAlign","space-between stretch"],["fxFlex","100"],["fxLayout","row","fxLayoutAlign","space-between center",1,"modal-info-header"],["fxFlex","95","fxLayoutAlign","start start"],[1,"page-title"],["tabindex","3","fxFlex","5","fxLayoutAlign","center","mat-button","",1,"btn-close-x","p-0",3,"click"],[1,"h-40","padding-gap-x-large",3,"perfectScrollbar"],["scrollContainer",""],["fxLayout","column"],["fxLayout","row"],["fxFlex","30"],["fxLayoutAlign","start",1,"font-bold-500"],[1,"foreground-secondary-text"],["fxFlex","70"],[1,"w-100","my-1"],["fxLayout","row",4,"ngIf"],["class","w-100 my-1",4,"ngIf"],["class","flat-expansion-panel my-1",3,"expanded","opened","closed",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start end",1,"btn-sticky-container","padding-gap-x-large"],["mat-mini-fab","","aria-label","Scroll Down","fxLayoutAlign","center center",3,"click"],["fxLayoutAlign","center center"],["fxLayout","row","fxLayoutAlign","end center",1,"padding-gap-x-large","padding-gap-bottom-large"],["fxLayoutAlign","center center","tabindex","1","mat-stroked-button","","color","primary","type","button","default","",1,"mr-1",3,"mat-dialog-close"],[1,"flat-expansion-panel","my-1",3,"expanded","opened","closed"],["fxFlex","30","fxLayoutAlign","start",1,"font-bold-500"],["fxFlex","70","fxLayoutAlign","start",1,"font-bold-500"],["fxFlex","50"],[1,"overflow-wrap","foreground-secondary-text"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-card-header",2),s.TgZ(3,"div",3),s.TgZ(4,"span",4),s._uU(5,"Payment Information"),s.qZA(),s.qZA(),s.TgZ(6,"button",5),s.NdJ("click",function(){return e.onClose()}),s._uU(7,"X"),s.qZA(),s.qZA(),s.TgZ(8,"mat-card-content",6,7),s.TgZ(10,"div",8),s.TgZ(11,"div",9),s.TgZ(12,"div",10),s.TgZ(13,"h4",11),s._uU(14,"Amount (Sats)"),s.qZA(),s.TgZ(15,"span",12),s._uU(16),s.ALo(17,"number"),s.qZA(),s.qZA(),s.TgZ(18,"div",13),s.TgZ(19,"h4",11),s._uU(20,"Date/Time"),s.qZA(),s.TgZ(21,"span",12),s._uU(22),s.ALo(23,"date"),s.qZA(),s.qZA(),s.qZA(),s._UZ(24,"mat-divider",14),s.TgZ(25,"div",9),s.TgZ(26,"div",1),s.TgZ(27,"h4",11),s._uU(28,"ID"),s.qZA(),s.TgZ(29,"span",12),s._uU(30),s.qZA(),s.qZA(),s.qZA(),s._UZ(31,"mat-divider",14),s.TgZ(32,"div",9),s.TgZ(33,"div",1),s.TgZ(34,"h4",11),s._uU(35,"Payment Hash"),s.qZA(),s.TgZ(36,"span",12),s._uU(37),s.qZA(),s.qZA(),s.qZA(),s._UZ(38,"mat-divider",14),s.TgZ(39,"div",9),s.TgZ(40,"div",1),s.TgZ(41,"h4",11),s._uU(42,"Payment Preimage"),s.qZA(),s.TgZ(43,"span",12),s._uU(44),s.qZA(),s.qZA(),s.qZA(),s._UZ(45,"mat-divider",14),s.TgZ(46,"div",9),s.TgZ(47,"div",1),s.TgZ(48,"h4",11),s._uU(49,"Recipient Node"),s.qZA(),s.TgZ(50,"span",12),s._uU(51),s.qZA(),s.qZA(),s.qZA(),s._UZ(52,"mat-divider",14),s.YNc(53,ve,6,1,"div",15),s.YNc(54,be,1,0,"mat-divider",16),s.TgZ(55,"div",9),s.TgZ(56,"div",1),s.TgZ(57,"mat-accordion"),s.YNc(58,qe,36,14,"mat-expansion-panel",17),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(59,"div",18),s.TgZ(60,"button",19),s.NdJ("click",function(){return e.onScrollDown()}),s.TgZ(61,"mat-icon",20),s._uU(62,"arrow_downward"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(63,"div",21),s.TgZ(64,"button",22),s._uU(65,"OK"),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(16),s.Oqu(s.lcZ(17,10,e.payment.recipientAmount)),s.xp6(6),s.Oqu(s.xi3(23,12,e.payment.firstPartTimestamp,"dd/MMM/YYYY HH:mm")),s.xp6(8),s.Oqu(e.payment.id),s.xp6(7),s.Oqu(e.payment.paymentHash),s.xp6(7),s.Oqu(e.payment.paymentPreimage),s.xp6(7),s.Oqu(e.payment.recipientNodeAlias),s.xp6(2),s.Q6J("ngIf",e.description),s.xp6(1),s.Q6J("ngIf",e.description),s.xp6(4),s.Q6J("ngForOf",e.payment.parts),s.xp6(6),s.Q6J("mat-dialog-close",!1))},directives:[l.xw,l.Wh,l.yH,S.dk,b.lW,S.dn,M.$V,E.d,a.O5,Se.pp,a.sg,q.Hw,gt.ZT,Se.ib,Se.yz,Se.yK],pipes:[a.JJ,a.uU],styles:[""]}),t})();var _e=n(8914);const Ie=["sendPaymentForm"];function Ne(t,e){if(1&t&&(s.TgZ(0,"mat-hint"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.paymentDecodedHint)}}function De(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Payment request is required."),s.qZA())}function Fe(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"form",4,5),s.TgZ(2,"mat-form-field",6),s.TgZ(3,"textarea",7,8),s.NdJ("ngModelChange",function(e){return s.CHM(t),s.oxw().onPaymentRequestEntry(e)})("matTextareaAutosize",function(){return!0}),s.qZA(),s.YNc(5,Ne,2,1,"mat-hint",9),s.YNc(6,De,2,0,"mat-error",9),s.qZA(),s.TgZ(7,"div",10),s.TgZ(8,"button",11),s.NdJ("click",function(){return s.CHM(t),s.oxw().resetData()}),s._uU(9,"Clear Field"),s.qZA(),s.TgZ(10,"button",12),s.NdJ("click",function(){return s.CHM(t),s.oxw().onSendPayment()}),s._uU(11,"Send Payment"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("ngModel",t.paymentRequest),s.xp6(2),s.Q6J("ngIf",t.paymentRequest&&""!==t.paymentDecodedHint),s.xp6(1),s.Q6J("ngIf",!t.paymentRequest)}}function Ue(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",13),s.TgZ(1,"button",12),s.NdJ("click",function(){return s.CHM(t),s.oxw().openSendPaymentModal()}),s._uU(2,"Send Payment"),s.qZA(),s.qZA()}}function Oe(t,e){1&t&&s._UZ(0,"mat-progress-bar",48)}function ke(t,e){1&t&&(s.TgZ(0,"th",49),s._uU(1,"Date/Time"),s.qZA())}function Re(t,e){if(1&t&&(s.TgZ(0,"td",50),s._uU(1),s.ALo(2,"date"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.xi3(2,1,null==t?null:t.firstPartTimestamp,"dd/MMM/YYYY HH:mm"))}}function Ee(t,e){1&t&&(s.TgZ(0,"th",49),s._uU(1,"ID"),s.qZA())}const Me=function(t){return{"max-width":t}};function Je(t,e){if(1&t&&(s.TgZ(0,"td",50),s.TgZ(1,"div",51),s.TgZ(2,"span",52),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(1),s.Q6J("ngStyle",s.VKq(2,Me,n.screenSize===n.screenSizeEnum.XS?"10rem":"22rem")),s.xp6(2),s.Oqu(t.id)}}function Pe(t,e){1&t&&(s.TgZ(0,"th",49),s._uU(1,"Destination"),s.qZA())}function Ye(t,e){if(1&t&&(s.TgZ(0,"td",50),s.TgZ(1,"div",51),s.TgZ(2,"span",52),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(1),s.Q6J("ngStyle",s.VKq(2,Me,n.screenSize===n.screenSizeEnum.XS?"10rem":"22rem")),s.xp6(2),s.Oqu(t.recipientNodeAlias)}}function Qe(t,e){1&t&&(s.TgZ(0,"th",53),s._uU(1,"Amount (Sats)"),s.qZA())}function Be(t,e){if(1&t&&(s.TgZ(0,"td",50),s.TgZ(1,"span",54),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,null==t?null:t.recipientAmount))}}function He(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",55),s.TgZ(1,"div",56),s.TgZ(2,"mat-select",57),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",58),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).onDownloadCSV()}),s._uU(5,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function ze(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",59),s.TgZ(1,"button",60),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).onPaymentClick(e)}),s._uU(2,"View Info"),s.qZA(),s.qZA()}}function Ve(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No payment available."),s.qZA())}function Ge(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting payments..."),s.qZA())}function Xe(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Oqu(t.errorMessage)}}function $e(t,e){if(1&t&&(s.TgZ(0,"td",61),s.YNc(1,Ve,2,0,"p",9),s.YNc(2,Ge,2,0,"p",9),s.YNc(3,Xe,2,1,"p",9),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",(!(null!=t.payments&&t.payments.data)||(null==t.payments||null==t.payments.data?null:t.payments.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.payments&&t.payments.data)||(null==t.payments||null==t.payments.data?null:t.payments.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.payments&&t.payments.data)||(null==t.payments||null==t.payments.data?null:t.payments.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}function We(t,e){if(1&t&&(s.TgZ(0,"span",64),s._uU(1),s.ALo(2,"date"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.xi3(2,1,t.timestamp,"dd/MMM/YYYY HH:mm")," ")}}function Ke(t,e){if(1&t&&(s.ynx(0),s.YNc(1,We,3,4,"span",63),s.BQk()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.Q6J("ngForOf",null==t?null:t.parts)}}function je(t,e){if(1&t&&(s.TgZ(0,"td",50),s.TgZ(1,"span",62),s._uU(2),s.qZA(),s.YNc(3,Ke,2,1,"ng-container",9),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" Total Attempts: ",null==t||null==t.parts?null:t.parts.length," "),s.xp6(1),s.Q6J("ngIf",t.is_expanded)}}function tn(t,e){if(1&t&&(s.TgZ(0,"span",62),s.TgZ(1,"span",65),s.TgZ(2,"span",52),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(4);s.xp6(1),s.Q6J("ngStyle",s.VKq(2,Me,n.screenSize===n.screenSizeEnum.XS?"10rem":"22rem")),s.xp6(2),s.Oqu(t.id)}}function en(t,e){if(1&t&&(s.TgZ(0,"span"),s.YNc(1,tn,4,4,"span",66),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.Q6J("ngForOf",null==t?null:t.parts)}}function nn(t,e){if(1&t&&(s.TgZ(0,"td",50),s.TgZ(1,"div",65),s.TgZ(2,"span",52),s._uU(3),s.qZA(),s.qZA(),s.YNc(4,en,2,1,"span",9),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(1),s.Q6J("ngStyle",s.VKq(3,Me,n.screenSize===n.screenSizeEnum.XS?"10rem":"22rem")),s.xp6(2),s.Oqu(t.id),s.xp6(1),s.Q6J("ngIf",t.is_expanded)}}function an(t,e){if(1&t&&(s.TgZ(0,"span",62),s.TgZ(1,"span",65),s.TgZ(2,"span",52),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(4);s.xp6(1),s.Q6J("ngStyle",s.VKq(2,Me,n.screenSize===n.screenSizeEnum.XS?"10rem":"22rem")),s.xp6(2),s.Oqu(t.toChannelAlias)}}function on(t,e){if(1&t&&(s.TgZ(0,"span"),s.YNc(1,an,4,4,"span",66),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.Q6J("ngForOf",null==t?null:t.parts)}}function sn(t,e){if(1&t&&(s.TgZ(0,"td",50),s.TgZ(1,"div",65),s.TgZ(2,"span",52),s._uU(3),s.qZA(),s.qZA(),s.YNc(4,on,2,1,"span",9),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(1),s.Q6J("ngStyle",s.VKq(3,Me,n.screenSize===n.screenSizeEnum.XS?"10rem":"22rem")),s.xp6(2),s.Oqu(null==t?null:t.recipientNodeAlias),s.xp6(1),s.Q6J("ngIf",t.is_expanded)}}function ln(t,e){if(1&t&&(s.TgZ(0,"span",67),s._uU(1),s.ALo(2,"number"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.xi3(2,1,t.amount,"1.0-0")," ")}}function rn(t,e){if(1&t&&(s.TgZ(0,"span"),s.YNc(1,ln,3,4,"span",68),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.Q6J("ngForOf",null==t?null:t.parts)}}function cn(t,e){if(1&t&&(s.TgZ(0,"td",50),s.TgZ(1,"span",67),s._uU(2),s.ALo(3,"number"),s.qZA(),s.YNc(4,rn,2,1,"span",9),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.xi3(3,2,null==t?null:t.recipientAmount,"1.0-0")),s.xp6(2),s.Q6J("ngIf",t.is_expanded)}}function un(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",70),s.TgZ(1,"button",73),s.NdJ("click",function(){const e=s.CHM(t).$implicit,n=s.oxw(2).$implicit;return s.oxw(2).onPartClick(e,n)}),s._uU(2),s.qZA(),s.qZA()}if(2&t){const t=e.index;s.xp6(2),s.hij("View ",t+1,"")}}function dn(t,e){if(1&t&&(s.TgZ(0,"div"),s.YNc(1,un,3,1,"div",72),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.Q6J("ngForOf",null==t?null:t.parts)}}function pn(t,e){if(1&t&&(s.TgZ(0,"td",69),s.TgZ(1,"span",70),s.TgZ(2,"button",71),s.NdJ("click",function(){const t=e.$implicit;return t.is_expanded=!t.is_expanded}),s._uU(3),s.qZA(),s.qZA(),s.YNc(4,dn,2,1,"div",9),s.qZA()),2&t){const t=e.$implicit;s.xp6(3),s.Oqu(t.is_expanded?"Hide":"Show"),s.xp6(1),s.Q6J("ngIf",t.is_expanded)}}function mn(t,e){1&t&&s._UZ(0,"tr",74)}const hn=function(t){return{"display-none":t}};function gn(t,e){if(1&t&&s._UZ(0,"tr",75),2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,hn,(null==t.payments?null:t.payments.data)&&(null==t.payments||null==t.payments.data?null:t.payments.data.length)>0))}}function fn(t,e){1&t&&s._UZ(0,"tr",76)}function xn(t,e){1&t&&s._UZ(0,"tr",74)}const Zn=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}},yn=function(){return["no_payment"]};function An(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",14),s.TgZ(1,"div",15),s.TgZ(2,"div",16),s._UZ(3,"fa-icon",17),s.TgZ(4,"span",18),s._uU(5,"Payments History"),s.qZA(),s.qZA(),s.TgZ(6,"mat-form-field",19),s.TgZ(7,"input",20),s.NdJ("keyup",function(){return s.CHM(t),s.oxw().applyFilter()})("ngModelChange",function(e){return s.CHM(t),s.oxw().selFilter=e}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"div",21),s.YNc(9,Oe,1,0,"mat-progress-bar",22),s.TgZ(10,"table",23,24),s.ynx(12,25),s.YNc(13,ke,2,0,"th",26),s.YNc(14,Re,3,4,"td",27),s.BQk(),s.ynx(15,28),s.YNc(16,Ee,2,0,"th",26),s.YNc(17,Je,4,4,"td",27),s.BQk(),s.ynx(18,29),s.YNc(19,Pe,2,0,"th",26),s.YNc(20,Ye,4,4,"td",27),s.BQk(),s.ynx(21,30),s.YNc(22,Qe,2,0,"th",31),s.YNc(23,Be,4,3,"td",27),s.BQk(),s.ynx(24,32),s.YNc(25,He,6,0,"th",33),s.YNc(26,ze,3,0,"td",34),s.BQk(),s.ynx(27,35),s.YNc(28,$e,4,3,"td",36),s.BQk(),s.ynx(29,37),s.YNc(30,je,4,2,"td",27),s.BQk(),s.ynx(31,38),s.YNc(32,nn,5,5,"td",27),s.BQk(),s.ynx(33,39),s.YNc(34,sn,5,5,"td",27),s.BQk(),s.ynx(35,40),s.YNc(36,cn,5,5,"td",27),s.BQk(),s.ynx(37,41),s.YNc(38,pn,5,2,"td",42),s.BQk(),s.YNc(39,mn,1,0,"tr",43),s.YNc(40,gn,1,3,"tr",44),s.YNc(41,fn,1,0,"tr",45),s.YNc(42,xn,1,0,"tr",46),s.qZA(),s.qZA(),s._UZ(43,"mat-paginator",47),s.qZA()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("icon",t.faHistory),s.xp6(4),s.Q6J("ngModel",t.selFilter),s.xp6(2),s.Q6J("ngIf",t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",t.payments)("ngClass",s.VKq(14,Zn,""!==t.errorMessage)),s.xp6(29),s.Q6J("matRowDefColumns",t.partColumns)("matRowDefWhen",t.is_group),s.xp6(1),s.Q6J("matFooterRowDef",s.DdM(16,yn)),s.xp6(1),s.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",t.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns),s.xp6(1),s.Q6J("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.screenSize!==t.screenSizeEnum.XS)}}let Cn=(()=>{class t{constructor(t,e,n,a,i,o,s){this.logger=t,this.commonService=e,this.store=n,this.rtlEffects=a,this.decimalPipe=i,this.dataService=o,this.datePipe=s,this.calledFrom="transactions",this.faHistory=g.qO$,this.newlyAddedPayment="",this.selNode={},this.information={},this.paymentJSONArr=[],this.paymentDecoded={},this.displayedColumns=[],this.partColumns=[],this.paymentRequest="",this.paymentDecodedHint="",this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.selFilter="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["firstPartTimestamp","actions"],this.partColumns=["groupTotal","groupAction"]):this.screenSize===f.cu.SM?(this.flgSticky=!1,this.displayedColumns=["firstPartTimestamp","recipientAmount","actions"],this.partColumns=["groupTotal","groupAmount","groupAction"]):this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["firstPartTimestamp","id","recipientAmount","actions"],this.partColumns=["groupTotal","groupId","groupAmount","groupAction"]):(this.flgSticky=!0,this.displayedColumns=["firstPartTimestamp","id","recipientNodeAlias","recipientAmount","actions"],this.partColumns=["groupTotal","groupId","groupChannelAlias","groupAmount","groupAction"])}ngOnInit(){this.store.select(x.LR).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.selNode=t}),this.store.select(x.yD).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.information=t}),this.store.select(x.PP).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.paymentJSONArr=t.payments&&t.payments.sent&&t.payments.sent.length>0?t.payments.sent:[],this.loadPaymentsTable(this.paymentJSONArr),this.logger.info(t)})}ngAfterViewInit(){this.loadPaymentsTable(this.paymentJSONArr)}loadPaymentsTable(t){this.payments=new ht.by(t?[...t]:[]),this.payments.sort=this.sort,this.payments.sortingDataAccessor=(t,e)=>{switch(e){case"firstPartTimestamp":return this.commonService.sortByKey(t.parts,"timestamp","number",this.sort.direction),t.firstPartTimestamp;case"id":return this.commonService.sortByKey(t.parts,"id","string",this.sort.direction),t.id;case"recipientNodeAlias":return this.commonService.sortByKey(t.parts,"toChannelAlias","string",this.sort.direction),t.recipientNodeAlias;case"recipientAmount":return this.commonService.sortByKey(t.parts,"amount","number",this.sort.direction),t.recipientAmount;default:return t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null}},this.payments.filterPredicate=(t,e)=>((t.firstPartTimestamp?this.datePipe.transform(new Date(t.firstPartTimestamp),"dd/MMM/YYYY HH:mm").toLowerCase():"")+JSON.stringify(t).toLowerCase()).includes(e),this.payments.paginator=this.paginator,this.applyFilter()}onSendPayment(){if(!this.paymentRequest)return!0;this.paymentDecoded.timestamp?this.sendPayment():this.dataService.decodePayment(this.paymentRequest,!1).pipe((0,de.q)(1)).subscribe(t=>{this.paymentDecoded=t,this.paymentDecoded.timestamp?(this.paymentDecoded.amount||(this.paymentDecoded.amount=0),this.sendPayment()):this.resetData()})}sendPayment(){this.newlyAddedPayment=this.paymentDecoded.paymentHash,this.paymentDecoded.amount&&0!==this.paymentDecoded.amount?(this.store.dispatch((0,It.c1)({payload:{data:{type:f.n_.CONFIRM,alertTitle:"Confirm Send Payment",noBtnText:"Cancel",yesBtnText:"Send Payment",message:[[{key:"paymentHash",value:this.paymentDecoded.paymentHash,title:"Payment Hash",width:100}],[{key:"nodeId",value:this.paymentDecoded.nodeId,title:"Payee",width:100}],[{key:"description",value:this.paymentDecoded.description,title:"Description",width:100}],[{key:"timestamp",value:this.paymentDecoded.timestamp,title:"Creation Date",width:50,type:f.Gi.DATE_TIME},{key:"amount",value:this.paymentDecoded.amount,title:"Amount (Sats)",width:50,type:f.Gi.NUMBER}],[{key:"expiry",value:this.paymentDecoded.expiry,title:"Expiry",width:50,type:f.Gi.NUMBER},{key:"minFinalCltvExpiry",value:this.paymentDecoded.minFinalCltvExpiry,title:"CLTV Expiry",width:50}]]}}})),this.rtlEffects.closeConfirm.pipe((0,de.q)(1)).subscribe(t=>{t&&(this.store.dispatch((0,ft.oV)({payload:{invoice:this.paymentRequest,fromDialog:!1}})),this.resetData())})):(this.store.dispatch((0,It.c1)({payload:{data:{type:f.n_.CONFIRM,alertTitle:"Enter Amount and Confirm Send Payment",message:[[{key:"paymentHash",value:this.paymentDecoded.paymentHash,title:"Payment Hash",width:100}],[{key:"nodeId",value:this.paymentDecoded.nodeId,title:"Payee",width:100}],[{key:"description",value:this.paymentDecoded.description,title:"Description",width:100}],[{key:"timestamp",value:this.paymentDecoded.timestamp,title:"Creation Date",width:40,type:f.Gi.DATE_TIME},{key:"expiry",value:this.paymentDecoded.expiry,title:"Expiry",width:30,type:f.Gi.NUMBER},{key:"minFinalCltvExpiry",value:this.paymentDecoded.minFinalCltvExpiry,title:"CLTV Expiry",width:30}]],noBtnText:"Cancel",yesBtnText:"Send Payment",flgShowInput:!0,titleMessage:"It is a zero amount invoice. Enter the amount (Sats) to pay.",getInputs:[{placeholder:"Amount (Sats)",inputType:f.Gi.NUMBER.toLowerCase(),inputValue:"",width:30}]}}})),this.rtlEffects.closeConfirm.pipe((0,de.q)(1)).subscribe(t=>{t&&(this.paymentDecoded.amount=t[0].inputValue,this.store.dispatch((0,ft.oV)({payload:{invoice:this.paymentRequest,amountMsat:1e3*t[0].inputValue,fromDialog:!1}})),this.resetData())}))}onPaymentRequestEntry(t){this.paymentRequest=t,this.paymentDecodedHint="",this.paymentRequest&&this.paymentRequest.length>100&&this.dataService.decodePayment(this.paymentRequest,!1).pipe((0,de.q)(1)).subscribe(t=>{this.paymentDecoded=t,this.paymentDecoded.amount?this.selNode.fiatConversion?this.commonService.convertCurrency(+this.paymentDecoded.amount,f.NT.SATS,f.NT.OTHER,this.selNode.currencyUnits[2],this.selNode.fiatConversion).pipe((0,p.R)(this.unSubs[3])).subscribe({next:t=>{this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats ("+t.symbol+this.decimalPipe.transform(t.OTHER?t.OTHER:0,f.Xz.OTHER)+") | Memo: "+this.paymentDecoded.description},error:t=>{this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats | Memo: "+this.paymentDecoded.description+". Unable to convert currency."}}):this.paymentDecodedHint="Sending: "+this.decimalPipe.transform(this.paymentDecoded.amount?this.paymentDecoded.amount:0)+" Sats | Memo: "+this.paymentDecoded.description:this.paymentDecodedHint="Zero Amount Invoice | Memo: "+this.paymentDecoded.description})}openSendPaymentModal(){this.store.dispatch((0,It.qR)({payload:{data:{component:Te}}}))}resetData(){this.paymentDecoded={},this.paymentRequest="",this.form.resetForm()}is_group(t,e){return e.parts&&e.parts.length>1}onPaymentClick(t){t.paymentHash&&""!==t.paymentHash.trim()?this.dataService.decodePayments(t.paymentHash).pipe((0,de.q)(1)).subscribe({next:e=>{this.showPaymentView(t,e[0]||[])},error:e=>{this.showPaymentView(t,[])}}):this.showPaymentView(t,[])}showPaymentView(t,e){this.store.dispatch((0,It.qR)({payload:{data:{sentPaymentInfo:e,payment:t,component:Le}}}))}onPartClick(t,e){e.paymentHash&&""!==e.paymentHash.trim()?this.dataService.decodePayments(e.paymentHash).pipe((0,de.q)(1)).subscribe({next:n=>{this.showPartView(t,e,n)},error:n=>{this.showPartView(t,e,[])}}):this.showPartView(t,e,[])}showPartView(t,e,n){const a=[[{key:"paymentHash",value:e.paymentHash,title:"Payment Hash",width:100,type:f.Gi.STRING}],[{key:"paymentPreimage",value:e.paymentPreimage,title:"Payment Preimage",width:100,type:f.Gi.STRING}],[{key:"toChannelId",value:t.toChannelId,title:"Channel",width:100,type:f.Gi.STRING}],[{key:"id",value:t.id,title:"Part ID",width:50,type:f.Gi.STRING},{key:"timestamp",value:t.timestamp,title:"Time",width:50,type:f.Gi.DATE_TIME}],[{key:"amount",value:t.amount,title:"Amount (Sats)",width:50,type:f.Gi.NUMBER},{key:"feesPaid",value:t.feesPaid,title:"Fee (Sats)",width:50,type:f.Gi.NUMBER}]];n.length>0&&n[0].paymentRequest&&n[0].paymentRequest.description&&""!==n[0].paymentRequest.description&&a.splice(3,0,[{key:"description",value:n[0].paymentRequest.description,title:"Description",width:100,type:f.Gi.STRING}]),this.store.dispatch((0,It.qR)({payload:{data:{type:f.n_.INFORMATION,alertTitle:"Payment Part Information",message:a}}}))}applyFilter(){""!==this.selFilter&&(this.payments.filter=this.selFilter.trim().toLowerCase())}onDownloadCSV(){if(this.payments.data&&this.payments.data.length>0){const t=JSON.parse(JSON.stringify(this.payments.data)),e=t.reduce((t,e)=>(e.paymentHash&&""!==e.paymentHash.trim()&&(t=""===t?e.paymentHash:t+","+e.paymentHash),t),"");this.dataService.decodePayments(e).pipe((0,p.R)(this.unSubs[4])).subscribe(e=>{e.forEach((e,n)=>{e.length>0&&e[0].paymentRequest&&e[0].paymentRequest.description&&""!==e[0].paymentRequest.description&&(t[n].description=e[0].paymentRequest.description)});const n=t.reduce((t,e)=>t.concat(e),[]);this.commonService.downloadFile(n,"Payments")})}}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(A.v),s.Y36(y.yh),s.Y36(_e.V),s.Y36(a.JJ),s.Y36(me.D),s.Y36(a.uU))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-lightning-payments"]],viewQuery:function(t,e){if(1&t&&(s.Gf(Ie,5),s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.form=t.first),s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},inputs:{calledFrom:"calledFrom"},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Payments")}])],decls:4,vars:3,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch"],["fxLayout","column","fxLayoutAlign","space-between stretch","fxLayout.gt-sm","row wrap",4,"ngIf"],["fxLayout","row",4,"ngIf"],["fxLayout","column","fxLayoutAlign","start stretch",4,"ngIf"],["fxLayout","column","fxLayoutAlign","space-between stretch","fxLayout.gt-sm","row wrap"],["sendPaymentForm","ngForm"],["fxFlex","100"],["matInput","","placeholder","Payment Request","name","paymentRequest","tabindex","1","required","",3,"perfectScrollbar","ngModel","ngModelChange","matTextareaAutosize"],["paymentReq","ngModel"],[4,"ngIf"],["fxLayout","row",1,"mt-1"],["mat-stroked-button","","color","primary","tabindex","2","type","reset",1,"mr-1",3,"click"],["mat-flat-button","","color","primary","tabindex","3",3,"click"],["fxLayout","row"],["fxLayout","column","fxLayoutAlign","start stretch"],["fxLayout","column","fxLayoutAlign","start stretch","fxLayout.gt-sm","row wrap",1,"page-sub-title-container","mt-1"],["fxFlex","70","fxLayoutAlign","start start","fxLayoutAlign.gt-sm","start center"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxFlex","30","fxLayoutAlign","start end"],["matInput","","placeholder","Filter",3,"ngModel","keyup","ngModelChange"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","firstPartTimestamp"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["matColumnDef","recipientNodeAlias"],["matColumnDef","recipientAmount"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",4,"matHeaderCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","px-3",4,"matHeaderCellDef"],["mat-cell","","class","px-3","fxLayoutAlign","end center",4,"matCellDef"],["matColumnDef","no_payment"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["matColumnDef","groupTotal"],["matColumnDef","groupId"],["matColumnDef","groupChannelAlias"],["matColumnDef","groupAmount"],["matColumnDef","groupAction"],["mat-cell","","class","px-3",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"ellipsis-parent",3,"ngStyle"],[1,"ellipsis-child"],["mat-header-cell","","mat-sort-header","","arrowPosition","before"],["fxLayoutAlign","end center"],["mat-header-cell","",1,"px-3"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",1,"px-3"],["mat-stroked-button","","color","primary","type","button","tabindex","4",3,"click"],["mat-footer-cell","","colspan","4"],["fxLayoutAlign","start center",1,"part-row-span"],["fxLayoutAlign","start center","class","part-row-span pl-3",4,"ngFor","ngForOf"],["fxLayoutAlign","start center",1,"part-row-span","pl-3"],["fxLayoutAlign","start center",1,"ellipsis-parent","part-row-span",3,"ngStyle"],["fxLayoutAlign","start center","class","part-row-span",4,"ngFor","ngForOf"],["fxLayoutAlign","end center",1,"part-row-span"],["fxLayoutAlign","end center","class","part-row-span",4,"ngFor","ngForOf"],["mat-cell","",1,"px-3"],["fxLayoutAlign","end start"],["mat-flat-button","","color","primary","type","button","tabindex","5",1,"btn-part-expand",3,"click"],["fxLayoutAlign","end start",4,"ngFor","ngForOf"],["mat-stroked-button","","color","primary","type","button","tabindex","6",1,"btn-part-info",3,"click"],["mat-row",""],["mat-footer-row","",3,"ngClass"],["mat-header-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.YNc(1,Fe,12,3,"form",1),s.YNc(2,Ue,3,0,"div",2),s.YNc(3,An,44,17,"div",3),s.qZA()),2&t&&(s.xp6(1),s.Q6J("ngIf","home"===e.calledFrom),s.xp6(1),s.Q6J("ngIf","transactions"===e.calledFrom),s.xp6(1),s.Q6J("ngIf","transactions"===e.calledFrom))},directives:[l.xw,l.yH,l.Wh,a.O5,Zt._Y,Zt.JL,Zt.F,k.KE,yt.Nt,Zt.Fj,yt.D7,Zt.Q7,M.$V,Zt.JJ,Zt.On,b.lW,k.bx,k.TO,C.BN,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.mD,ht.nj,ht.Ke,ht.as,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,a.PC,v.Zl,Tt.gD,Tt.$L,St.ey,ht.yh,a.sg,ht.Gk,ht.Q2,ht.XQ],pipes:[a.uU,a.JJ],styles:[".mat-column-groupChannelAlias[_ngcontent-%COMP%], .mat-column-groupId[_ngcontent-%COMP%], .mat-column-id[_ngcontent-%COMP%], .mat-column-recipientNodeAlias[_ngcontent-%COMP%]{padding:0 1rem;flex:0 0 25%;width:25%}.mat-column-groupChannelAlias[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%], .mat-column-groupId[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%], .mat-column-id[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%], .mat-column-recipientNodeAlias[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%]{display:flex}.mat-column-actions[_ngcontent-%COMP%], .mat-column-groupAction[_ngcontent-%COMP%]{min-height:4.8rem}.mat-column-groupAction[_ngcontent-%COMP%]   .btn-part-expand[_ngcontent-%COMP%]{width:9rem}.mat-column-groupAction[_ngcontent-%COMP%]   .btn-part-info[_ngcontent-%COMP%]{margin-top:.5rem;width:9rem}.part-row-span[_ngcontent-%COMP%]{min-height:4.2rem;place-content:center flex-start;align-items:center}.mat-column-groupTotal[_ngcontent-%COMP%]{min-width:15rem}"]}),t})();function Tn(t,e){if(1&t&&(s.TgZ(0,"button",26),s.TgZ(1,"mat-icon"),s._uU(2,"more_vert"),s.qZA(),s.qZA()),2&t){s.oxw();const t=s.MAs(11);s.Q6J("matMenuTriggerFor",t)}}function Sn(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",15),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).onNavigateTo("/ecl/reports")}),s._uU(1,"Fees Summary"),s.qZA()}}function wn(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",15),s.NdJ("click",function(){return s.CHM(t),s.oxw(3).onsortChannelsBy()}),s._uU(1),s.qZA()}if(2&t){const t=s.oxw(3);s.xp6(1),s.hij("Sort By ","Balance Score"===t.sortField?"Capacity":"Balance Score","")}}function vn(t,e){1&t&&s._UZ(0,"mat-progress-bar",27)}function bn(t,e){if(1&t&&s._UZ(0,"rtl-ecl-node-info",28),2&t){const t=s.oxw(3);s.Q6J("information",t.information)("showColorFieldSeparately",!1)}}function qn(t,e){if(1&t&&s._UZ(0,"rtl-ecl-balances-info",29),2&t){const t=s.oxw(3);s.Q6J("balances",t.balances)("errorMessage",t.errorMessages[2]+" "+t.errorMessages[3])}}function Ln(t,e){if(1&t&&s._UZ(0,"rtl-ecl-channel-capacity-info",30),2&t){const t=s.oxw(3);s.Q6J("sortBy",t.sortField)("channelBalances",t.channelBalances)("allChannels",t.allChannelsCapacity)("errorMessage",t.errorMessages[2])}}function _n(t,e){if(1&t&&s._UZ(0,"rtl-ecl-fee-info",31),2&t){const t=s.oxw(3);s.Q6J("fees",t.fees)("errorMessage",t.errorMessages[1])}}function In(t,e){if(1&t&&s._UZ(0,"rtl-ecl-channel-status-info",32),2&t){const t=s.oxw(3);s.Q6J("channelsStatus",t.channelsStatus)("errorMessage",t.errorMessages[2])}}function Nn(t,e){1&t&&(s.TgZ(0,"h3"),s._uU(1,"Error! Unable to find information!"),s.qZA())}const Dn=function(t){return{"dashboard-card-content":!0,"error-border":t}};function Fn(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"mat-grid-tile",8),s.TgZ(1,"mat-card",9),s.TgZ(2,"mat-card-header"),s.TgZ(3,"mat-card-title",10),s.TgZ(4,"div"),s._UZ(5,"fa-icon",11),s.TgZ(6,"span"),s._uU(7),s.qZA(),s.qZA(),s.TgZ(8,"div"),s.YNc(9,Tn,3,1,"button",12),s.TgZ(10,"mat-menu",13,14),s.TgZ(12,"button",15),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw(2).onNavigateTo(e.link)}),s._uU(13),s.qZA(),s.YNc(14,Sn,2,0,"button",16),s.YNc(15,wn,2,1,"button",16),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(16,"mat-card-content",17),s.YNc(17,vn,1,0,"mat-progress-bar",18),s.TgZ(18,"div",19),s.YNc(19,bn,1,2,"rtl-ecl-node-info",20),s.YNc(20,qn,1,2,"rtl-ecl-balances-info",21),s.YNc(21,Ln,1,4,"rtl-ecl-channel-capacity-info",22),s.YNc(22,_n,1,2,"rtl-ecl-fee-info",23),s.YNc(23,In,1,2,"rtl-ecl-channel-status-info",24),s.YNc(24,Nn,2,0,"h3",25),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("colspan",t.cols)("rowspan",t.rows),s.xp6(5),s.Q6J("icon",t.icon),s.xp6(2),s.Oqu(t.title),s.xp6(2),s.Q6J("ngIf",t.link),s.xp6(4),s.hij("Go To ",t.goTo,""),s.xp6(1),s.Q6J("ngIf","fee"===t.id),s.xp6(1),s.Q6J("ngIf","capacity"===t.id),s.xp6(1),s.s9C("fxFlex","capacity"===t.id?90:70),s.Q6J("ngClass",s.VKq(17,Dn,"node"===t.id&&n.apiCallStatusNodeInfo.status===n.apiCallStatusEnum.ERROR||"balance"===t.id&&(n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.ERROR||n.apiCallStatusOCBal.status===n.apiCallStatusEnum.ERROR)||("capacity"===t.id||"status"===t.id)&&n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.ERROR||"fee"===t.id&&n.apiCallStatusFees.status===n.apiCallStatusEnum.ERROR)),s.xp6(1),s.Q6J("ngIf","node"===t.id&&n.apiCallStatusNodeInfo.status===n.apiCallStatusEnum.INITIATED||"balance"===t.id&&(n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.INITIATED||n.apiCallStatusOCBal.status===n.apiCallStatusEnum.INITIATED)||("capacity"===t.id||"status"===t.id)&&n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.INITIATED||"fee"===t.id&&n.apiCallStatusFees.status===n.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngSwitch",t.id),s.xp6(1),s.Q6J("ngSwitchCase","node"),s.xp6(1),s.Q6J("ngSwitchCase","balance"),s.xp6(1),s.Q6J("ngSwitchCase","capacity"),s.xp6(1),s.Q6J("ngSwitchCase","fee"),s.xp6(1),s.Q6J("ngSwitchCase","status")}}function Un(t,e){if(1&t&&(s.TgZ(0,"div",2),s.TgZ(1,"div",3),s._UZ(2,"fa-icon",4),s.TgZ(3,"span",5),s._uU(4),s.qZA(),s.qZA(),s.TgZ(5,"mat-grid-list",6),s.YNc(6,Fn,25,19,"mat-grid-tile",7),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(2),s.Q6J("icon",t.apiCallStatusNodeInfo.status===t.apiCallStatusEnum.ERROR?t.faFrown:t.faSmile),s.xp6(2),s.Oqu(t.apiCallStatusNodeInfo.status===t.apiCallStatusEnum.COMPLETED?"Welcome "+t.information.alias+"! Your node is up and running.":t.apiCallStatusNodeInfo.status===t.apiCallStatusEnum.INITIATED?"Wait! Getting your node information...":"Error! Please check the server connection."),s.xp6(1),s.Q6J("rowHeight",t.operatorCardHeight),s.xp6(1),s.Q6J("ngForOf",t.operatorCards)}}function On(t,e){if(1&t&&(s.TgZ(0,"button",26),s.TgZ(1,"mat-icon"),s._uU(2,"more_vert"),s.qZA(),s.qZA()),2&t){s.oxw();const t=s.MAs(9);s.Q6J("matMenuTriggerFor",t)}}function kn(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"mat-card-header"),s.TgZ(1,"mat-card-title",10),s.TgZ(2,"div"),s._UZ(3,"fa-icon",11),s.TgZ(4,"span"),s._uU(5),s.qZA(),s.qZA(),s.TgZ(6,"div"),s.YNc(7,On,3,1,"button",12),s.TgZ(8,"mat-menu",13,41),s.TgZ(10,"button",15),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw(2).onNavigateTo(e.link)}),s._uU(11),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw().$implicit;s.xp6(3),s.Q6J("icon",t.icon),s.xp6(2),s.Oqu(t.title),s.xp6(2),s.Q6J("ngIf",t.link),s.xp6(4),s.hij("Go To ",t.goTo,"")}}function Rn(t,e){1&t&&s._UZ(0,"mat-progress-bar",27)}function En(t,e){if(1&t&&s._UZ(0,"rtl-ecl-node-info",42),2&t){const t=s.oxw(3);s.Q6J("information",t.information)}}function Mn(t,e){if(1&t&&s._UZ(0,"rtl-ecl-balances-info",29),2&t){const t=s.oxw(3);s.Q6J("balances",t.balances)("errorMessage",t.errorMessages[2]+" "+t.errorMessages[3])}}function Jn(t,e){if(1&t&&s._UZ(0,"rtl-ecl-channel-liquidity-info",43),2&t){const t=s.oxw(3);s.Q6J("direction","In")("totalLiquidity",t.totalInboundLiquidity)("allChannels",t.allInboundChannels)("errorMessage",t.errorMessages[2])}}function Pn(t,e){if(1&t&&s._UZ(0,"rtl-ecl-channel-liquidity-info",43),2&t){const t=s.oxw(3);s.Q6J("direction","Out")("totalLiquidity",t.totalOutboundLiquidity)("allChannels",t.allOutboundChannels)("errorMessage",t.errorMessages[2])}}function Yn(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",52),s.TgZ(1,"mat-icon"),s._uU(2,"more_vert"),s.qZA(),s.qZA(),s.TgZ(3,"mat-menu",13,53),s.TgZ(5,"button",15),s.NdJ("click",function(){s.CHM(t);const e=s.oxw(2).$implicit;return s.oxw(2).onNavigateTo(e.link)}),s._uU(6),s.qZA(),s.TgZ(7,"button",15),s.NdJ("click",function(){return s.CHM(t),s.oxw(4).onNavigateTo("/ecl/reports/transactions")}),s._uU(8,"Transactions Summary"),s.qZA(),s.qZA()}if(2&t){const t=s.MAs(4),e=s.oxw(2).$implicit;s.Q6J("matMenuTriggerFor",t),s.xp6(6),s.hij("Go To ",e.goTo,"")}}function Qn(t,e){1&t&&(s.TgZ(0,"span",44),s.TgZ(1,"mat-tab-group",45),s.TgZ(2,"mat-tab",46),s._UZ(3,"rtl-ecl-lightning-invoices",47),s.qZA(),s.TgZ(4,"mat-tab",48),s._UZ(5,"rtl-ecl-lightning-payments",49),s.qZA(),s.TgZ(6,"mat-tab",50),s.YNc(7,Yn,9,2,"ng-template",51),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("calledFrom","home"),s.xp6(2),s.Q6J("calledFrom","home"),s.xp6(1),s.Q6J("disabled",!0))}function Bn(t,e){1&t&&(s.TgZ(0,"h3"),s._uU(1,"Error! Unable to find information!"),s.qZA())}const Hn=function(t){return{"p-0":t}};function zn(t,e){if(1&t&&(s.TgZ(0,"mat-grid-tile",8),s.TgZ(1,"mat-card",35),s.YNc(2,kn,12,4,"mat-card-header",36),s.TgZ(3,"mat-card-content",37),s.YNc(4,Rn,1,0,"mat-progress-bar",18),s.TgZ(5,"div",19),s.YNc(6,En,1,1,"rtl-ecl-node-info",38),s.YNc(7,Mn,1,2,"rtl-ecl-balances-info",21),s.YNc(8,Jn,1,4,"rtl-ecl-channel-liquidity-info",39),s.YNc(9,Pn,1,4,"rtl-ecl-channel-liquidity-info",39),s.YNc(10,Qn,8,3,"span",40),s.YNc(11,Bn,2,0,"h3",25),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("colspan",t.cols)("rowspan",t.rows),s.xp6(1),s.Q6J("ngClass",s.VKq(13,Hn,"transactions"===t.id)),s.xp6(1),s.Q6J("ngIf","transactions"!==t.id),s.xp6(1),s.s9C("fxFlex","transactions"===t.id?100:"balance"===t.id?70:90),s.Q6J("ngClass",s.VKq(15,Dn,"node"===t.id&&n.apiCallStatusNodeInfo.status===n.apiCallStatusEnum.ERROR||"balance"===t.id&&(n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.ERROR||n.apiCallStatusOCBal.status===n.apiCallStatusEnum.ERROR)||("inboundLiq"===t.id||"outboundLiq"===t.id)&&n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.ERROR)),s.xp6(1),s.Q6J("ngIf","node"===t.id&&n.apiCallStatusNodeInfo.status===n.apiCallStatusEnum.INITIATED||"balance"===t.id&&(n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.INITIATED||n.apiCallStatusOCBal.status===n.apiCallStatusEnum.INITIATED)||("inboundLiq"===t.id||"outboundLiq"===t.id)&&n.apiCallStatusAllChannels.status===n.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngSwitch",t.id),s.xp6(1),s.Q6J("ngSwitchCase","node"),s.xp6(1),s.Q6J("ngSwitchCase","balance"),s.xp6(1),s.Q6J("ngSwitchCase","inboundLiq"),s.xp6(1),s.Q6J("ngSwitchCase","outboundLiq"),s.xp6(1),s.Q6J("ngSwitchCase","transactions")}}function Vn(t,e){if(1&t&&(s.TgZ(0,"div",33),s._UZ(1,"fa-icon",4),s.TgZ(2,"span",5),s._uU(3),s.qZA(),s.qZA(),s.TgZ(4,"mat-grid-list",34),s.YNc(5,zn,12,17,"mat-grid-tile",7),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("icon",t.faSmile),s.xp6(2),s.hij("Welcome ",t.information.alias,"! Your node is up and running."),s.xp6(1),s.Q6J("rowHeight",t.merchantCardHeight),s.xp6(1),s.Q6J("ngForOf",t.merchantCards)}}let Gn=(()=>{class t{constructor(t,e,n,a){this.logger=t,this.store=e,this.commonService=n,this.router=a,this.faSmile=h.I3,this.faFrown=h.Kf,this.faAngleDoubleDown=g.Sbq,this.faAngleDoubleUp=g.Vfw,this.faChartPie=g.OS1,this.faBolt=g.BDt,this.faServer=g.xf3,this.faNetworkWired=g.kXW,this.userPersonaEnum=f.ol,this.channelBalances={localBalance:0,remoteBalance:0,balancedness:0},this.selNode={},this.information={},this.channels=[],this.onchainBalance={},this.balances={onchain:-1,lightning:-1,total:0},this.channelsStatus={},this.allChannelsCapacity=[],this.allInboundChannels=[],this.allOutboundChannels=[],this.totalInboundLiquidity=0,this.totalOutboundLiquidity=0,this.operatorCards=[],this.merchantCards=[],this.screenSize="",this.operatorCardHeight="330px",this.merchantCardHeight="65px",this.sortField="Balance Score",this.errorMessages=["","","",""],this.apiCallStatusNodeInfo={status:f.Bn.COMPLETED},this.apiCallStatusFees={status:f.Bn.COMPLETED},this.apiCallStatusOCBal={status:f.Bn.COMPLETED},this.apiCallStatusAllChannels={status:f.Bn.COMPLETED},this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x,new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.operatorCards=[{id:"node",icon:this.faServer,title:"Node Information",cols:10,rows:1},{id:"balance",goTo:"On-Chain",link:"/ecl/onchain",icon:this.faChartPie,title:"Balances",cols:10,rows:1},{id:"fee",goTo:"Routing",link:"/ecl/routing",icon:this.faBolt,title:"Routing Fee",cols:10,rows:1},{id:"status",goTo:"Channels",link:"/ecl/connections",icon:this.faNetworkWired,title:"Channels",cols:10,rows:1},{id:"capacity",goTo:"Channels",link:"/ecl/connections",icon:this.faNetworkWired,title:"Channels Capacity",cols:10,rows:2}],this.merchantCards=[{id:"balance",goTo:"On-Chain",link:"/ecl/onchain",icon:this.faChartPie,title:"Balances",cols:6,rows:4},{id:"transactions",goTo:"Transactions",link:"/ecl/transactions",title:"",cols:6,rows:4},{id:"inboundLiq",goTo:"Channels",link:"/ecl/connections",icon:this.faAngleDoubleDown,title:"In-Bound Liquidity",cols:6,rows:8},{id:"outboundLiq",goTo:"Channels",link:"/ecl/connections",icon:this.faAngleDoubleUp,title:"Out-Bound Liquidity",cols:6,rows:8}]):this.screenSize===f.cu.SM||this.screenSize===f.cu.MD?(this.operatorCards=[{id:"node",icon:this.faServer,title:"Node Information",cols:5,rows:1},{id:"balance",goTo:"On-Chain",link:"/ecl/onchain",icon:this.faChartPie,title:"Balances",cols:5,rows:1},{id:"fee",goTo:"Routing",link:"/ecl/routing",icon:this.faBolt,title:"Routing Fee",cols:5,rows:1},{id:"status",goTo:"Channels",link:"/ecl/connections",icon:this.faNetworkWired,title:"Channels",cols:5,rows:1},{id:"capacity",goTo:"Channels",link:"/ecl/connections",icon:this.faNetworkWired,title:"Channels Capacity",cols:10,rows:2}],this.merchantCards=[{id:"balance",goTo:"On-Chain",link:"/ecl/onchain",icon:this.faChartPie,title:"Balances",cols:3,rows:4},{id:"transactions",goTo:"Transactions",link:"/ecl/transactions",title:"",cols:3,rows:4},{id:"inboundLiq",goTo:"Channels",link:"/ecl/connections",icon:this.faAngleDoubleDown,title:"In-Bound Liquidity",cols:3,rows:8},{id:"outboundLiq",goTo:"Channels",link:"/ecl/connections",icon:this.faAngleDoubleUp,title:"Out-Bound Liquidity",cols:3,rows:8}]):(this.operatorCardHeight=(window.screen.height-200)/2+"px",this.merchantCardHeight=(window.screen.height-210)/10+"px",this.operatorCards=[{id:"node",icon:this.faServer,title:"Node Information",cols:3,rows:1},{id:"balance",goTo:"On-Chain",link:"/ecl/onchain",icon:this.faChartPie,title:"Balances",cols:3,rows:1},{id:"capacity",goTo:"Channels",link:"/ecl/connections",icon:this.faNetworkWired,title:"Channels Capacity",cols:4,rows:2},{id:"fee",goTo:"Routing",link:"/ecl/routing",icon:this.faBolt,title:"Routing Fee",cols:3,rows:1},{id:"status",goTo:"Channels",link:"/ecl/connections",icon:this.faNetworkWired,title:"Channels",cols:3,rows:1}],this.merchantCards=[{id:"balance",goTo:"On-Chain",link:"/ecl/onchain",icon:this.faChartPie,title:"Balances",cols:2,rows:5},{id:"inboundLiq",goTo:"Channels",link:"/ecl/connections",icon:this.faAngleDoubleDown,title:"In-Bound Liquidity",cols:2,rows:10},{id:"outboundLiq",goTo:"Channels",link:"/ecl/connections",icon:this.faAngleDoubleUp,title:"Out-Bound Liquidity",cols:2,rows:10},{id:"transactions",goTo:"Transactions",link:"/ecl/transactions",title:"",cols:2,rows:5}])}ngOnInit(){this.store.select(x.LR).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.selNode=t}),this.store.select(x.T$).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.errorMessages[0]="",this.apiCallStatusNodeInfo=t.apiCallStatus,this.apiCallStatusNodeInfo.status===f.Bn.ERROR&&(this.errorMessages[0]="object"==typeof this.apiCallStatusNodeInfo.message?JSON.stringify(this.apiCallStatusNodeInfo.message):this.apiCallStatusNodeInfo.message),this.information=t.information}),this.store.select(x.JG).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.errorMessages[1]="",this.apiCallStatusFees=t.apiCallStatus,this.apiCallStatusFees.status===f.Bn.ERROR&&(this.errorMessages[1]="object"==typeof this.apiCallStatusFees.message?JSON.stringify(this.apiCallStatusFees.message):this.apiCallStatusFees.message),this.fees=t.fees}),this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[3]),(0,m.M)(this.store.select(x.kY))).subscribe(([t,e])=>{this.errorMessages[2]="",this.errorMessages[3]="",this.apiCallStatusAllChannels=t.apiCallStatus,this.apiCallStatusOCBal=e.apiCallStatus,this.apiCallStatusAllChannels.status===f.Bn.ERROR&&(this.errorMessages[2]="object"==typeof this.apiCallStatusAllChannels.message?JSON.stringify(this.apiCallStatusAllChannels.message):this.apiCallStatusAllChannels.message),this.apiCallStatusOCBal.status===f.Bn.ERROR&&(this.errorMessages[3]="object"==typeof this.apiCallStatusOCBal.message?JSON.stringify(this.apiCallStatusOCBal.message):this.apiCallStatusOCBal.message),this.channels=t.activeChannels,this.onchainBalance=e.onchainBalance,this.balances.onchain=this.onchainBalance.total,this.balances.lightning=t.lightningBalance.localBalance,this.balances.total=this.balances.lightning+this.balances.onchain,this.balances=Object.assign({},this.balances);const n=t.lightningBalance.localBalance?+t.lightningBalance.localBalance:0,a=t.lightningBalance.remoteBalance?+t.lightningBalance.remoteBalance:0;this.channelBalances={localBalance:n,remoteBalance:a,balancedness:+(1-Math.abs((n-a)/(n+a))).toFixed(3)},this.channelsStatus=t.channelsStatus,this.totalInboundLiquidity=0,this.totalOutboundLiquidity=0,this.allChannelsCapacity=JSON.parse(JSON.stringify(this.commonService.sortDescByKey(this.channels,"balancedness"))),this.allInboundChannels=JSON.parse(JSON.stringify(this.commonService.sortDescByKey(this.channels.filter(t=>t.toRemote>0),"toRemote"))),this.allOutboundChannels=JSON.parse(JSON.stringify(this.commonService.sortDescByKey(this.channels.filter(t=>t.toLocal>0),"toLocal"))),this.channels.forEach(t=>{this.totalInboundLiquidity=this.totalInboundLiquidity+Math.ceil(t.toRemote),this.totalOutboundLiquidity=this.totalOutboundLiquidity+Math.floor(t.toLocal)}),this.logger.info(t)})}onNavigateTo(t){this.router.navigateByUrl(t)}onsortChannelsBy(){"Balance Score"===this.sortField?(this.sortField="Capacity",this.allChannelsCapacity=this.channels.sort((t,e)=>{const n=+t.toLocal+ +t.toRemote,a=+e.toLocal+ +e.toRemote;return n>a?-1:n<a?1:0})):(this.sortField="Balance Score",this.allChannelsCapacity=JSON.parse(JSON.stringify(this.commonService.sortDescByKey(this.channels,"balancedness"))))}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(A.v),s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-home"]],decls:3,vars:2,consts:[["fxLayout","column",4,"ngIf","ngIfElse"],["merchantDashboard",""],["fxLayout","column"],["fxLayout","row","fxLayoutAlign","start start",1,"page-title-container","mb-0"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["cols","10",3,"rowHeight"],[3,"colspan","rowspan",4,"ngFor","ngForOf"],[3,"colspan","rowspan"],["fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"h-100","dashboard-card","mt-4"],["fxLayoutAlign","space-between center"],[1,"mr-1",3,"icon"],["mat-icon-button","","class","more-button","aria-label","Toggle menu",3,"matMenuTriggerFor",4,"ngIf"],["xPosition","before",1,"dashboard-vert-menu"],["menuOperator","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click",4,"ngIf"],["fxLayout","column",3,"fxFlex","ngClass"],["mode","indeterminate",4,"ngIf"],["fxLayout","column","fxFlex","100",3,"ngSwitch"],["fxFlex","100",3,"information","showColorFieldSeparately",4,"ngSwitchCase"],["fxFlex","100",3,"balances","errorMessage",4,"ngSwitchCase"],["fxFlex","100",3,"sortBy","channelBalances","allChannels","errorMessage",4,"ngSwitchCase"],["fxFlex","100",3,"fees","errorMessage",4,"ngSwitchCase"],["fxFlex","100",3,"channelsStatus","errorMessage",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["mat-icon-button","","aria-label","Toggle menu",1,"more-button",3,"matMenuTriggerFor"],["mode","indeterminate"],["fxFlex","100",3,"information","showColorFieldSeparately"],["fxFlex","100",3,"balances","errorMessage"],["fxFlex","100",3,"sortBy","channelBalances","allChannels","errorMessage"],["fxFlex","100",3,"fees","errorMessage"],["fxFlex","100",3,"channelsStatus","errorMessage"],["fxLayout","row","fxLayoutAlign","start end",1,"page-title-container","mb-0"],["cols","6",3,"rowHeight"],["fxFlex","100","fxLayout","column","fxLayoutAlign","start stretch",1,"h-100","dashboard-card","mt-4",3,"ngClass"],[4,"ngIf"],["fxLayout","column","fxLayoutAlign","start stretch",3,"fxFlex","ngClass"],["fxFlex","100",3,"information",4,"ngSwitchCase"],["fxFlex","100",3,"direction","totalLiquidity","allChannels","errorMessage",4,"ngSwitchCase"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between start",4,"ngSwitchCase"],["menuMerchant","matMenu"],["fxFlex","100",3,"information"],["fxFlex","100",3,"direction","totalLiquidity","allChannels","errorMessage"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between start"],["fxLayout","column",1,"w-100","dashboard-tabs-group"],["label","Receive"],[1,"h-100",3,"calledFrom"],["label","Pay"],[3,"calledFrom"],[3,"disabled"],["mat-tab-label",""],["mat-icon-button","","aria-label","Toggle menu",1,"more-button",2,"max-width","20px",3,"matMenuTriggerFor"],["menuTransactions","matMenu"]],template:function(t,e){if(1&t&&(s.YNc(0,Un,7,4,"div",0),s.YNc(1,Vn,6,4,"ng-template",null,1,s.W1O)),2&t){const t=s.MAs(2);s.Q6J("ngIf",e.selNode.userPersona===e.userPersonaEnum.OPERATOR)("ngIfElse",t)}},directives:[a.O5,l.xw,l.Wh,C.BN,T.Il,a.sg,T.DX,S.a8,l.yH,S.dk,S.n5,w.VK,w.OP,S.dn,a.mk,v.oO,a.RF,a.n9,a.ED,b.lW,w.p6,q.Hw,r.pW,D,O,H,G,W,ct,ut.SP,ut.uX,ue,Cn,ut.uD],styles:[""]}),t})();var Xn=n(3784);const $n=["form"];function Wn(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Bitcoin address is required."),s.qZA())}function Kn(t,e){if(1&t&&(s.TgZ(0,"mat-error"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.amountError)}}function jn(t,e){if(1&t&&(s.TgZ(0,"mat-option",29),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.Q6J("value",t),s.xp6(1),s.Oqu(t)}}function ta(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Target Confirmation Blocks is required."),s.qZA())}function ea(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.sendFundError)}}function na(t,e){if(1&t&&(s.TgZ(0,"div",30),s._UZ(1,"fa-icon",31),s.YNc(2,ea,2,1,"span",12),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("icon",t.faExclamationTriangle),s.xp6(1),s.Q6J("ngIf",""!==t.sendFundError)}}let aa=(()=>{class t{constructor(t,e,n,a,i,o){this.dialogRef=t,this.logger=e,this.store=n,this.commonService=a,this.decimalPipe=i,this.actions=o,this.faExclamationTriangle=g.eHv,this.selNode={},this.addressTypes=[],this.selectedAddress=f._t[1],this.blockchainBalance={},this.information={},this.newAddress="",this.transaction={},this.sendFundError="",this.fiatConversion=!1,this.amountUnits=f.uA,this.selAmountUnit=f.uA[0],this.currConvertorRate={},this.unitConversionValue=0,this.currencyUnitFormats=f.Xz,this.amountError="Amount is Required.",this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x]}ngOnInit(){this.store.select(Xn.dT).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.fiatConversion=t.settings.fiatConversion,this.amountUnits=t.settings.currencyUnits,this.logger.info(t)}),this.actions.pipe((0,p.R)(this.unSubs[1]),(0,dt.h)(t=>t.type===f.lr.UPDATE_API_CALL_STATUS_ECL||t.type===f.lr.SEND_ONCHAIN_FUNDS_RES_ECL)).subscribe(t=>{t.type===f.lr.SEND_ONCHAIN_FUNDS_RES_ECL&&(this.store.dispatch((0,It.jW)({payload:"Fund Sent Successfully!"})),this.dialogRef.close()),t.type===f.lr.UPDATE_API_CALL_STATUS_ECL&&t.payload.status===f.Bn.ERROR&&"SendOnchainFunds"===t.payload.action&&(this.sendFundError=t.payload.message)})}onSendFunds(){if(this.invalidValues)return!0;this.sendFundError="",this.transaction.amount&&this.selAmountUnit!==f.NT.SATS?this.commonService.convertCurrency(this.transaction.amount,this.selAmountUnit===this.amountUnits[2]?f.NT.OTHER:this.selAmountUnit,f.NT.SATS,this.amountUnits[2],this.fiatConversion).pipe((0,p.R)(this.unSubs[2])).subscribe({next:t=>{this.transaction.amount=parseInt(t[f.NT.SATS]),this.selAmountUnit=f.NT.SATS,this.store.dispatch((0,ft.Iy)({payload:this.transaction}))},error:t=>{this.transaction.amount=null,this.selAmountUnit=f.NT.SATS,this.amountError="Conversion Error: "+t}}):this.store.dispatch((0,ft.Iy)({payload:this.transaction}))}get invalidValues(){return!this.transaction.address||""===this.transaction.address||!this.transaction.amount||this.transaction.amount<=0||!this.transaction.blocks||this.transaction.blocks<=0}resetData(){this.sendFundError="",this.transaction={}}onAmountUnitChange(t){const e=this,n=this.selAmountUnit===this.amountUnits[2]?f.NT.OTHER:this.selAmountUnit;let a=t.value===this.amountUnits[2]?f.NT.OTHER:t.value;this.transaction.amount&&this.selAmountUnit!==t.value&&this.commonService.convertCurrency(this.transaction.amount,n,a,this.amountUnits[2],this.fiatConversion).pipe((0,p.R)(this.unSubs[3])).subscribe({next:n=>{this.selAmountUnit=t.value,e.transaction.amount=+e.decimalPipe.transform(n[a],e.currencyUnitFormats[a]).replace(/,/g,"")},error:t=>{e.transaction.amount=null,this.amountError="Conversion Error: "+t,this.selAmountUnit=n,a=n}})}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(gt.so),s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(A.v),s.Y36(a.JJ),s.Y36(xt.eX))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-on-chain-send-modal"]],viewQuery:function(t,e){if(1&t&&s.Gf($n,7),2&t){let t;s.iGM(t=s.CRH())&&(e.form=t.first)}},decls:36,vars:15,consts:[["fxLayout","row"],["fxFlex","100"],["fxLayout","row","fxLayoutAlign","space-between center",1,"modal-info-header"],["fxFlex","95","fxLayoutAlign","start start"],[1,"page-title"],["tabindex","8","fxFlex","5","fxLayoutAlign","center","default","","mat-button","",1,"btn-close-x","p-0",3,"mat-dialog-close"],[1,"padding-gap-x-large"],["fxLayout","row wrap","fxFlex","100","fxLayoutAlign","space-between start",1,"overflow-x-hidden",3,"submit","reset"],["form","ngForm"],["fxFlex","55"],["matInput","","autoFocus","","placeholder","Bitcoin Address","tabindex","1","name","addr","required","",3,"ngModel","ngModelChange"],["addrs","ngModel"],[4,"ngIf"],["fxFlex","30"],["matInput","","placeholder","Amount","name","amt","type","number","tabindex","2","required","",3,"ngModel","step","min","ngModelChange"],["amnt","ngModel"],["matSuffix",""],["fxFlex","10","fxLayoutAlign","start end"],["tabindex","3","required","","name","amountUnit",3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","60","fxLayoutAlign","space-between stretch","fxLayout","row wrap"],["fxFlex","48","fxLayout","row","fxLayoutAlign","start center"],["matInput","","placeholder","Target Confirmation Blocks","type","number","name","blocks","tabindex","8","required","true",3,"ngModel","step","min","ngModelChange"],["blocks","ngModel"],["fxLayout","column","fxFlex","100","fxLayoutAlign","start stretch"],["fxFlex","100","class","alert alert-danger mt-1",4,"ngIf"],["fxLayout","row","fxFlex","100","fxLayoutAlign","end center"],["mat-stroked-button","","color","primary","tabindex","7","type","reset",1,"mr-1"],["mat-flat-button","","color","primary","type","submit","tabindex","8"],[3,"value"],["fxFlex","100",1,"alert","alert-danger","mt-1"],[1,"mr-1","alert-icon",3,"icon"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-card-header",2),s.TgZ(3,"div",3),s.TgZ(4,"span",4),s._uU(5,"Send Payment"),s.qZA(),s.qZA(),s.TgZ(6,"button",5),s._uU(7,"X"),s.qZA(),s.qZA(),s.TgZ(8,"mat-card-content",6),s.TgZ(9,"form",7,8),s.NdJ("submit",function(){return e.onSendFunds()})("reset",function(){return e.resetData()}),s.TgZ(11,"mat-form-field",9),s.TgZ(12,"input",10,11),s.NdJ("ngModelChange",function(t){return e.transaction.address=t}),s.qZA(),s.YNc(14,Wn,2,0,"mat-error",12),s.qZA(),s.TgZ(15,"mat-form-field",13),s.TgZ(16,"input",14,15),s.NdJ("ngModelChange",function(t){return e.transaction.amount=t}),s.qZA(),s.TgZ(18,"span",16),s._uU(19),s.qZA(),s.YNc(20,Kn,2,1,"mat-error",12),s.qZA(),s.TgZ(21,"mat-form-field",17),s.TgZ(22,"mat-select",18),s.NdJ("selectionChange",function(t){return e.onAmountUnitChange(t)}),s.YNc(23,jn,2,2,"mat-option",19),s.qZA(),s.qZA(),s.TgZ(24,"div",20),s.TgZ(25,"mat-form-field",21),s.TgZ(26,"input",22,23),s.NdJ("ngModelChange",function(t){return e.transaction.blocks=t}),s.qZA(),s.YNc(28,ta,2,0,"mat-error",12),s.qZA(),s.qZA(),s._UZ(29,"div",24),s.YNc(30,na,3,2,"div",25),s.TgZ(31,"div",26),s.TgZ(32,"button",27),s._uU(33,"Clear Fields"),s.qZA(),s.TgZ(34,"button",28),s._uU(35,"Send Funds"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(6),s.Q6J("mat-dialog-close",!1),s.xp6(6),s.Q6J("ngModel",e.transaction.address),s.xp6(2),s.Q6J("ngIf",!e.transaction.address),s.xp6(2),s.Q6J("ngModel",e.transaction.amount)("step",100)("min",0),s.xp6(3),s.hij(" ",e.selAmountUnit," "),s.xp6(1),s.Q6J("ngIf",!e.transaction.amount),s.xp6(2),s.Q6J("value",e.selAmountUnit),s.xp6(1),s.Q6J("ngForOf",e.amountUnits),s.xp6(3),s.Q6J("ngModel",e.transaction.blocks)("step",1)("min",0),s.xp6(2),s.Q6J("ngIf",!e.transaction.blocks),s.xp6(2),s.Q6J("ngIf",""!==e.sendFundError))},directives:[l.xw,l.yH,S.dk,l.Wh,b.lW,gt.ZT,S.dn,Zt._Y,Zt.JL,Zt.F,k.KE,yt.Nt,Zt.Fj,At.h,Zt.Q7,Zt.JJ,Zt.On,a.O5,Zt.wV,Zt.qQ,Ct.q,k.R9,Tt.gD,a.sg,k.TO,St.ey,C.BN],styles:[""]}),t})();var ia=n(882);function oa(t,e){1&t&&s._UZ(0,"mat-progress-bar",31)}function sa(t,e){1&t&&(s.TgZ(0,"th",32),s._uU(1," Date/Time "),s.qZA())}function la(t,e){if(1&t&&(s.TgZ(0,"td",33),s._uU(1),s.ALo(2,"date"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.xi3(2,1,1e3*t.timestamp,"dd/MMM/YYYY HH:mm"))}}function ra(t,e){1&t&&(s.TgZ(0,"th",34),s._uU(1," Amount (Sats) "),s.qZA())}function ca(t,e){if(1&t&&(s.TgZ(0,"span",37),s._uU(1),s.ALo(2,"number"),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.Oqu(s.lcZ(2,1,t.amount))}}function ua(t,e){if(1&t&&(s.TgZ(0,"span",38),s._uU(1),s.ALo(2,"number"),s.qZA()),2&t){const t=s.oxw().$implicit;s.xp6(1),s.hij("(",s.lcZ(2,1,-1*t.amount),")")}}function da(t,e){if(1&t&&(s.TgZ(0,"td",33),s.YNc(1,ca,3,3,"span",35),s.YNc(2,ua,3,3,"span",36),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Q6J("ngIf",t.amount>0||0===t.amount),s.xp6(1),s.Q6J("ngIf",t.amount<0)}}function pa(t,e){1&t&&(s.TgZ(0,"th",34),s._uU(1," Fees (Sats) "),s.qZA())}function ma(t,e){if(1&t&&(s.TgZ(0,"td",33),s.TgZ(1,"span",37),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,t.fees))}}function ha(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1," Confirmations "),s.qZA())}function ga(t,e){if(1&t&&(s.TgZ(0,"td",40),s.TgZ(1,"span",37),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.lcZ(3,1,null==t?null:t.confirmations)," ")}}function fa(t,e){1&t&&(s.TgZ(0,"th",32),s._uU(1," Address "),s.qZA())}function xa(t,e){if(1&t&&(s.TgZ(0,"td",33),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(t.address)}}function Za(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",41),s.TgZ(1,"div",42),s.TgZ(2,"mat-select",43),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",44),s.NdJ("click",function(){return s.CHM(t),s.oxw().onDownloadCSV()}),s._uU(5,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function ya(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",45),s.TgZ(1,"button",46),s.NdJ("click",function(e){const n=s.CHM(t).$implicit;return s.oxw().onTransactionClick(n,e)}),s._uU(2,"View Info"),s.qZA(),s.qZA()}}function Aa(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No transaction available."),s.qZA())}function Ca(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting transactions..."),s.qZA())}function Ta(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.errorMessage)}}function Sa(t,e){if(1&t&&(s.TgZ(0,"td",47),s.YNc(1,Aa,2,0,"p",48),s.YNc(2,Ca,2,0,"p",48),s.YNc(3,Ta,2,1,"p",48),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",(!(null!=t.listTransactions&&t.listTransactions.data)||(null==t.listTransactions||null==t.listTransactions.data?null:t.listTransactions.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.listTransactions&&t.listTransactions.data)||(null==t.listTransactions||null==t.listTransactions.data?null:t.listTransactions.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.listTransactions&&t.listTransactions.data)||(null==t.listTransactions||null==t.listTransactions.data?null:t.listTransactions.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const wa=function(t){return{"display-none":t}};function va(t,e){if(1&t&&s._UZ(0,"tr",49),2&t){const t=s.oxw();s.Q6J("ngClass",s.VKq(1,wa,(null==t.listTransactions?null:t.listTransactions.data)&&(null==t.listTransactions||null==t.listTransactions.data?null:t.listTransactions.data.length)>0))}}function ba(t,e){1&t&&s._UZ(0,"tr",50)}function qa(t,e){1&t&&s._UZ(0,"tr",51)}const La=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}},_a=function(){return["no_transaction"]};let Ia=(()=>{class t{constructor(t,e,n,a){this.logger=t,this.commonService=e,this.store=n,this.datePipe=a,this.faHistory=g.qO$,this.displayedColumns=[],this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.selFilter="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unsub=[new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["timestamp","amount","actions"]):this.screenSize===f.cu.SM?(this.flgSticky=!1,this.displayedColumns=["timestamp","amount","confirmations","fees","actions"]):this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["timestamp","amount","fees","confirmations","address","actions"]):(this.flgSticky=!0,this.displayedColumns=["timestamp","amount","fees","confirmations","address","actions"])}ngOnInit(){this.store.dispatch((0,ft.mC)()),this.store.select(x.dx).pipe((0,p.R)(this.unsub[0])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),t.transactions&&this.loadTransactionsTable(t.transactions),this.logger.info(t)})}applyFilter(){""!==this.selFilter&&(this.listTransactions.filter=this.selFilter.trim().toLowerCase())}onTransactionClick(t,e){this.store.dispatch((0,It.qR)({payload:{data:{type:f.n_.INFORMATION,alertTitle:"Transaction Information",message:[[{key:"blockHash",value:t.blockHash,title:"Block Hash",width:100}],[{key:"txid",value:t.txid,title:"Transaction ID",width:100}],[{key:"timestamp",value:t.timestamp,title:"Date/Time",width:50,type:f.Gi.DATE_TIME},{key:"confirmations",value:t.confirmations,title:"Number of Confirmations",width:50,type:f.Gi.NUMBER}],[{key:"fees",value:t.fees,title:"Fees (Sats)",width:50,type:f.Gi.NUMBER},{key:"amount",value:t.amount,title:"Amount (Sats)",width:50,type:f.Gi.NUMBER}],[{key:"address",value:t.address,title:"Address",width:100,type:f.Gi.STRING}]]}}}))}loadTransactionsTable(t){this.listTransactions=new ht.by([...t]),this.listTransactions.sort=this.sort,this.listTransactions.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null,this.listTransactions.filterPredicate=(t,e)=>((t.timestamp?this.datePipe.transform(new Date(1e3*t.timestamp),"dd/MMM/YYYY HH:mm").toLowerCase():"")+JSON.stringify(t).toLowerCase()).includes(e),this.listTransactions.paginator=this.paginator,this.applyFilter(),this.logger.info(this.listTransactions)}onDownloadCSV(){this.listTransactions.data&&this.listTransactions.data.length>0&&this.commonService.downloadFile(this.listTransactions.data,"Transactions")}ngOnDestroy(){this.unsub.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(A.v),s.Y36(y.yh),s.Y36(a.uU))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-on-chain-transaction-history"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Transactions")}])],decls:37,vars:15,consts:[["fxLayout","row wrap","fxLayoutAlign","start start","fxLayout.gt-sm","column","fxFlex","100","fxLayoutAlign.gt-sm","start stretch"],["fxLayout","column","fxLayout.gt-xs","row wrap","fxLayoutAlign.gt-xs","start center","fxLayoutAlign","start stretch",1,"page-sub-title-container"],["fxFlex","70"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxFlex","30"],["matInput","","placeholder","Filter",3,"ngModel","keyup","ngModelChange"],["fxLayout","row","fxLayoutAlign","start start"],["fxLayout","column","fxLayoutAlign","start end","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","timestamp"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","amount"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",4,"matHeaderCellDef"],["matColumnDef","fees"],["matColumnDef","confirmations"],["mat-header-cell","","mat-sort-header","","arrowPosition","before","class","pr-2",4,"matHeaderCellDef"],["mat-cell","","class","pr-2",4,"matCellDef"],["matColumnDef","address"],["matColumnDef","actions"],["mat-header-cell","","class","px-3",4,"matHeaderCellDef"],["mat-cell","","class","pl-3","fxLayoutAlign","end center",4,"matCellDef"],["matColumnDef","no_transaction"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","","arrowPosition","before"],["fxLayoutAlign","end center",4,"ngIf"],["fxLayoutAlign","end center","class","red",4,"ngIf"],["fxLayoutAlign","end center"],["fxLayoutAlign","end center",1,"red"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",1,"pr-2"],["mat-cell","",1,"pr-2"],["mat-header-cell","",1,"px-3"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",1,"pl-3"],["mat-stroked-button","","color","primary","type","button","tabindex","4",3,"click"],["mat-footer-cell","","colspan","4"],[4,"ngIf"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"div",2),s._UZ(3,"fa-icon",3),s.TgZ(4,"span",4),s._uU(5,"Transaction History"),s.qZA(),s.qZA(),s.TgZ(6,"mat-form-field",5),s.TgZ(7,"input",6),s.NdJ("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.selFilter=t}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"div",7),s.TgZ(9,"div",8),s.YNc(10,oa,1,0,"mat-progress-bar",9),s.TgZ(11,"table",10,11),s.ynx(13,12),s.YNc(14,sa,2,0,"th",13),s.YNc(15,la,3,4,"td",14),s.BQk(),s.ynx(16,15),s.YNc(17,ra,2,0,"th",16),s.YNc(18,da,3,2,"td",14),s.BQk(),s.ynx(19,17),s.YNc(20,pa,2,0,"th",16),s.YNc(21,ma,4,3,"td",14),s.BQk(),s.ynx(22,18),s.YNc(23,ha,2,0,"th",19),s.YNc(24,ga,4,3,"td",20),s.BQk(),s.ynx(25,21),s.YNc(26,fa,2,0,"th",13),s.YNc(27,xa,2,1,"td",14),s.BQk(),s.ynx(28,22),s.YNc(29,Za,6,0,"th",23),s.YNc(30,ya,3,0,"td",24),s.BQk(),s.ynx(31,25),s.YNc(32,Sa,4,3,"td",26),s.BQk(),s.YNc(33,va,1,3,"tr",27),s.YNc(34,ba,1,0,"tr",28),s.YNc(35,qa,1,0,"tr",29),s.qZA(),s._UZ(36,"mat-paginator",30),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("icon",e.faHistory),s.xp6(4),s.Q6J("ngModel",e.selFilter),s.xp6(3),s.Q6J("ngIf",e.apiCallStatus.status===e.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",e.listTransactions)("ngClass",s.VKq(12,La,""!==e.errorMessage)),s.xp6(22),s.Q6J("matFooterRowDef",s.DdM(14,_a)),s.xp6(1),s.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",e.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",e.displayedColumns),s.xp6(1),s.Q6J("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("showFirstLastButtons",e.screenSize!==e.screenSizeEnum.XS))},directives:[l.xw,l.Wh,l.yH,C.BN,k.KE,yt.Nt,Zt.Fj,Zt.JJ,Zt.On,M.$V,a.O5,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,Tt.gD,Tt.$L,St.ey,b.lW,ht.yh,ht.Q2,ht.XQ,ht.Gk],pipes:[a.uU,a.JJ],styles:[".mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}"]}),t})();function Na(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",12),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().activeLink=e.link}),s._uU(1),s.qZA()}if(2&t){const t=e.$implicit,n=s.oxw();s.s9C("routerLink",t.link),s.Q6J("active",n.activeLink===t.link),s.xp6(1),s.Oqu(t.name)}}let Da=(()=>{class t{constructor(t,e){this.store=t,this.router=e,this.selNode={},this.faExchangeAlt=g.Ssp,this.faChartPie=g.OS1,this.balances=[{title:"Total Balance",dataValue:0},{title:"Confirmed",dataValue:0},{title:"Unconfirmed",dataValue:0}],this.links=[{link:"receive",name:"Receive"},{link:"send",name:"Send"}],this.activeLink=this.links[0].link,this.unSubs=[new d.x,new d.x,new d.x,new d.x]}ngOnInit(){const t=this.links.find(t=>this.router.url.includes(t.link));this.activeLink=t?t.link:this.links[0].link,this.router.events.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t instanceof i.Av)).subscribe(t=>{const e=this.links.find(e=>t.urlAfterRedirects.includes(e.link));this.activeLink=e?e.link:this.links[0].link}),this.store.select(x.LR).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.selNode=t}),this.store.select(x.kY).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.balances=[{title:"Total Balance",dataValue:t.onchainBalance.total||0},{title:"Confirmed",dataValue:t.onchainBalance.confirmed},{title:"Unconfirmed",dataValue:t.onchainBalance.unconfirmed}]})}openSendFundsModal(){this.store.dispatch((0,It.qR)({payload:{data:{component:aa}}}))}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(y.yh),s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-on-chain"]],decls:21,vars:4,consts:[["fxLayout","row","fxLayoutAlign","start center",1,"page-title-container"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxLayout","column",1,"padding-gap-x","mb-4"],["fxLayout","column"],[3,"values"],["fxLayout","column",1,"padding-gap-x"],["mat-tab-nav-bar",""],["role","tab","mat-tab-link","","class","mat-tab-label",3,"active","routerLink","click",4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch",1,"padding-gap-x-large","mt-2"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch",1,"padding-gap-x-large"],["fxLayout","row","fxFlex","100"],["role","tab","mat-tab-link","",1,"mat-tab-label",3,"active","routerLink","click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s._UZ(1,"fa-icon",1),s.TgZ(2,"span",2),s._uU(3,"On-chain Balance"),s.qZA(),s.qZA(),s.TgZ(4,"div",3),s.TgZ(5,"mat-card"),s.TgZ(6,"mat-card-content",4),s._UZ(7,"rtl-currency-unit-converter",5),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"div",0),s._UZ(9,"fa-icon",1),s.TgZ(10,"span",2),s._uU(11,"On-chain Transactions"),s.qZA(),s.qZA(),s.TgZ(12,"div",6),s.TgZ(13,"mat-card"),s.TgZ(14,"mat-card-content",4),s.TgZ(15,"nav",7),s.YNc(16,Na,2,3,"div",8),s.qZA(),s.TgZ(17,"div",9),s._UZ(18,"router-outlet"),s.qZA(),s.TgZ(19,"div",10),s._UZ(20,"rtl-ecl-on-chain-transaction-history",11),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(1),s.Q6J("icon",e.faChartPie),s.xp6(6),s.Q6J("values",e.balances),s.xp6(2),s.Q6J("icon",e.faExchangeAlt),s.xp6(7),s.Q6J("ngForOf",e.links))},directives:[l.xw,l.Wh,C.BN,S.a8,S.dn,ia.D,ut.BU,a.sg,l.yH,i.lC,Ia,ut.Nj,i.rH],styles:[""]}),t})();var Fa=n(1050);function Ua(t,e){if(1&t&&(s.TgZ(0,"span",10),s._uU(1,"Channels"),s.qZA()),2&t){const t=s.oxw();s.s9C("matBadge",t.activeChannels)}}function Oa(t,e){if(1&t&&(s.TgZ(0,"span",10),s._uU(1,"Peers"),s.qZA()),2&t){const t=s.oxw();s.s9C("matBadge",t.activePeers)}}let ka=(()=>{class t{constructor(t,e){this.store=t,this.router=e,this.activePeers=0,this.activeChannels=0,this.faUsers=g.FVb,this.faChartPie=g.OS1,this.balances=[{title:"Total Balance",dataValue:0},{title:"Confirmed",dataValue:0},{title:"Unconfirmed",dataValue:0}],this.links=[{link:"channels",name:"Channels"},{link:"peers",name:"Peers"}],this.activeLink=0,this.unSubs=[new d.x,new d.x,new d.x,new d.x]}ngOnInit(){this.activeLink=this.links.findIndex(t=>t.link===this.router.url.substring(this.router.url.lastIndexOf("/")+1)),this.router.events.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t instanceof i.Av)).subscribe(t=>{this.activeLink=this.links.findIndex(e=>e.link===t.urlAfterRedirects.substring(t.urlAfterRedirects.lastIndexOf("/")+1))}),this.store.select(x.Bo).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.activePeers=t.peers&&t.peers.length?t.peers.length:0}),this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.activeChannels=t.channelsStatus&&t.channelsStatus.active&&t.channelsStatus.active.channels?t.channelsStatus.active.channels:0}),this.store.select(x.kY).pipe((0,p.R)(this.unSubs[3])).subscribe(t=>{this.balances=[{title:"Total Balance",dataValue:t.onchainBalance.total||0},{title:"Confirmed",dataValue:t.onchainBalance.confirmed},{title:"Unconfirmed",dataValue:t.onchainBalance.unconfirmed}]})}onSelectedTabChange(t){this.router.navigateByUrl("/ecl/connections/"+this.links[t.index].link)}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(y.yh),s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-connections"]],decls:22,vars:4,consts:[["fxLayout","row","fxLayoutAlign","start center",1,"page-title-container"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxLayout","column",1,"padding-gap-x","mb-4"],["fxLayout","column"],[3,"values"],["fxLayout","column",1,"padding-gap-x"],[3,"selectedIndex","selectedIndexChange","selectedTabChange"],["mat-tab-label",""],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch",1,"padding-gap-x-large"],["matBadgeOverlap","false",1,"tab-badge",3,"matBadge"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s._UZ(1,"fa-icon",1),s.TgZ(2,"span",2),s._uU(3,"On-chain Balance"),s.qZA(),s.qZA(),s.TgZ(4,"div",3),s.TgZ(5,"mat-card"),s.TgZ(6,"mat-card-content",4),s._UZ(7,"rtl-currency-unit-converter",5),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"div",0),s._UZ(9,"fa-icon",1),s.TgZ(10,"span",2),s._uU(11,"Connections"),s.qZA(),s.qZA(),s.TgZ(12,"div",6),s.TgZ(13,"mat-card"),s.TgZ(14,"mat-card-content",4),s.TgZ(15,"mat-tab-group",7),s.NdJ("selectedIndexChange",function(t){return e.activeLink=t})("selectedTabChange",function(t){return e.onSelectedTabChange(t)}),s.TgZ(16,"mat-tab"),s.YNc(17,Ua,2,1,"ng-template",8),s.qZA(),s.TgZ(18,"mat-tab"),s.YNc(19,Oa,2,1,"ng-template",8),s.qZA(),s.qZA(),s.TgZ(20,"div",9),s._UZ(21,"router-outlet"),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(1),s.Q6J("icon",e.faChartPie),s.xp6(6),s.Q6J("values",e.balances),s.xp6(2),s.Q6J("icon",e.faUsers),s.xp6(6),s.Q6J("selectedIndex",e.activeLink))},directives:[l.xw,l.Wh,C.BN,S.a8,S.dn,ia.D,ut.SP,ut.uX,ut.uD,l.yH,i.lC,Fa.k],styles:[""]}),t})();function Ra(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",11),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().activeLink=e.link}),s._uU(1),s.qZA()}if(2&t){const t=e.$implicit,n=s.oxw();s.s9C("routerLink",t.link),s.Q6J("active",n.activeLink===t.link),s.xp6(1),s.Oqu(t.name)}}let Ea=(()=>{class t{constructor(t,e,n){this.logger=t,this.store=e,this.router=n,this.faExchangeAlt=g.Ssp,this.faChartPie=g.OS1,this.currencyUnits=[],this.balances=[{title:"Local Capacity",dataValue:0,tooltip:"Amount you can send"},{title:"Remote Capacity",dataValue:0,tooltip:"Amount you can receive"}],this.links=[{link:"payments",name:"Payments"},{link:"invoices",name:"Invoices"},{link:"queryroutes",name:"Query Routes"}],this.activeLink=this.links[0].link,this.unSubs=[new d.x,new d.x,new d.x,new d.x]}ngOnInit(){const t=this.links.find(t=>this.router.url.includes(t.link));this.activeLink=t?t.link:this.links[0].link,this.router.events.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t instanceof i.Av)).subscribe(t=>{const e=this.links.find(e=>t.urlAfterRedirects.includes(e.link));this.activeLink=e?e.link:this.links[0].link}),this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[1]),(0,m.M)(this.store.select(x.LR))).subscribe(([t,e])=>{this.currencyUnits=e.currencyUnits,this.balances=e.userPersona===f.ol.OPERATOR?[{title:"Local Capacity",dataValue:t.lightningBalance.localBalance,tooltip:"Amount you can send"},{title:"Remote Capacity",dataValue:t.lightningBalance.remoteBalance,tooltip:"Amount you can receive"}]:[{title:"Outbound Capacity",dataValue:t.lightningBalance.localBalance,tooltip:"Amount you can send"},{title:"Inbound Capacity",dataValue:t.lightningBalance.remoteBalance,tooltip:"Amount you can receive"}],this.logger.info(t)})}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-transactions"]],decls:19,vars:4,consts:[["fxLayout","row wrap","fxLayoutAlign","start center",1,"page-title-container"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxLayout","column",1,"padding-gap-x","mb-4"],["fxLayout","column"],[3,"values"],["fxLayout","row","fxLayoutAlign","start center",1,"page-title-container"],["fxLayout","column",1,"padding-gap-x"],["mat-tab-nav-bar",""],["role","tab","mat-tab-link","","class","mat-tab-label",3,"active","routerLink","click",4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch",1,"mat-tab-body-wrapper"],["role","tab","mat-tab-link","",1,"mat-tab-label",3,"active","routerLink","click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s._UZ(1,"fa-icon",1),s.TgZ(2,"span",2),s._uU(3,"Lightning Balance"),s.qZA(),s.qZA(),s.TgZ(4,"div",3),s.TgZ(5,"mat-card"),s.TgZ(6,"mat-card-content",4),s._UZ(7,"rtl-currency-unit-converter",5),s.qZA(),s.qZA(),s.qZA(),s.TgZ(8,"div",6),s._UZ(9,"fa-icon",1),s.TgZ(10,"span",2),s._uU(11,"Lightning Transactions"),s.qZA(),s.qZA(),s.TgZ(12,"div",7),s.TgZ(13,"mat-card"),s.TgZ(14,"mat-card-content",4),s.TgZ(15,"nav",8),s.YNc(16,Ra,2,3,"div",9),s.qZA(),s.TgZ(17,"div",10),s._UZ(18,"router-outlet"),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(1),s.Q6J("icon",e.faChartPie),s.xp6(6),s.Q6J("values",e.balances),s.xp6(2),s.Q6J("icon",e.faExchangeAlt),s.xp6(7),s.Q6J("ngForOf",e.links))},directives:[l.xw,l.Wh,C.BN,S.a8,S.dn,ia.D,ut.BU,a.sg,l.yH,i.lC,ut.Nj,i.rH],styles:[""]}),t})();function Ma(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",11),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().activeLink=e.link}),s._uU(1),s.qZA()}if(2&t){const t=e.$implicit,n=s.oxw();s.s9C("routerLink",t.link),s.Q6J("active",n.activeLink===t.link),s.xp6(1),s.Oqu(t.name)}}let Ja=(()=>{class t{constructor(t){this.router=t,this.faMapSigns=g.SuH,this.events=[],this.flgLoading=[!0],this.errorMessage="",this.links=[{link:"forwardinghistory",name:"Forwarding History"},{link:"peers",name:"Routing Peers"}],this.activeLink=this.links[0].link,this.unSubs=[new d.x,new d.x,new d.x]}ngOnInit(){const t=this.links.find(t=>this.router.url.includes(t.link));this.activeLink=t?t.link:this.links[0].link,this.router.events.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t instanceof i.Av)).subscribe(t=>{const e=this.links.find(e=>t.urlAfterRedirects.includes(e.link));this.activeLink=e?e.link:this.links[0].link})}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-routing"]],decls:13,vars:2,consts:[["fxLayout","column"],["fxLayout","row","fxLayoutAlign","start center",1,"page-title-container"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxLayout","row","fxFlex","100","fxLayoutAlign","start start",1,"padding-gap-x"],["fxLayout","row","fxFlex","100","fxLayoutAlign","start start"],["fxLayout","column","fxFlex","100","fxLayoutAlign","start stretch"],["fxLayout","row","fxFlex","100"],["mat-tab-nav-bar","","fxFlex","100"],["role","tab","mat-tab-link","","class","mat-tab-label",3,"active","routerLink","click",4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","100","fxLayoutAlign","start stretch",1,"padding-gap-x-large"],["role","tab","mat-tab-link","",1,"mat-tab-label",3,"active","routerLink","click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"fa-icon",2),s.TgZ(3,"span",3),s._uU(4,"Routing"),s.qZA(),s.qZA(),s.TgZ(5,"div",4),s.TgZ(6,"mat-card",5),s.TgZ(7,"mat-card-content",6),s.TgZ(8,"div",7),s.TgZ(9,"nav",8),s.YNc(10,Ma,2,3,"div",9),s.qZA(),s.qZA(),s.TgZ(11,"div",10),s._UZ(12,"router-outlet"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(2),s.Q6J("icon",e.faMapSigns),s.xp6(8),s.Q6J("ngForOf",e.links))},directives:[l.xw,l.Wh,C.BN,l.yH,S.a8,S.dn,ut.BU,a.sg,i.lC,ut.Nj,i.rH],styles:[""]}),t})();var Pa=n(4810),Ya=n(1403),Qa=n(2609);function Ba(t,e){if(1&t&&(s.TgZ(0,"span",10),s.TgZ(1,"div"),s._uU(2),s.ALo(3,"titlecase"),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(2),s.AsE("",n.nodeFeaturesEnum[t.key]||t.key,": ",s.lcZ(3,2,t.value),"")}}function Ha(t,e){1&t&&(s.TgZ(0,"th",25),s._uU(1,"Address"),s.qZA())}function za(t,e){if(1&t&&(s.TgZ(0,"td",26),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",t," ")}}function Va(t,e){1&t&&(s.TgZ(0,"th",27),s.TgZ(1,"span",28),s._uU(2,"Actions"),s.qZA(),s.qZA())}function Ga(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",29),s.TgZ(1,"span",28),s.TgZ(2,"button",30),s.NdJ("copied",function(e){return s.CHM(t),s.oxw(2).onCopyNodeURI(e)}),s._uU(3,"Copy Node URI"),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit,n=s.oxw(2);s.xp6(2),s.Q6J("payload",(null==n.lookupResult?null:n.lookupResult.nodeId)+"@"+t)}}function Xa(t,e){1&t&&s._UZ(0,"tr",31)}function $a(t,e){1&t&&s._UZ(0,"tr",32)}const Wa=function(t){return{"background-color":t}};function Ka(t,e){if(1&t&&(s.TgZ(0,"div",1),s._UZ(1,"mat-divider",2),s.TgZ(2,"div",3),s.TgZ(3,"div",4),s.TgZ(4,"h4",5),s._uU(5,"Alias"),s.qZA(),s.TgZ(6,"span",6),s._uU(7),s.TgZ(8,"span",7),s._uU(9),s.qZA(),s.qZA(),s.qZA(),s.TgZ(10,"div",4),s.TgZ(11,"h4",5),s._uU(12,"Date/Time"),s.qZA(),s.TgZ(13,"span",6),s._uU(14),s.ALo(15,"date"),s.qZA(),s.qZA(),s.qZA(),s._UZ(16,"mat-divider",8),s.TgZ(17,"div",3),s.TgZ(18,"div",9),s.TgZ(19,"h4",5),s._uU(20,"Pub Key"),s.qZA(),s.TgZ(21,"span",10),s._uU(22),s.qZA(),s.qZA(),s.qZA(),s._UZ(23,"mat-divider",2),s.TgZ(24,"div",3),s.TgZ(25,"div",9),s.TgZ(26,"h4",5),s._uU(27,"Signature"),s.qZA(),s.TgZ(28,"span",6),s._uU(29),s.qZA(),s.qZA(),s.qZA(),s._UZ(30,"mat-divider",8),s.TgZ(31,"div",3),s.TgZ(32,"div",9),s.TgZ(33,"h4",5),s._uU(34,"Features"),s.qZA(),s.YNc(35,Ba,4,4,"span",11),s.ALo(36,"keyvalue"),s.qZA(),s.qZA(),s.TgZ(37,"div",12),s.TgZ(38,"h4",13),s._uU(39,"Addresses"),s.qZA(),s.TgZ(40,"div",14),s.TgZ(41,"table",15,16),s.ynx(43,17),s.YNc(44,Ha,2,0,"th",18),s.YNc(45,za,2,1,"td",19),s.BQk(),s.ynx(46,20),s.YNc(47,Va,3,0,"th",21),s.YNc(48,Ga,4,1,"td",22),s.BQk(),s.YNc(49,Xa,1,0,"tr",23),s.YNc(50,$a,1,0,"tr",24),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("inset",!0),s.xp6(6),s.Oqu(null==t.lookupResult?null:t.lookupResult.alias),s.xp6(1),s.Q6J("ngStyle",s.VKq(19,Wa,null==t.lookupResult?null:t.lookupResult.rgbColor)),s.xp6(1),s.Oqu(null!=t.lookupResult&&t.lookupResult.rgbColor?null==t.lookupResult?null:t.lookupResult.rgbColor:""),s.xp6(5),s.Oqu(s.xi3(15,14,1e3*(null==t.lookupResult?null:t.lookupResult.timestamp),"dd/MMM/YYYY HH:mm")),s.xp6(2),s.Q6J("inset",!0),s.xp6(6),s.Oqu(null==t.lookupResult?null:t.lookupResult.nodeId),s.xp6(1),s.Q6J("inset",!0),s.xp6(6),s.Oqu(null==t.lookupResult?null:t.lookupResult.signature),s.xp6(1),s.Q6J("inset",!0),s.xp6(5),s.Q6J("ngForOf",s.lcZ(36,17,null==t.lookupResult?null:t.lookupResult.features.activated)),s.xp6(6),s.Q6J("dataSource",t.addresses),s.xp6(8),s.Q6J("matHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns)}}let ja=(()=>{class t{constructor(t,e){this.logger=t,this.snackBar=e,this.lookupResult={},this.displayedColumns=["address","actions"],this.nodeFeaturesEnum=f.H_}ngOnInit(){this.addresses=new ht.by(this.lookupResult.addresses?[...this.lookupResult.addresses]:[]),this.addresses.data=this.lookupResult.addresses||[],this.addresses.sort=this.sort,this.addresses.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null}onCopyNodeURI(t){this.snackBar.open("Node URI copied."),this.logger.info("Copied Text: "+t)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(Ya.ux))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-node-lookup"]],viewQuery:function(t,e){if(1&t&&s.Gf(mt.YE,5),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first)}},inputs:{lookupResult:"lookupResult"},decls:1,vars:1,consts:[["fxLayout","column","class","mt-1",4,"ngIf"],["fxLayout","column",1,"mt-1"],[1,"my-1",3,"inset"],["fxLayout","row"],["fxFlex","50"],["fxLayoutAlign","start",1,"font-bold-500"],[1,"foreground-secondary-text"],[1,"ml-2",3,"ngStyle"],[1,"mb-1",3,"inset"],["fxFlex","100"],[1,"foreground-secondary-text","w-100"],["class","foreground-secondary-text w-100",4,"ngFor","ngForOf"],["fxLayout","column",1,"mt-2"],["fxFlex","100","fxLayoutAlign","start",1,"font-bold-500","mb-1"],["fxLayout","row","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mat-table","","matSort","",1,"overflow-auto",3,"dataSource"],["table",""],["matColumnDef","address"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","pl-1",4,"matHeaderCellDef"],["mat-cell","","class","pl-1",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"pl-1"],["fxLayoutAlign","end center"],["mat-cell","",1,"pl-1"],["mat-stroked-button","","color","primary","type","button","tabindex","1","rtlClipboard","",3,"payload","copied"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&s.YNc(0,Ka,51,21,"div",0),2&t&&s.Q6J("ngIf",e.lookupResult)},directives:[a.O5,l.xw,E.d,l.yH,l.Wh,a.PC,v.Zl,a.sg,M.$V,ht.BZ,mt.YE,ht.w1,ht.fO,ht.Dz,ht.as,ht.nj,ht.ge,mt.nU,ht.ev,b.lW,Qa.y,ht.XQ,ht.Gk],pipes:[a.uU,a.Nd,a.rS],styles:[""]}),t})();const ti=["form"];function ei(t,e){if(1&t&&(s.TgZ(0,"mat-error"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.hij("",null==t.lookupFields[t.selectedFieldId]?null:t.lookupFields[t.selectedFieldId].placeholder," is required.")}}function ni(t,e){if(1&t&&(s.TgZ(0,"mat-error"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.hij("Invalid ",null==t.lookupFields[t.selectedFieldId]?null:t.lookupFields[t.selectedFieldId].placeholder,".")}}function ai(t,e){if(1&t&&(s.TgZ(0,"div"),s._UZ(1,"rtl-ecl-node-lookup",29),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Q6J("lookupResult",t.nodeLookupValue)}}function ii(t,e){if(1&t&&(s.TgZ(0,"span",27),s.YNc(1,ai,2,1,"div",28),s.qZA()),2&t){const t=s.oxw(2),e=s.MAs(26);s.xp6(1),s.Q6J("ngIf",t.nodeLookupValue.nodeId)("ngIfElse",e)}}function oi(t,e){1&t&&(s.TgZ(0,"span",27),s.TgZ(1,"h3"),s._uU(2,"Error! Unable to find details!"),s.qZA(),s.qZA())}function si(t,e){if(1&t&&(s.TgZ(0,"div",21),s.TgZ(1,"div",22),s.TgZ(2,"span",23),s._uU(3),s.qZA(),s.qZA(),s.TgZ(4,"div",24),s.YNc(5,ii,2,2,"span",25),s.YNc(6,oi,3,0,"span",26),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(3),s.hij("",t.lookupFields[t.selectedFieldId].name," Details"),s.xp6(1),s.Q6J("ngSwitch",t.selectedFieldId),s.xp6(1),s.Q6J("ngSwitchCase",0)}}function li(t,e){1&t&&(s.TgZ(0,"h3"),s._uU(1,"Error! Unable to find details!"),s.qZA())}const ri=function(t){return{"mt-2":t}};let ci=(()=>{class t{constructor(t,e,n,a){this.logger=t,this.commonService=e,this.store=n,this.actions=a,this.lookupKeyCtrl=new Zt.NI,this.nodeLookupValue={},this.channelLookupValue=[],this.flgSetLookupValue=!1,this.messageObj=[],this.selectedFieldId=0,this.lookupFields=[{id:0,name:"Node",placeholder:"Node ID"},{id:1,name:"Channel",placeholder:"Short Channel ID"}],this.flgLoading=[!0],this.faSearch=g.wn1,this.screenSize="",this.screenSizeEnum=f.cu,this.unSubs=[new d.x,new d.x],this.screenSize=this.commonService.getScreenSize()}ngOnInit(){this.actions.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t.type===f.lr.SET_LOOKUP_ECL||t.type===f.lr.UPDATE_API_CALL_STATUS_ECL)).subscribe(t=>{if(t.type===f.lr.SET_LOOKUP_ECL){switch(this.flgLoading[0]=!0,this.selectedFieldId){case 0:this.nodeLookupValue=JSON.parse(JSON.stringify(t.payload[0]))||{nodeid:""};break;case 1:this.channelLookupValue=JSON.parse(JSON.stringify(t.payload))||[]}this.flgSetLookupValue=!0,this.logger.info(this.nodeLookupValue),this.logger.info(this.channelLookupValue)}t.type===f.lr.UPDATE_API_CALL_STATUS_ECL&&t.payload.status===f.Bn.ERROR&&"Lookup"===t.payload.action&&(this.flgLoading[0]="error")}),this.lookupKeyCtrl.valueChanges.pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.nodeLookupValue={},this.channelLookupValue=[],this.flgSetLookupValue=!1})}onLookup(){if(!this.lookupKeyCtrl.value)return this.lookupKeyCtrl.setErrors({required:!0}),!0;if(this.lookupKeyCtrl.value&&(this.lookupKeyCtrl.value.includes("@")||this.lookupKeyCtrl.value.includes(",")))return this.lookupKeyCtrl.setErrors({invalid:!0}),!0;switch(this.selectedFieldId||(this.selectedFieldId=0),this.flgSetLookupValue=!1,this.nodeLookupValue={},this.channelLookupValue=[],this.selectedFieldId){case 0:this.store.dispatch((0,ft.Sf)({payload:this.lookupKeyCtrl.value.trim()}))}}onSelectChange(t){this.resetData(),this.selectedFieldId=t.value}resetData(){this.flgSetLookupValue=!1,this.nodeLookupValue={},this.channelLookupValue=[],this.lookupKeyCtrl.setValue(""),this.lookupKeyCtrl.setErrors(null),this.form.resetForm()}clearLookupValue(){this.nodeLookupValue={},this.channelLookupValue=[],this.flgSetLookupValue=!1}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(A.v),s.Y36(y.yh),s.Y36(xt.eX))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-lookups"]],viewQuery:function(t,e){if(1&t&&s.Gf(ti,7),2&t){let t;s.iGM(t=s.CRH())&&(e.form=t.first)}},decls:27,vars:10,consts:[["fxLayout","column"],["fxLayout","row","fxLayoutAlign","start end",1,"page-title-container"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxLayout","row","fxFlex","100","fxLayoutAlign","start start",1,"padding-gap"],["fxLayout","row","fxFlex","100","fxLayoutAlign","start start"],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch",1,"card-content-gap","mt-1"],["fxFlex","100","fxLayout","column","fxLayout.gt-sm","row wrap","fxLayoutAlign.gt-sm","space-between center","fxLayoutAlign","start space-between",1,"w-100"],["form","ngForm"],["fxFlex","20","fxFlex.gt-md","15","fxLayoutAlign","start end"],["color","primary","tabindex","1","name","lookupField"],["checked","",1,"mr-4",3,"value"],["fxFlex","80","fxFlex.gt-md","85","fxLayoutAlign","start end",3,"ngClass"],["matInput","","name","lookupKey","tabindex","2","required","",3,"formControl","placeholder"],["key",""],[4,"ngIf"],["fxLayout","row",1,"mt-2"],["mat-stroked-button","","color","primary","tabindex","3","type","button",1,"mr-1",3,"click"],["mat-flat-button","","color","primary","tabindex","4","type","submit",3,"click"],["fxFlex","100","fxLayout","column","fxLayout.gt-sm","row wrap","fxLayoutAlign.gt-sm","space-between center","fxLayoutAlign","start stretch","class","w-100 mt-2",4,"ngIf"],["errorBlock",""],["fxFlex","100","fxLayout","column","fxLayout.gt-sm","row wrap","fxLayoutAlign.gt-sm","space-between center","fxLayoutAlign","start stretch",1,"w-100","mt-2"],["fxLayout","row","fxFlex","100","fxLayoutAlign","start center"],[1,"page-title","font-bold-500"],["fxLayout","row","fxFlex","100","fxLayoutAlign","start center",3,"ngSwitch"],["fxFlex","100",4,"ngSwitchCase"],["fxFlex","100",4,"ngSwitchDefault"],["fxFlex","100"],[4,"ngIf","ngIfElse"],[3,"lookupResult"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"fa-icon",2),s.TgZ(3,"span",3),s._uU(4,"Graph Lookups"),s.qZA(),s.qZA(),s.TgZ(5,"div",4),s.TgZ(6,"mat-card",5),s.TgZ(7,"mat-card-content",6),s.TgZ(8,"form",7,8),s.TgZ(10,"div",9),s.TgZ(11,"mat-radio-group",10),s.TgZ(12,"mat-radio-button",11),s._uU(13,"Node"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(14,"mat-form-field",12),s._UZ(15,"input",13,14),s.YNc(17,ei,2,1,"mat-error",15),s.YNc(18,ni,2,1,"mat-error",15),s.qZA(),s.TgZ(19,"div",16),s.TgZ(20,"button",17),s.NdJ("click",function(){return e.resetData()}),s._uU(21,"Clear"),s.qZA(),s.TgZ(22,"button",18),s.NdJ("click",function(){return e.onLookup()}),s._uU(23,"Lookup"),s.qZA(),s.qZA(),s.qZA(),s.YNc(24,si,7,3,"div",19),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(25,li,2,0,"ng-template",null,20,s.W1O)),2&t&&(s.xp6(2),s.Q6J("icon",e.faSearch),s.xp6(10),s.Q6J("value",0),s.xp6(2),s.Q6J("ngClass",s.VKq(8,ri,e.screenSize===e.screenSizeEnum.XS||e.screenSize===e.screenSizeEnum.SM)),s.xp6(1),s.Q6J("formControl",e.lookupKeyCtrl)("placeholder",(null==e.lookupFields[e.selectedFieldId]?null:e.lookupFields[e.selectedFieldId].placeholder)||"Lookup Key"),s.xp6(2),s.Q6J("ngIf",null==e.lookupKeyCtrl.errors?null:e.lookupKeyCtrl.errors.required),s.xp6(1),s.Q6J("ngIf",null==e.lookupKeyCtrl.errors?null:e.lookupKeyCtrl.errors.invalid),s.xp6(6),s.Q6J("ngIf",e.flgSetLookupValue))},directives:[l.xw,l.Wh,C.BN,l.yH,S.a8,S.dn,Zt._Y,Zt.JL,Zt.F,Pa.VQ,Pa.U0,k.KE,a.mk,v.oO,yt.Nt,Zt.Fj,Zt.Q7,Zt.JJ,Zt.oH,a.O5,b.lW,k.TO,a.RF,a.n9,a.ED,ja],styles:[".tree-invisible[_ngcontent-%COMP%]{display:none}.lookup-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .lookup-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}.pl-3[_ngcontent-%COMP%]{padding-left:3rem}"]}),t})();var ui=n(7969);let di=(()=>{class t{constructor(t,e){this.store=t,this.eclEffects=e,this.newAddress=""}onGenerateAddress(){this.store.dispatch((0,ft._E)()),this.eclEffects.setNewAddress.pipe((0,de.q)(1)).subscribe(t=>{this.newAddress=t,this.store.dispatch((0,It.qR)({payload:{data:{address:this.newAddress,addressType:"",component:ui.n}}}))})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(y.yh),s.Y36(pe.o))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-on-chain-receive"]],decls:4,vars:0,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch"],["fxLayout","row"],["mat-flat-button","","color","primary","tabindex","1",3,"click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"button",2),s.NdJ("click",function(){return e.onGenerateAddress()}),s._uU(3,"Generate Address"),s.qZA(),s.qZA(),s.qZA())},directives:[l.xw,l.yH,l.Wh,b.lW],styles:[""]}),t})(),pi=(()=>{class t{constructor(t,e){this.store=t,this.activatedRoute=e,this.sweepAll=!1,this.unSubs=[new d.x,new d.x]}ngOnInit(){this.activatedRoute.data.pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.sweepAll=t.sweepAll})}openSendFundsModal(){this.store.dispatch((0,It.qR)({payload:{data:{sweepAll:this.sweepAll,component:aa}}}))}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(y.yh),s.Y36(i.gz))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-on-chain-send"]],decls:4,vars:1,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch"],["fxLayout","row"],["mat-flat-button","","color","primary","type","button","tabindex","1",3,"click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"button",2),s.NdJ("click",function(){return e.openSendFundsModal()}),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Oqu(e.sweepAll?"Sweep All":"Send Funds"))},directives:[l.xw,l.yH,l.Wh,b.lW],styles:[""]}),t})();var mi=n(1258),hi=n(1681),gi=n(3474),fi=n(7521),xi=n(84);const Zi=["form"];function yi(t,e){if(1&t&&(s.TgZ(0,"mat-option",34),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.Q6J("value",t),s.xp6(1),s.Oqu(t.alias?t.alias:t.nodeId?t.nodeId:"")}}function Ai(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Peer alias is required."),s.qZA())}function Ci(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Peer not found in the list."),s.qZA())}function Ti(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"mat-form-field",1),s.TgZ(1,"input",30),s.NdJ("change",function(){return s.CHM(t),s.oxw().onSelectedPeerChanged()}),s.qZA(),s.TgZ(2,"mat-autocomplete",31,32),s.NdJ("optionSelected",function(){return s.CHM(t),s.oxw().onSelectedPeerChanged()}),s.YNc(4,yi,2,2,"mat-option",33),s.ALo(5,"async"),s.qZA(),s.YNc(6,Ai,2,0,"mat-error",17),s.YNc(7,Ci,2,0,"mat-error",17),s.qZA()}if(2&t){const t=s.MAs(3),e=s.oxw();s.xp6(1),s.Q6J("formControl",e.selectedPeer)("matAutocomplete",t),s.xp6(1),s.Q6J("displayWith",e.displayFn),s.xp6(2),s.Q6J("ngForOf",s.lcZ(5,6,e.filteredPeers)),s.xp6(2),s.Q6J("ngIf",null==e.selectedPeer.errors?null:e.selectedPeer.errors.required),s.xp6(1),s.Q6J("ngIf",null==e.selectedPeer.errors?null:e.selectedPeer.errors.notfound)}}function Si(t,e){1&t&&s.GkF(0)}function wi(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Amount is required."),s.qZA())}function vi(t,e){if(1&t&&(s.TgZ(0,"mat-error"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.hij("Amount must be less than or equal to ",t.totalBalance,".")}}function bi(t,e){if(1&t&&(s.TgZ(0,"span"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.channelConnectionError)}}function qi(t,e){if(1&t&&(s.TgZ(0,"div",35),s._UZ(1,"fa-icon",36),s.YNc(2,bi,2,1,"span",17),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("icon",t.faExclamationTriangle),s.xp6(1),s.Q6J("ngIf",""!==t.channelConnectionError)}}function Li(t,e){if(1&t&&(s.TgZ(0,"mat-expansion-panel",38),s.TgZ(1,"mat-expansion-panel-header"),s.TgZ(2,"mat-panel-title"),s.TgZ(3,"span"),s._uU(4,"Peer: \xa0"),s.qZA(),s.TgZ(5,"strong",39),s._uU(6),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"div",9),s.TgZ(8,"div",0),s.TgZ(9,"div",1),s.TgZ(10,"h4",40),s._uU(11,"Pubkey"),s.qZA(),s.TgZ(12,"span",41),s._uU(13),s.qZA(),s.qZA(),s.qZA(),s._UZ(14,"mat-divider",42),s.TgZ(15,"div",0),s.TgZ(16,"div",43),s.TgZ(17,"h4",40),s._uU(18,"Address"),s.qZA(),s.TgZ(19,"span",44),s._uU(20),s.qZA(),s.qZA(),s.TgZ(21,"div",43),s.TgZ(22,"h4",40),s._uU(23,"State"),s.qZA(),s.TgZ(24,"span",44),s._uU(25),s.ALo(26,"titlecase"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t){const t=s.oxw(2);s.xp6(6),s.Oqu((null==t.peer?null:t.peer.alias)||(null==t.peer?null:t.peer.nodeId)),s.xp6(7),s.Oqu(t.peer.nodeId),s.xp6(7),s.Oqu(null==t.peer?null:t.peer.address),s.xp6(5),s.Oqu(s.lcZ(26,4,null==t.peer?null:t.peer.state))}}function _i(t,e){if(1&t&&s.YNc(0,Li,27,6,"mat-expansion-panel",37),2&t){const t=s.oxw();s.Q6J("ngIf",t.peer)}}let Ii=(()=>{class t{constructor(t,e,n,a){this.dialogRef=t,this.data=e,this.store=n,this.actions=a,this.selectedPeer=new Zt.NI,this.faExclamationTriangle=g.eHv,this.channelConnectionError="",this.advancedTitle="Advanced Options",this.totalBalance=0,this.selectedPubkey="",this.isPrivate=!1,this.feeRate=null,this.unSubs=[new d.x,new d.x]}ngOnInit(){this.information=this.data.message.information,this.totalBalance=this.data.message.balance,this.alertTitle=this.data.alertTitle,this.peer=this.data.message.peer||null,this.peers=this.data.message.peers||[],this.actions.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t.type===f.lr.UPDATE_API_CALL_STATUS_ECL||t.type===f.lr.FETCH_CHANNELS_ECL)).subscribe(t=>{t.type===f.lr.UPDATE_API_CALL_STATUS_ECL&&t.payload.status===f.Bn.ERROR&&"SaveNewChannel"===t.payload.action&&(this.channelConnectionError=t.payload.message),t.type===f.lr.FETCH_CHANNELS_ECL&&this.dialogRef.close()});let t="",e="";this.sortedPeers=this.peers.sort((n,a)=>(t=n.alias?n.alias.toLowerCase():n.nodeId?n.nodeId.toLowerCase():"",e=a.alias?a.alias.toLowerCase():n.nodeId.toLowerCase(),t<e?-1:t>e?1:0)),this.filteredPeers=this.selectedPeer.valueChanges.pipe((0,p.R)(this.unSubs[1]),(0,mi.O)(""),(0,hi.U)(t=>"string"==typeof t?t:t.alias?t.alias:t.nodeId),(0,hi.U)(t=>t?this.filterPeers(t):this.sortedPeers.slice()))}filterPeers(t){return this.sortedPeers.filter(e=>0===e.alias.toLowerCase().indexOf(t?t.toLowerCase():""))}displayFn(t){return t&&t.alias?t.alias:t&&t.nodeId?t.nodeId:""}onSelectedPeerChanged(){if(this.channelConnectionError="",this.selectedPubkey=this.selectedPeer.value&&this.selectedPeer.value.nodeId?this.selectedPeer.value.nodeId:null,"string"==typeof this.selectedPeer.value){const t=this.peers.filter(t=>t.alias.length===this.selectedPeer.value.length&&0===t.alias.toLowerCase().indexOf(this.selectedPeer.value?this.selectedPeer.value.toLowerCase():""));1===t.length&&t[0].nodeId&&(this.selectedPubkey=t[0].nodeId)}this.selectedPeer.setErrors(this.selectedPeer.value&&!this.selectedPubkey?{notfound:!0}:null)}onClose(){this.dialogRef.close(!1)}resetData(){this.feeRate=null,this.selectedPeer.setValue(""),this.fundingAmount=null,this.isPrivate=!1,this.channelConnectionError="",this.advancedTitle="Advanced Options",this.form.resetForm()}onAdvancedPanelToggle(t){this.advancedTitle=t&&this.feeRate&&this.feeRate>0?"Advanced Options | Fee (Sats/vByte): "+this.feeRate:"Advanced Options"}onOpenChannel(){if(!this.peer&&!this.selectedPubkey||!this.fundingAmount||this.totalBalance-this.fundingAmount<0)return!0;this.store.dispatch((0,ft.YX)({payload:{nodeId:this.peer&&this.peer.nodeId?this.peer.nodeId:this.selectedPubkey,amount:this.fundingAmount,private:this.isPrivate,feeRate:this.feeRate}}))}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(gt.so),s.Y36(gt.WI),s.Y36(y.yh),s.Y36(xt.eX))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-open-channel"]],viewQuery:function(t,e){if(1&t&&s.Gf(Zi,7),2&t){let t;s.iGM(t=s.CRH())&&(e.form=t.first)}},decls:48,vars:18,consts:[["fxLayout","row"],["fxFlex","100"],["fxLayout","row","fxLayoutAlign","space-between center",1,"modal-info-header"],["fxFlex","95","fxLayoutAlign","start start"],[1,"page-title"],["tabindex","8","fxFlex","5","fxLayoutAlign","center","mat-button","",1,"btn-close-x","p-0",3,"click"],[1,"padding-gap-x-large"],["fxLayout","column",3,"submit","reset"],["form","ngForm"],["fxLayout","column"],["fxFlex","100",4,"ngIf"],[4,"ngTemplateOutlet"],["fxLayout","row","fxFlex","100","fxLayoutAlign","space-between center"],["fxFlex","70","fxLayoutAlign","start end"],["matInput","","placeholder","Amount","type","number","tabindex","1","required","","name","amount",3,"ngModel","step","min","max","ngModelChange"],["amount","ngModel"],["matSuffix",""],[4,"ngIf"],["fxFlex","25","fxLayoutAlign","start center"],["tabindex","2","color","primary","name","isPrivate",3,"ngModel","ngModelChange"],["expanded","false",1,"flat-expansion-panel","mt-2",3,"closed","opened"],["fxLayout","column","fxFlex","100","fxLayoutAlign","start stretch"],["fxFlex","48","fxLayout","row","fxLayoutAlign","start center"],["matInput","","placeholder","Fee (Sats/vByte)","type","number","name","fee","tabindex","7",3,"ngModel","step","min","ngModelChange"],["fee","ngModel"],["fxFlex","100","class","alert alert-danger mt-1",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center",1,"mt-2"],["mat-stroked-button","","color","primary","tabindex","7","type","reset",1,"mr-1"],["autoFocus","","mat-flat-button","","color","primary","type","submit","tabindex","9"],["peerDetailsExpansionBlock",""],["type","text","placeholder","Peer Alias","aria-label","Peers","matInput","","tabindex","1","required","",3,"formControl","matAutocomplete","change"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["fxFlex","100",1,"alert","alert-danger","mt-1"],[1,"mr-1","alert-icon",3,"icon"],["class","flat-expansion-panel my-1","expanded","false",4,"ngIf"],["expanded","false",1,"flat-expansion-panel","my-1"],[1,"font-weight-900"],["fxLayoutAlign","start",1,"font-bold-500"],[1,"foreground-secondary-text"],[1,"w-100","my-1"],["fxFlex","50"],[1,"overflow-wrap","foreground-secondary-text"]],template:function(t,e){if(1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-card-header",2),s.TgZ(3,"div",3),s.TgZ(4,"span",4),s._uU(5),s.qZA(),s.qZA(),s.TgZ(6,"button",5),s.NdJ("click",function(){return e.onClose()}),s._uU(7,"X"),s.qZA(),s.qZA(),s.TgZ(8,"mat-card-content",6),s.TgZ(9,"form",7,8),s.NdJ("submit",function(){return e.onOpenChannel()})("reset",function(){return e.resetData()}),s.TgZ(11,"div",9),s.YNc(12,Ti,8,8,"mat-form-field",10),s.qZA(),s.YNc(13,Si,1,0,"ng-container",11),s.TgZ(14,"div",9),s.TgZ(15,"div",12),s.TgZ(16,"mat-form-field",13),s.TgZ(17,"input",14,15),s.NdJ("ngModelChange",function(t){return e.fundingAmount=t}),s.qZA(),s.TgZ(19,"mat-hint"),s._uU(20),s.ALo(21,"number"),s.qZA(),s.TgZ(22,"span",16),s._uU(23," Sats "),s.qZA(),s.YNc(24,wi,2,0,"mat-error",17),s.YNc(25,vi,2,1,"mat-error",17),s.qZA(),s.TgZ(26,"div",18),s.TgZ(27,"mat-slide-toggle",19),s.NdJ("ngModelChange",function(t){return e.isPrivate=t}),s._uU(28,"Private Channel"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(29,"mat-expansion-panel",20),s.NdJ("closed",function(){return e.onAdvancedPanelToggle(!0)})("opened",function(){return e.onAdvancedPanelToggle(!1)}),s.TgZ(30,"mat-expansion-panel-header"),s.TgZ(31,"mat-panel-title"),s.TgZ(32,"span"),s._uU(33),s.qZA(),s.qZA(),s.qZA(),s.TgZ(34,"div",21),s.TgZ(35,"div",12),s.TgZ(36,"div",22),s.TgZ(37,"mat-form-field",1),s.TgZ(38,"input",23,24),s.NdJ("ngModelChange",function(t){return e.feeRate=t}),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(40,qi,3,2,"div",25),s.TgZ(41,"div",26),s.TgZ(42,"button",27),s._uU(43,"Clear Fields"),s.qZA(),s.TgZ(44,"button",28),s._uU(45,"Open Channel"),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(46,_i,1,1,"ng-template",null,29,s.W1O)),2&t){const t=s.MAs(18),n=s.MAs(47);s.xp6(5),s.Oqu(e.alertTitle),s.xp6(7),s.Q6J("ngIf",!e.peer&&e.peers&&e.peers.length>0),s.xp6(1),s.Q6J("ngTemplateOutlet",n),s.xp6(4),s.Q6J("ngModel",e.fundingAmount)("step",1e3)("min",1)("max",e.totalBalance),s.xp6(3),s.hij("Remaining Bal: ",s.lcZ(21,16,e.totalBalance-(e.fundingAmount?e.fundingAmount:0)),""),s.xp6(4),s.Q6J("ngIf",null==t.errors?null:t.errors.required),s.xp6(1),s.Q6J("ngIf",null==t.errors?null:t.errors.max),s.xp6(2),s.Q6J("ngModel",e.isPrivate),s.xp6(6),s.Oqu(e.advancedTitle),s.xp6(5),s.Q6J("ngModel",e.feeRate)("step",1)("min",0),s.xp6(2),s.Q6J("ngIf",""!==e.channelConnectionError)}},directives:[l.xw,l.yH,S.dk,l.Wh,b.lW,S.dn,Zt._Y,Zt.JL,Zt.F,a.O5,a.tP,k.KE,yt.Nt,Zt.wV,Zt.qQ,Zt.Fd,Zt.Fj,Ct.q,gi.F,Zt.Q7,Zt.JJ,Zt.On,k.bx,k.R9,fi.Rr,Se.ib,Se.yz,Se.yK,At.h,xi.ZL,Zt.oH,xi.XC,a.sg,St.ey,k.TO,C.BN,E.d],pipes:[a.JJ,a.Ov,a.rS],styles:[".open-inputs-box[_ngcontent-%COMP%]{padding:1.2rem 2.4rem .8rem!important}"]}),t})();function Ni(t,e){if(1&t&&(s.TgZ(0,"span",7),s._uU(1,"Open"),s.qZA()),2&t){const t=s.oxw();s.s9C("matBadge",t.numOfOpenChannels)}}function Di(t,e){if(1&t&&(s.TgZ(0,"span",7),s._uU(1,"Pending"),s.qZA()),2&t){const t=s.oxw();s.s9C("matBadge",t.numOfPendingChannels)}}function Fi(t,e){if(1&t&&(s.TgZ(0,"span",7),s._uU(1,"Inactive"),s.qZA()),2&t){const t=s.oxw();s.s9C("matBadge",t.numOfInactiveChannels)}}let Ui=(()=>{class t{constructor(t,e,n){this.logger=t,this.store=e,this.router=n,this.numOfOpenChannels=0,this.numOfPendingChannels=0,this.numOfInactiveChannels=0,this.selNode={},this.information={},this.peers=[],this.totalBalance=0,this.links=[{link:"open",name:"Open"},{link:"pending",name:"Pending"},{link:"inactive",name:"Inactive"}],this.activeLink=0,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x,new d.x]}ngOnInit(){this.activeLink=this.links.findIndex(t=>t.link===this.router.url.substring(this.router.url.lastIndexOf("/")+1)),this.router.events.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t instanceof i.Av)).subscribe(t=>{this.activeLink=this.links.findIndex(e=>e.link===t.urlAfterRedirects.substring(t.urlAfterRedirects.lastIndexOf("/")+1))}),this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.numOfOpenChannels=t.channelsStatus&&t.channelsStatus.active&&t.channelsStatus.active.channels?t.channelsStatus.active.channels:0,this.numOfPendingChannels=t.channelsStatus&&t.channelsStatus.pending&&t.channelsStatus.pending.channels?t.channelsStatus.pending.channels:0,this.numOfInactiveChannels=t.channelsStatus&&t.channelsStatus.inactive&&t.channelsStatus.inactive.channels?t.channelsStatus.inactive.channels:0,this.logger.info(t)}),this.store.select(x.LR).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.selNode=t}),this.store.select(x.yD).pipe((0,p.R)(this.unSubs[3])).subscribe(t=>{this.information=t}),this.store.select(x.Bo).pipe((0,p.R)(this.unSubs[4])).subscribe(t=>{this.peers=t.peers}),this.store.select(x.kY).pipe((0,p.R)(this.unSubs[5])).subscribe(t=>{this.totalBalance=t.onchainBalance.total})}onOpenChannel(){this.store.dispatch((0,It.qR)({payload:{data:{alertTitle:"Open Channel",message:{peers:this.peers,information:this.information,balance:this.totalBalance},component:Ii}}}))}onSelectedTabChange(t){this.router.navigateByUrl("/ecl/connections/channels/"+this.links[t.index].link)}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channels-tables"]],decls:14,vars:1,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch"],["fxLayout","row"],["mat-flat-button","","color","primary","type","submit","tabindex","1",3,"click"],["fxLayout","column","fxFlex","100",1,"my-2","bordered-box"],[3,"selectedIndex","selectedIndexChange","selectedTabChange"],["mat-tab-label",""],["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch",1,"padding-gap-x-large"],["matBadgeOverlap","false",1,"tab-badge",3,"matBadge"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"button",2),s.NdJ("click",function(){return e.onOpenChannel()}),s._uU(3,"Open Channel"),s.qZA(),s.qZA(),s.TgZ(4,"div",3),s.TgZ(5,"mat-tab-group",4),s.NdJ("selectedIndexChange",function(t){return e.activeLink=t})("selectedTabChange",function(t){return e.onSelectedTabChange(t)}),s.TgZ(6,"mat-tab"),s.YNc(7,Ni,2,1,"ng-template",5),s.qZA(),s.TgZ(8,"mat-tab"),s.YNc(9,Di,2,1,"ng-template",5),s.qZA(),s.TgZ(10,"mat-tab"),s.YNc(11,Fi,2,1,"ng-template",5),s.qZA(),s.qZA(),s.TgZ(12,"div",6),s._UZ(13,"router-outlet"),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(5),s.Q6J("selectedIndex",e.activeLink))},directives:[l.xw,l.yH,l.Wh,b.lW,ut.SP,ut.uX,ut.uD,i.lC,Fa.k],styles:[""]}),t})();function Oi(t,e){if(1&t&&(s.TgZ(0,"div",11),s.TgZ(1,"h4",12),s._uU(2,"Short Channel ID"),s.qZA(),s.TgZ(3,"span",13),s._uU(4),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(4),s.Oqu(t.channel.shortChannelId)}}function ki(t,e){if(1&t&&(s.TgZ(0,"div",11),s.TgZ(1,"h4",12),s._uU(2,"State"),s.qZA(),s.TgZ(3,"span",15),s._uU(4),s.ALo(5,"titlecase"),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(4),s.Oqu(s.lcZ(5,1,t.channel.state))}}function Ri(t,e){if(1&t&&(s.TgZ(0,"div"),s.TgZ(1,"div",9),s.TgZ(2,"div",11),s.TgZ(3,"h4",12),s._uU(4,"Local Balance (Sats)"),s.qZA(),s.TgZ(5,"span",15),s._uU(6),s.ALo(7,"number"),s.qZA(),s.qZA(),s.TgZ(8,"div",11),s.TgZ(9,"h4",12),s._uU(10,"Remote Balance (Sats)"),s.qZA(),s.TgZ(11,"span",15),s._uU(12),s.ALo(13,"number"),s.qZA(),s.qZA(),s.qZA(),s._UZ(14,"mat-divider",14),s.TgZ(15,"div",9),s.TgZ(16,"div",11),s.TgZ(17,"h4",12),s._uU(18,"Base Fee (mSats)"),s.qZA(),s.TgZ(19,"span",15),s._uU(20),s.ALo(21,"number"),s.qZA(),s.qZA(),s.TgZ(22,"div",11),s.TgZ(23,"h4",12),s._uU(24,"Fee Rate (mili mSats)"),s.qZA(),s.TgZ(25,"span",15),s._uU(26),s.ALo(27,"number"),s.qZA(),s.qZA(),s.qZA(),s._UZ(28,"mat-divider",14),s.qZA()),2&t){const t=s.oxw();s.xp6(6),s.Oqu(s.lcZ(7,6,t.channel.toLocal)),s.xp6(6),s.Oqu(s.lcZ(13,8,t.channel.toRemote)),s.xp6(2),s.Q6J("inset",!0),s.xp6(6),s.Oqu(s.lcZ(21,10,t.channel.feeBaseMsat)),s.xp6(6),s.Oqu(s.lcZ(27,12,t.channel.feeProportionalMillionths)),s.xp6(2),s.Q6J("inset",!0)}}function Ei(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Show Advanced"),s.qZA())}function Mi(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Hide Advanced"),s.qZA())}function Ji(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",21),s.NdJ("click",function(){return s.CHM(t),s.oxw().onShowAdvanced()}),s.YNc(1,Ei,2,0,"p",22),s.YNc(2,Mi,2,0,"ng-template",null,23,s.W1O),s.qZA()}if(2&t){const t=s.MAs(3),e=s.oxw();s.xp6(1),s.Q6J("ngIf",!e.showAdvanced)("ngIfElse",t)}}function Pi(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",24),s.NdJ("copied",function(e){return s.CHM(t),s.oxw().onCopyChanID(e)}),s._uU(1,"Copy Short Channel ID"),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("payload",t.channel.shortChannelId)}}function Yi(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"button",25),s.NdJ("copied",function(e){return s.CHM(t),s.oxw().onCopyChanID(e)}),s._uU(1,"Copy Channel ID"),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("payload",t.channel.channelId)}}const Qi=function(t){return{"xs-scroll-y":t}},Bi=function(t,e){return{"mt-2":t,"mt-1":e}};let Hi=(()=>{class t{constructor(t,e,n,a,i){this.dialogRef=t,this.data=e,this.logger=n,this.commonService=a,this.snackBar=i,this.faReceipt=g.dLy,this.showAdvanced=!1,this.channelsType="open",this.screenSize="",this.screenSizeEnum=f.cu}ngOnInit(){this.channel=this.data.channel,this.channelsType=this.data.channelsType,this.screenSize=this.commonService.getScreenSize()}onClose(){this.dialogRef.close(!1)}onShowAdvanced(){this.showAdvanced=!this.showAdvanced}onCopyChanID(t){this.snackBar.open("open"===this.channelsType?"Short channel ID "+t+" copied.":"Channel ID copied."),this.logger.info("Copied Text: "+t)}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(gt.so),s.Y36(gt.WI),s.Y36(Z.mQ),s.Y36(A.v),s.Y36(Ya.ux))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channel-information"]],decls:64,vars:28,consts:[["fxLayout","column","fxLayout.gt-sm","row","fxLayoutAlign","space-between stretch"],["fxFlex","100"],["fxLayout","row","fxLayoutAlign","space-between center",1,"modal-info-header"],["fxFlex","95","fxLayoutAlign","start start"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["tabindex","3","fxFlex","5","fxLayoutAlign","center","mat-button","",1,"btn-close-x","p-0",3,"click"],[1,"padding-gap-x-large",3,"ngClass"],["fxLayout","column"],["fxLayout","row"],["fxFlex","50",4,"ngIf"],["fxFlex","50"],["fxLayoutAlign","start",1,"font-bold-500"],[1,"foreground-secondary-text"],[1,"my-1",3,"inset"],[1,"overflow-wrap","foreground-secondary-text"],[4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","fxFlex","100",3,"ngClass"],["mat-stroked-button","","color","primary","type","reset","tabindex","1","class","mr-1",3,"click",4,"ngIf"],["autoFocus","","mat-flat-button","","color","primary","tabindex","2","type","submit","rtlClipboard","",3,"payload","copied",4,"ngIf"],["autoFocus","","mat-flat-button","","color","primary","tabindex","3","type","submit","rtlClipboard","",3,"payload","copied",4,"ngIf"],["mat-stroked-button","","color","primary","type","reset","tabindex","1",1,"mr-1",3,"click"],[4,"ngIf","ngIfElse"],["hideAdvancedText",""],["autoFocus","","mat-flat-button","","color","primary","tabindex","2","type","submit","rtlClipboard","",3,"payload","copied"],["autoFocus","","mat-flat-button","","color","primary","tabindex","3","type","submit","rtlClipboard","",3,"payload","copied"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-card-header",2),s.TgZ(3,"div",3),s._UZ(4,"fa-icon",4),s.TgZ(5,"span",5),s._uU(6,"Channel Information"),s.qZA(),s.qZA(),s.TgZ(7,"button",6),s.NdJ("click",function(){return e.onClose()}),s._uU(8,"X"),s.qZA(),s.qZA(),s.TgZ(9,"mat-card-content",7),s.TgZ(10,"div",8),s.TgZ(11,"div",9),s.YNc(12,Oi,5,1,"div",10),s.TgZ(13,"div",11),s.TgZ(14,"h4",12),s._uU(15,"Peer Alias"),s.qZA(),s.TgZ(16,"span",13),s._uU(17),s.qZA(),s.qZA(),s.YNc(18,ki,6,3,"div",10),s.qZA(),s._UZ(19,"mat-divider",14),s.TgZ(20,"div",9),s.TgZ(21,"div",1),s.TgZ(22,"h4",12),s._uU(23,"Channel ID"),s.qZA(),s.TgZ(24,"span",13),s._uU(25),s.qZA(),s.qZA(),s.qZA(),s._UZ(26,"mat-divider",14),s.TgZ(27,"div",9),s.TgZ(28,"div",1),s.TgZ(29,"h4",12),s._uU(30,"Peer Public Key"),s.qZA(),s.TgZ(31,"span",13),s._uU(32),s.qZA(),s.qZA(),s.qZA(),s._UZ(33,"mat-divider",14),s.TgZ(34,"div",9),s.TgZ(35,"div",11),s.TgZ(36,"h4",12),s._uU(37,"Private"),s.qZA(),s.TgZ(38,"span",15),s._uU(39),s.qZA(),s.qZA(),s.TgZ(40,"div",11),s.TgZ(41,"h4",12),s._uU(42,"Funder"),s.qZA(),s.TgZ(43,"span",15),s._uU(44),s.qZA(),s.qZA(),s.qZA(),s._UZ(45,"mat-divider",14),s.TgZ(46,"div",9),s.TgZ(47,"div",11),s.TgZ(48,"h4",12),s._uU(49,"State"),s.qZA(),s.TgZ(50,"span",15),s._uU(51),s.ALo(52,"titlecase"),s.qZA(),s.qZA(),s.TgZ(53,"div",11),s.TgZ(54,"h4",12),s._uU(55,"Buried"),s.qZA(),s.TgZ(56,"span",15),s._uU(57),s.qZA(),s.qZA(),s.qZA(),s._UZ(58,"mat-divider",14),s.YNc(59,Ri,29,14,"div",16),s.TgZ(60,"div",17),s.YNc(61,Ji,4,2,"button",18),s.YNc(62,Pi,2,1,"button",19),s.YNc(63,Yi,2,1,"button",20),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(4),s.Q6J("icon",e.faReceipt),s.xp6(5),s.Q6J("ngClass",s.VKq(23,Qi,e.screenSize===e.screenSizeEnum.XS)),s.xp6(3),s.Q6J("ngIf","open"===e.channelsType),s.xp6(5),s.Oqu(e.channel.alias),s.xp6(1),s.Q6J("ngIf","open"!==e.channelsType),s.xp6(1),s.Q6J("inset",!0),s.xp6(6),s.Oqu(e.channel.channelId),s.xp6(1),s.Q6J("inset",!0),s.xp6(6),s.Oqu(e.channel.nodeId),s.xp6(1),s.Q6J("inset",!0),s.xp6(6),s.Oqu(0===e.channel.channelFlags?"Yes":"No"),s.xp6(5),s.Oqu(e.channel.isFunder?"Yes":"No"),s.xp6(1),s.Q6J("inset",!0),s.xp6(6),s.Oqu(s.lcZ(52,21,e.channel.state)),s.xp6(6),s.Oqu(e.channel.buried?"Yes":"No"),s.xp6(1),s.Q6J("inset",!0),s.xp6(1),s.Q6J("ngIf",e.showAdvanced&&"open"===e.channelsType),s.xp6(1),s.Q6J("ngClass",s.WLB(25,Bi,!e.showAdvanced,e.showAdvanced)),s.xp6(1),s.Q6J("ngIf","open"===e.channelsType),s.xp6(1),s.Q6J("ngIf","open"===e.channelsType),s.xp6(1),s.Q6J("ngIf","open"!==e.channelsType))},directives:[l.xw,l.Wh,l.yH,S.dk,C.BN,b.lW,S.dn,a.mk,v.oO,a.O5,E.d,At.h,Qa.y],pipes:[a.rS,a.JJ],styles:[""]}),t})();function zi(t,e){1&t&&s._UZ(0,"mat-progress-bar",30)}function Vi(t,e){1&t&&(s.TgZ(0,"th",31),s._uU(1," Short Channel ID "),s.qZA())}function Gi(t,e){if(1&t&&(s.TgZ(0,"span",37),s._UZ(1,"fa-icon",38),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("icon",t.faEyeSlash)}}function Xi(t,e){if(1&t&&(s.TgZ(0,"span",39),s._UZ(1,"fa-icon",38),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("icon",t.faEye)}}const $i=function(t){return{"max-width":t}};function Wi(t,e){if(1&t&&(s.TgZ(0,"td",32),s.TgZ(1,"div",33),s.YNc(2,Gi,2,1,"span",34),s.YNc(3,Xi,2,1,"span",35),s.TgZ(4,"span",36),s._uU(5),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw();s.xp6(1),s.Q6J("ngStyle",s.VKq(4,$i,n.screenSize===n.screenSizeEnum.XS?"12rem":"22rem")),s.xp6(1),s.Q6J("ngIf",0===t.channelFlags),s.xp6(1),s.Q6J("ngIf",0!==t.channelFlags),s.xp6(2),s.Oqu(null==t?null:t.shortChannelId)}}function Ki(t,e){1&t&&(s.TgZ(0,"th",31),s._uU(1," Alias "),s.qZA())}function ji(t,e){if(1&t&&(s.TgZ(0,"td",32),s.TgZ(1,"div",33),s.TgZ(2,"span",36),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw();s.xp6(1),s.Q6J("ngStyle",s.VKq(2,$i,n.screenSize===n.screenSizeEnum.XS?"12rem":"22rem")),s.xp6(2),s.Oqu(t.alias)}}function to(t,e){1&t&&(s.TgZ(0,"th",40),s._uU(1," Base Fee (mSats) "),s.qZA())}function eo(t,e){if(1&t&&(s.TgZ(0,"td",32),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.feeBaseMsat,"1.0-0")," ")}}function no(t,e){1&t&&(s.TgZ(0,"th",40),s._uU(1," Fee Rate (mili mSats) "),s.qZA())}function ao(t,e){if(1&t&&(s.TgZ(0,"td",32),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.feeProportionalMillionths,"1.0-0")," ")}}function io(t,e){1&t&&(s.TgZ(0,"th",40),s._uU(1," Local Balance (Sats) "),s.qZA())}function oo(t,e){if(1&t&&(s.TgZ(0,"td",32),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.toLocal,"1.0-0")," ")}}function so(t,e){1&t&&(s.TgZ(0,"th",40),s._uU(1," Remote Balance (Sats) "),s.qZA())}function lo(t,e){if(1&t&&(s.TgZ(0,"td",32),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.toRemote,"1.0-0")," ")}}function ro(t,e){1&t&&(s.TgZ(0,"th",42),s._uU(1,"Balance Score "),s.qZA())}function co(t,e){if(1&t&&(s.TgZ(0,"td",43),s.TgZ(1,"div",44),s.TgZ(2,"mat-hint",45),s._uU(3),s.ALo(4,"number"),s.qZA(),s.qZA(),s._UZ(5,"mat-progress-bar",46),s.qZA()),2&t){const t=e.$implicit;s.xp6(3),s.Oqu(s.lcZ(4,2,(null==t?null:t.balancedness)||0)),s.xp6(2),s.s9C("value",t.toLocal&&t.toLocal>0?+t.toLocal/(+t.toLocal+ +t.toRemote)*100:0)}}function uo(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",47),s.TgZ(1,"div",48),s.TgZ(2,"mat-select",49),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",50),s.NdJ("click",function(){return s.CHM(t),s.oxw().onChannelUpdate("all")}),s._uU(5,"Update Fee Policy"),s.qZA(),s.TgZ(6,"mat-option",50),s.NdJ("click",function(){return s.CHM(t),s.oxw().onDownloadCSV()}),s._uU(7,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function po(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",51),s.TgZ(1,"div",52),s.TgZ(2,"mat-select",53),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",50),s.NdJ("click",function(e){const n=s.CHM(t).$implicit;return s.oxw().onChannelClick(n,e)}),s._uU(5,"View Info"),s.qZA(),s.TgZ(6,"mat-option",50),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().onChannelUpdate(e)}),s._uU(7,"Update Fee Policy"),s.qZA(),s.TgZ(8,"mat-option",50),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().onChannelClose(e,!1)}),s._uU(9,"Close Channel"),s.qZA(),s.TgZ(10,"mat-option",50),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().onChannelClose(e,!0)}),s._uU(11,"Force Close"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function mo(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No peers connected. Add a peer in order to open a channel."),s.qZA())}function ho(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No channel available."),s.qZA())}function go(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting channels..."),s.qZA())}function fo(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.errorMessage)}}function xo(t,e){if(1&t&&(s.TgZ(0,"td",54),s.YNc(1,mo,2,0,"p",55),s.YNc(2,ho,2,0,"p",55),s.YNc(3,go,2,0,"p",55),s.YNc(4,fo,2,1,"p",55),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",t.numPeers<1&&(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",t.numPeers>0&&(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const Zo=function(t){return{"display-none":t}};function yo(t,e){if(1&t&&s._UZ(0,"tr",56),2&t){const t=s.oxw();s.Q6J("ngClass",s.VKq(1,Zo,t.numPeers>0&&(null==t.channels?null:t.channels.data)&&(null==t.channels||null==t.channels.data?null:t.channels.data.length)>0))}}function Ao(t,e){1&t&&s._UZ(0,"tr",57)}function Co(t,e){1&t&&s._UZ(0,"tr",58)}const To=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}},So=function(){return["no_peer"]};let wo=(()=>{class t{constructor(t,e,n,a){this.logger=t,this.store=e,this.rtlEffects=n,this.commonService=a,this.faEye=g.Mdf,this.faEyeSlash=g.Aq,this.totalBalance=0,this.displayedColumns=[],this.myChanPolicy={},this.information={},this.numPeers=-1,this.feeRateTypes=f.vn,this.selFilter="",this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["alias","toLocal","toRemote","actions"]):this.screenSize===f.cu.SM?(this.flgSticky=!1,this.displayedColumns=["shortChannelId","alias","toLocal","toRemote","actions"]):this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["shortChannelId","alias","feeBaseMsat","feeProportionalMillionths","toLocal","toRemote","actions"]):(this.flgSticky=!0,this.displayedColumns=["shortChannelId","alias","feeBaseMsat","feeProportionalMillionths","toLocal","toRemote","balancedness","actions"])}ngOnInit(){this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.activeChannels=t.activeChannels,this.activeChannels.length>0&&this.sort&&this.paginator&&this.loadChannelsTable(),this.logger.info(t)}),this.store.select(x.yD).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.information=t}),this.store.select(x.Bo).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.numPeers=t.peers&&t.peers.length?t.peers.length:0}),this.store.select(x.kY).pipe((0,p.R)(this.unSubs[3])).subscribe(t=>{this.totalBalance=t.onchainBalance.total})}ngAfterViewInit(){this.activeChannels.length>0&&this.sort&&this.paginator&&this.loadChannelsTable()}onChannelUpdate(t){"all"!==t&&"NORMAL"!==t.state||(this.store.dispatch((0,It.c1)({payload:{data:{type:f.n_.CONFIRM,alertTitle:"Update Fee Policy",noBtnText:"Cancel",yesBtnText:"Update",message:[],titleMessage:"all"===t?"Update fee policy for selected/all channels":"Update fee policy for Channel: "+t.channelId,flgShowInput:!0,getInputs:[{placeholder:"Base Fee (mSats)",inputType:"number",inputValue:t&&t.feeBaseMsat?t.feeBaseMsat:1e3,width:48},{placeholder:"Fee Rate (mili mSats)",inputType:"number",inputValue:t&&t.feeProportionalMillionths?t.feeProportionalMillionths:100,min:1,width:48,hintFunction:this.percentHintFunction}]}}})),this.rtlEffects.closeConfirm.pipe((0,p.R)(this.unSubs[4])).subscribe(e=>{if(e){const n=e[0].inputValue,a=e[1].inputValue;let i=null,o="";"all"===t?(this.activeChannels.forEach(t=>{o=o+","+t.channelId}),o=o.substring(1),i={baseFeeMsat:n,feeRate:a,channelIds:o}):i={baseFeeMsat:n,feeRate:a,channelId:t.channelId},this.store.dispatch((0,ft.pW)({payload:i}))}}),this.applyFilter())}percentHintFunction(t){return(t/1e4).toString()+"%"}onChannelClose(t,e){this.store.dispatch((0,It.c1)({payload:{data:{type:f.n_.CONFIRM,alertTitle:e?"Force Close Channel":"Close Channel",titleMessage:e?"Force closing channel: "+t.channelId:"Closing channel: "+t.channelId,noBtnText:"Cancel",yesBtnText:e?"Force Close":"Close Channel"}}})),this.rtlEffects.closeConfirm.pipe((0,p.R)(this.unSubs[5])).subscribe(n=>{n&&this.store.dispatch((0,ft.BL)({payload:{channelId:t.channelId,force:e}}))})}applyFilter(){""!==this.selFilter&&(this.channels.filter=this.selFilter.trim().toLowerCase())}onChannelClick(t,e){this.store.dispatch((0,It.qR)({payload:{data:{channel:t,channelsType:"open",component:Hi}}}))}loadChannelsTable(){this.activeChannels.sort((t,e)=>t.alias===e.alias?0:e.alias?1:-1),this.channels=new ht.by([...this.activeChannels]),this.channels.sort=this.sort,this.channels.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null,this.channels.filterPredicate=(t,e)=>JSON.stringify(t).toLowerCase().includes(e),this.channels.paginator=this.paginator,this.applyFilter(),this.logger.info(this.channels)}onDownloadCSV(){this.channels.data&&this.channels.data.length>0&&this.commonService.downloadFile(this.channels.data,"ActiveChannels")}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(_e.V),s.Y36(A.v))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channel-open-table"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Channels")}])],decls:39,vars:14,consts:[["fxLayout","column",1,"padding-gap"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign.gt-xs","start center","fxLayoutAlign","start stretch",1,"page-sub-title-container"],["fxFlex","70"],["fxFlex","30"],["matInput","","name","filter","placeholder","Filter",3,"ngModel","keyup","ngModelChange"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","shortChannelId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","alias"],["matColumnDef","feeBaseMsat"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",4,"matHeaderCellDef"],["matColumnDef","feeProportionalMillionths"],["matColumnDef","toLocal"],["matColumnDef","toRemote"],["matColumnDef","balancedness"],["mat-header-cell","","mat-sort-header","","class","pl-3",4,"matHeaderCellDef"],["mat-cell","","class","pl-3",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","pl-1",4,"matHeaderCellDef"],["mat-cell","","fxLayoutAlign","end center","class","pl-1",4,"matCellDef"],["matColumnDef","no_peer"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"ellipsis-parent",3,"ngStyle"],["class","mr-1","matTooltip","Private","matTooltipPosition","right",4,"ngIf"],["class","mr-1","matTooltip","Public","matTooltipPosition","right",4,"ngIf"],[1,"ellipsis-child"],["matTooltip","Private","matTooltipPosition","right",1,"mr-1"],[3,"icon"],["matTooltip","Public","matTooltipPosition","right",1,"mr-1"],["mat-header-cell","","mat-sort-header","","arrowPosition","before"],["fxLayoutAlign","end center"],["mat-header-cell","","mat-sort-header","",1,"pl-3"],["mat-cell","",1,"pl-3"],["fxLayout","row"],["fxFlex","100","fxLayoutAlign","center center",1,"font-size-80"],["mode","determinate",3,"value"],["mat-header-cell","",1,"pl-1"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",1,"pl-1"],["fxLayoutAlign","center center",1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","2",1,"mr-0"],["mat-footer-cell","","colspan","4"],[4,"ngIf"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"div",2),s.TgZ(3,"mat-form-field",3),s.TgZ(4,"input",4),s.NdJ("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.selFilter=t}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(5,"div",5),s.YNc(6,zi,1,0,"mat-progress-bar",6),s.TgZ(7,"table",7,8),s.ynx(9,9),s.YNc(10,Vi,2,0,"th",10),s.YNc(11,Wi,6,6,"td",11),s.BQk(),s.ynx(12,12),s.YNc(13,Ki,2,0,"th",10),s.YNc(14,ji,4,4,"td",11),s.BQk(),s.ynx(15,13),s.YNc(16,to,2,0,"th",14),s.YNc(17,eo,4,4,"td",11),s.BQk(),s.ynx(18,15),s.YNc(19,no,2,0,"th",14),s.YNc(20,ao,4,4,"td",11),s.BQk(),s.ynx(21,16),s.YNc(22,io,2,0,"th",14),s.YNc(23,oo,4,4,"td",11),s.BQk(),s.ynx(24,17),s.YNc(25,so,2,0,"th",14),s.YNc(26,lo,4,4,"td",11),s.BQk(),s.ynx(27,18),s.YNc(28,ro,2,0,"th",19),s.YNc(29,co,6,4,"td",20),s.BQk(),s.ynx(30,21),s.YNc(31,uo,8,0,"th",22),s.YNc(32,po,12,0,"td",23),s.BQk(),s.ynx(33,24),s.YNc(34,xo,5,4,"td",25),s.BQk(),s.YNc(35,yo,1,3,"tr",26),s.YNc(36,Ao,1,0,"tr",27),s.YNc(37,Co,1,0,"tr",28),s.qZA(),s.qZA(),s._UZ(38,"mat-paginator",29),s.qZA()),2&t&&(s.xp6(4),s.Q6J("ngModel",e.selFilter),s.xp6(2),s.Q6J("ngIf",e.apiCallStatus.status===e.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",e.channels)("ngClass",s.VKq(11,To,""!==e.errorMessage)),s.xp6(28),s.Q6J("matFooterRowDef",s.DdM(13,So)),s.xp6(1),s.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",e.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",e.displayedColumns),s.xp6(1),s.Q6J("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("showFirstLastButtons",e.screenSize!==e.screenSizeEnum.XS))},directives:[l.xw,l.Wh,l.yH,k.KE,yt.Nt,Zt.Fj,Zt.JJ,Zt.On,M.$V,a.O5,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,a.PC,v.Zl,R.gM,C.BN,k.bx,Tt.gD,Tt.$L,St.ey,ht.yh,ht.Q2,ht.XQ,ht.Gk],pipes:[a.JJ],styles:[".mat-column-shortChannelId[_ngcontent-%COMP%]{flex:0 0 15%;width:15%}.mat-column-shortChannelId[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%]{display:flex}.mat-column-alias[_ngcontent-%COMP%]{padding-left:1rem;flex:0 0 15%;width:15%}.mat-column-alias[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%]{display:flex}.mat-column-balancedness[_ngcontent-%COMP%]{padding-left:2rem;flex:0 0 17%;width:17%}.mat-column-feeBaseMsat[_ngcontent-%COMP%], .mat-column-feeProportionalMillionths[_ngcontent-%COMP%], .mat-column-state[_ngcontent-%COMP%], .mat-column-toLocal[_ngcontent-%COMP%], .mat-column-toRemote[_ngcontent-%COMP%]{flex:1 1 10%;width:10%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media only screen and (max-width:56.25em){.mat-column-feeBaseMsat[_ngcontent-%COMP%], .mat-column-feeProportionalMillionths[_ngcontent-%COMP%], .mat-column-state[_ngcontent-%COMP%], .mat-column-toLocal[_ngcontent-%COMP%], .mat-column-toRemote[_ngcontent-%COMP%]{white-space:unset;flex:1 1 20%;width:20%}}@media only screen and (max-width:37.5em){.mat-column-feeBaseMsat[_ngcontent-%COMP%], .mat-column-feeProportionalMillionths[_ngcontent-%COMP%], .mat-column-state[_ngcontent-%COMP%], .mat-column-toLocal[_ngcontent-%COMP%], .mat-column-toRemote[_ngcontent-%COMP%]{white-space:unset}}.mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}.mat-column-actions[_ngcontent-%COMP%]   .bordered-box.table-actions-select[_ngcontent-%COMP%]{flex:0 0 100%}@media only screen and (max-width:56.25em){.mat-column-actions[_ngcontent-%COMP%]   .bordered-box.table-actions-select[_ngcontent-%COMP%]{flex:0 0 90%}}@media only screen and (max-width:37.5em){.mat-column-actions[_ngcontent-%COMP%]   .bordered-box.table-actions-select[_ngcontent-%COMP%]{flex:0 0 80%}}"]}),t})();function vo(t,e){1&t&&s._UZ(0,"mat-progress-bar",25)}function bo(t,e){1&t&&(s.TgZ(0,"th",26),s._uU(1," State "),s.qZA())}function qo(t,e){if(1&t&&(s.TgZ(0,"td",27),s._uU(1),s.ALo(2,"titlecase"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,null==t?null:t.state),"")}}function Lo(t,e){1&t&&(s.TgZ(0,"th",26),s._uU(1," Alias "),s.qZA())}function _o(t,e){if(1&t&&(s.TgZ(0,"td",27),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(null==t?null:t.alias)}}function Io(t,e){1&t&&(s.TgZ(0,"th",28),s._uU(1," Local Balance (Sats) "),s.qZA())}function No(t,e){if(1&t&&(s.TgZ(0,"td",27),s.TgZ(1,"span",29),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.toLocal,"1.0-0")," ")}}function Do(t,e){1&t&&(s.TgZ(0,"th",28),s._uU(1," Remote Balance (Sats) "),s.qZA())}function Fo(t,e){if(1&t&&(s.TgZ(0,"td",27),s.TgZ(1,"span",29),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.toRemote,"1.0-0")," ")}}function Uo(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",30),s.TgZ(1,"div",31),s.TgZ(2,"mat-select",32),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",33),s.NdJ("click",function(){return s.CHM(t),s.oxw().onDownloadCSV()}),s._uU(5,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function Oo(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",34),s.TgZ(1,"button",35),s.NdJ("click",function(e){const n=s.CHM(t).$implicit;return s.oxw().onChannelClick(n,e)}),s._uU(2,"View Info"),s.qZA(),s.qZA()}}function ko(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No pending channel available."),s.qZA())}function Ro(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting pending channels..."),s.qZA())}function Eo(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.errorMessage)}}function Mo(t,e){if(1&t&&(s.TgZ(0,"td",36),s.YNc(1,ko,2,0,"p",37),s.YNc(2,Ro,2,0,"p",37),s.YNc(3,Eo,2,1,"p",37),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const Jo=function(t){return{"display-none":t}};function Po(t,e){if(1&t&&s._UZ(0,"tr",38),2&t){const t=s.oxw();s.Q6J("ngClass",s.VKq(1,Jo,(null==t.channels?null:t.channels.data)&&(null==t.channels||null==t.channels.data?null:t.channels.data.length)>0))}}function Yo(t,e){1&t&&s._UZ(0,"tr",39)}function Qo(t,e){1&t&&s._UZ(0,"tr",40)}const Bo=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}},Ho=function(){return["no_channel"]};let zo=(()=>{class t{constructor(t,e,n){this.logger=t,this.store=e,this.commonService=n,this.totalBalance=0,this.displayedColumns=[],this.myChanPolicy={},this.information={},this.numPeers=-1,this.feeRateTypes=f.vn,this.selFilter="",this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["state","alias","actions"]):this.screenSize===f.cu.SM||this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["state","alias","toLocal","toRemote","actions"]):(this.flgSticky=!0,this.displayedColumns=["state","alias","toLocal","toRemote","actions"])}ngOnInit(){this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.pendingChannels=t.pendingChannels,this.loadChannelsTable(),this.logger.info(t)}),this.store.select(x.yD).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.information=t}),this.store.select(x.Bo).pipe((0,p.R)(this.unSubs[4])).subscribe(t=>{this.numPeers=t.peers&&t.peers.length?t.peers.length:0}),this.store.select(x.kY).pipe((0,p.R)(this.unSubs[5])).subscribe(t=>{this.totalBalance=t.onchainBalance.total})}ngAfterViewInit(){this.pendingChannels.length>0&&this.loadChannelsTable()}applyFilter(){this.channels.filter=this.selFilter.trim().toLowerCase()}onChannelClick(t,e){this.store.dispatch((0,It.qR)({payload:{data:{channel:t,channelsType:"pending",component:Hi}}}))}loadChannelsTable(){this.pendingChannels.sort((t,e)=>t.alias===e.alias?0:e.alias?1:-1),this.channels=new ht.by([...this.pendingChannels]),this.channels.sort=this.sort,this.channels.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null,this.channels.filterPredicate=(t,e)=>JSON.stringify(t).toLowerCase().includes(e),this.channels.paginator=this.paginator,this.applyFilter(),this.logger.info(this.channels)}onDownloadCSV(){this.channels.data&&this.channels.data.length>0&&this.commonService.downloadFile(this.channels.data,"PendingChannels")}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(A.v))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channel-pending-table"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Channels")}])],decls:30,vars:14,consts:[["fxLayout","column",1,"padding-gap"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign.gt-xs","start center","fxLayoutAlign","start stretch",1,"page-sub-title-container"],["fxFlex","70"],["fxFlex","30"],["matInput","","name","filter","placeholder","Filter",3,"ngModel","keyup","ngModelChange"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","state"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","alias"],["matColumnDef","toLocal"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",4,"matHeaderCellDef"],["matColumnDef","toRemote"],["matColumnDef","actions"],["mat-header-cell","","class","pl-1",4,"matHeaderCellDef"],["mat-cell","","class","pl-1","fxLayoutAlign","end center",4,"matCellDef"],["matColumnDef","no_channel"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","","mat-sort-header","","arrowPosition","before"],["fxLayoutAlign","end center"],["mat-header-cell","",1,"pl-1"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",1,"pl-1"],["mat-stroked-button","","color","primary","type","button","tabindex","4",3,"click"],["mat-footer-cell","","colspan","4"],[4,"ngIf"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"div",2),s.TgZ(3,"mat-form-field",3),s.TgZ(4,"input",4),s.NdJ("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.selFilter=t}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(5,"div",5),s.YNc(6,vo,1,0,"mat-progress-bar",6),s.TgZ(7,"table",7,8),s.ynx(9,9),s.YNc(10,bo,2,0,"th",10),s.YNc(11,qo,3,3,"td",11),s.BQk(),s.ynx(12,12),s.YNc(13,Lo,2,0,"th",10),s.YNc(14,_o,2,1,"td",11),s.BQk(),s.ynx(15,13),s.YNc(16,Io,2,0,"th",14),s.YNc(17,No,4,4,"td",11),s.BQk(),s.ynx(18,15),s.YNc(19,Do,2,0,"th",14),s.YNc(20,Fo,4,4,"td",11),s.BQk(),s.ynx(21,16),s.YNc(22,Uo,6,0,"th",17),s.YNc(23,Oo,3,0,"td",18),s.BQk(),s.ynx(24,19),s.YNc(25,Mo,4,3,"td",20),s.BQk(),s.YNc(26,Po,1,3,"tr",21),s.YNc(27,Yo,1,0,"tr",22),s.YNc(28,Qo,1,0,"tr",23),s.qZA(),s.qZA(),s._UZ(29,"mat-paginator",24),s.qZA()),2&t&&(s.xp6(4),s.Q6J("ngModel",e.selFilter),s.xp6(2),s.Q6J("ngIf",e.apiCallStatus.status===e.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",e.channels)("ngClass",s.VKq(11,Bo,""!==e.errorMessage)),s.xp6(19),s.Q6J("matFooterRowDef",s.DdM(13,Ho)),s.xp6(1),s.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",e.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",e.displayedColumns),s.xp6(1),s.Q6J("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("showFirstLastButtons",e.screenSize!==e.screenSizeEnum.XS))},directives:[l.xw,l.Wh,l.yH,k.KE,yt.Nt,Zt.Fj,Zt.JJ,Zt.On,M.$V,a.O5,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,Tt.gD,Tt.$L,St.ey,b.lW,ht.yh,ht.Q2,ht.XQ,ht.Gk],pipes:[a.rS,a.JJ],styles:[".mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}"]}),t})();var Vo=n(7753);const Go=["peersForm"],Xo=["stepper"];function $o(t,e){if(1&t&&s._uU(0),2&t){const t=s.oxw();s.Oqu(t.peerFormLabel)}}function Wo(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Address is required."),s.qZA())}function Ko(t,e){if(1&t&&(s.TgZ(0,"div",33),s._UZ(1,"fa-icon",34),s.TgZ(2,"span"),s._uU(3),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("icon",t.faExclamationTriangle),s.xp6(2),s.Oqu(t.peerConnectionError)}}function jo(t,e){if(1&t&&s._uU(0),2&t){const t=s.oxw();s.Oqu(t.channelFormLabel)}}function ts(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Amount is required."),s.qZA())}function es(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Amount must be a positive number."),s.qZA())}function ns(t,e){if(1&t&&(s.TgZ(0,"mat-error"),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.hij("Amount must be less than or equal to ",t.totalBalance,".")}}function as(t,e){if(1&t&&(s.TgZ(0,"div",33),s._UZ(1,"fa-icon",34),s.TgZ(2,"span"),s._uU(3),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("icon",t.faExclamationTriangle),s.xp6(2),s.Oqu(t.channelConnectionError)}}let is=(()=>{class t{constructor(t,e,n,a,i,o){this.dialogRef=t,this.data=e,this.store=n,this.formBuilder=a,this.actions=i,this.logger=o,this.faExclamationTriangle=g.eHv,this.peerAddress="",this.totalBalance=0,this.flgChannelOpened=!1,this.channelOpenStatus=null,this.newlyAddedPeer=null,this.flgEditable=!0,this.peerConnectionError="",this.channelConnectionError="",this.peerFormLabel="Peer Details",this.channelFormLabel="Open Channel (Optional)",this.unSubs=[new d.x,new d.x]}ngOnInit(){this.totalBalance=this.data.message.balance,this.peerAddress=this.data.message.peer&&this.data.message.peer.nodeId&&this.data.message.peer.address?this.data.message.peer.nodeId+"@"+this.data.message.peer.address:this.data.message.peer&&this.data.message.peer.nodeId&&!this.data.message.peer.address?this.data.message.peer.nodeId:"",this.peerFormGroup=this.formBuilder.group({hiddenAddress:["",[Zt.kI.required]],peerAddress:[this.peerAddress,[Zt.kI.required]]}),this.channelFormGroup=this.formBuilder.group({fundingAmount:["",[Zt.kI.required,Zt.kI.min(1),Zt.kI.max(this.totalBalance)]],isPrivate:[!1],feeRate:[null],hiddenAmount:["",[Zt.kI.required]]}),this.statusFormGroup=this.formBuilder.group({}),this.actions.pipe((0,p.R)(this.unSubs[1]),(0,dt.h)(t=>t.type===f.lr.NEWLY_ADDED_PEER_ECL||t.type===f.lr.FETCH_CHANNELS_ECL||t.type===f.lr.UPDATE_API_CALL_STATUS_ECL)).subscribe(t=>{t.type===f.lr.NEWLY_ADDED_PEER_ECL&&(this.logger.info(t.payload),this.flgEditable=!1,this.newlyAddedPeer=t.payload.peer,this.peerFormGroup.controls.hiddenAddress.setValue(this.peerFormGroup.controls.peerAddress.value),this.stepper.next()),t.type===f.lr.FETCH_CHANNELS_ECL&&this.dialogRef.close(),t.type===f.lr.UPDATE_API_CALL_STATUS_ECL&&t.payload.status===f.Bn.ERROR&&("SaveNewPeer"===t.payload.action?this.peerConnectionError=t.payload.message:"SaveNewChannel"===t.payload.action&&(this.channelConnectionError=t.payload.message))})}onConnectPeer(){if(!this.peerFormGroup.controls.peerAddress.value)return!0;this.peerConnectionError="",this.store.dispatch((0,ft.El)({payload:{id:this.peerFormGroup.controls.peerAddress.value}}))}onOpenChannel(){if(!this.channelFormGroup.controls.fundingAmount.value||this.totalBalance-this.channelFormGroup.controls.fundingAmount.value<0)return!0;this.channelConnectionError="",this.store.dispatch((0,ft.YX)({payload:{nodeId:this.newlyAddedPeer.nodeId,amount:this.channelFormGroup.controls.fundingAmount.value,private:this.channelFormGroup.controls.isPrivate.value,feeRate:this.channelFormGroup.controls.feeRate.value}}))}onClose(){this.dialogRef.close(!1)}stepSelectionChanged(t){switch(t.selectedIndex){case 0:this.peerFormLabel="Peer Details",this.channelFormLabel="Open Channel (Optional)";break;case 1:this.peerFormLabel=this.peerFormGroup.controls.peerAddress.value?"Peer Added: "+(this.newlyAddedPeer.alias?this.newlyAddedPeer.alias:this.newlyAddedPeer.nodeId):"Peer Details",this.channelFormLabel="Open Channel (Optional)";break;case 2:this.peerFormLabel=this.peerFormGroup.controls.peerAddress.value?"Peer Added: "+(this.newlyAddedPeer.alias?this.newlyAddedPeer.alias:this.newlyAddedPeer.nodeId):"Peer Details",this.channelFormLabel=this.channelFormGroup.controls.fundingAmount.value?"Opening Channel for "+this.channelFormGroup.controls.fundingAmount.value+" Sats":"Open Channel (Optional)";break;default:this.peerFormLabel="Peer Details",this.channelFormLabel="Open Channel (Optional)"}t.selectedIndex<t.previouslySelectedIndex&&(0===t.selectedIndex?this.peerFormGroup.controls.hiddenAddress.setValue(""):1===t.selectedIndex&&this.channelFormGroup.controls.hiddenAmount.setValue(""))}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(gt.so),s.Y36(gt.WI),s.Y36(y.yh),s.Y36(Zt.qu),s.Y36(xt.eX),s.Y36(Z.mQ))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-connect-peer"]],viewQuery:function(t,e){if(1&t&&(s.Gf(Go,5),s.Gf(Xo,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.form=t.first),s.iGM(t=s.CRH())&&(e.stepper=t.first)}},decls:50,vars:20,consts:[["fxLayout","row"],["fxFlex","100"],["fxLayout","row","fxLayoutAlign","space-between center",1,"modal-info-header"],["fxFlex","95","fxLayoutAlign","start start"],[1,"page-title"],["tabindex","8","fxFlex","5","fxLayoutAlign","center","mat-button","",1,"btn-close-x","p-0",3,"click"],[1,"padding-gap-x-large"],["fxLayout","column"],[3,"linear","selectionChange"],["stepper",""],[3,"stepControl","editable"],["fxLayout","column","fxLayout.gt-sm","row wrap","fxLayoutAlign","start","fxLayoutAlign.gt-sm","space-between",1,"my-1",3,"formGroup"],["matStepLabel",""],["autoFocus","","matInput","","placeholder","Lightning Address (pubkey OR pubkey@ip:port)","formControlName","peerAddress","tabindex","1","required",""],[4,"ngIf"],["fxFlex","100","class","alert alert-danger mt-1",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start center","fxFlex","100",1,"mt-2"],["mat-stroked-button","","color","primary","tabindex","3","type","button",3,"click"],["fxLayout","column","fxLayout.gt-sm","row wrap","fxLayoutAlign","start","fxLayoutAlign.gt-sm","space-between",1,"mb-1",3,"formGroup"],["matStepLabel","","disabled","true"],["fxLayout","column","fxLayout.gt-sm","row wrap","fxFlex","100","fxLayoutAlign","space-between stretch"],["fxLayout","row","fxFlex","100","fxLayoutAlign","space-between center"],["fxFlex","60","fxLayoutAlign","start end"],["matInput","","autoFocus","","formControlName","fundingAmount","placeholder","Amount","type","number","tabindex","1","required","",3,"step"],["matSuffix",""],["fxFlex","35","fxLayoutAlign","start center"],["tabindex","2","color","primary","formControlName","isPrivate","name","isPrivate"],["fxLayout","row","fxFlex","100","fxLayoutAlign","space-between center",1,"mt-1"],["fxFlex","48","fxLayout","row","fxLayoutAlign","start center"],["matInput","","formControlName","feeRate","placeholder","Fee (Sats/vByte)","type","number","name","feeRate","tabindex","7",3,"step","min"],["mat-stroked-button","","color","primary","tabindex","8","type","button",3,"click"],["fxLayout","row","fxFlex","100","fxLayoutAlign","end center"],["mat-stroked-button","","color","primary","tabindex","12","type","button","default","",3,"click"],["fxFlex","100",1,"alert","alert-danger","mt-1"],[1,"mr-1","alert-icon",3,"icon"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s.TgZ(2,"mat-card-header",2),s.TgZ(3,"div",3),s.TgZ(4,"span",4),s._uU(5,"Connect to a new peer"),s.qZA(),s.qZA(),s.TgZ(6,"button",5),s.NdJ("click",function(){return e.onClose()}),s._uU(7,"X"),s.qZA(),s.qZA(),s.TgZ(8,"mat-card-content",6),s.TgZ(9,"div",7),s.TgZ(10,"mat-vertical-stepper",8,9),s.NdJ("selectionChange",function(t){return e.stepSelectionChanged(t)}),s.TgZ(12,"mat-step",10),s.TgZ(13,"form",11),s.YNc(14,$o,1,1,"ng-template",12),s.TgZ(15,"mat-form-field",1),s._UZ(16,"input",13),s.YNc(17,Wo,2,0,"mat-error",14),s.qZA(),s.YNc(18,Ko,4,2,"div",15),s.TgZ(19,"div",16),s.TgZ(20,"button",17),s.NdJ("click",function(){return e.onConnectPeer()}),s._uU(21),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(22,"mat-step",10),s.TgZ(23,"form",18),s.YNc(24,jo,1,1,"ng-template",19),s.TgZ(25,"div",20),s.TgZ(26,"div",21),s.TgZ(27,"mat-form-field",22),s._UZ(28,"input",23),s.TgZ(29,"mat-hint"),s._uU(30),s.qZA(),s.TgZ(31,"span",24),s._uU(32," Sats "),s.qZA(),s.YNc(33,ts,2,0,"mat-error",14),s.YNc(34,es,2,0,"mat-error",14),s.YNc(35,ns,2,1,"mat-error",14),s.qZA(),s.TgZ(36,"div",25),s.TgZ(37,"mat-slide-toggle",26),s._uU(38,"Private Channel"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(39,"div",27),s.TgZ(40,"div",28),s.TgZ(41,"mat-form-field",1),s._UZ(42,"input",29),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.YNc(43,as,4,2,"div",15),s.TgZ(44,"div",16),s.TgZ(45,"button",30),s.NdJ("click",function(){return e.onOpenChannel()}),s._uU(46),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(47,"div",31),s.TgZ(48,"button",32),s.NdJ("click",function(){return e.onClose()}),s._uU(49),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(10),s.Q6J("linear",!0),s.xp6(2),s.Q6J("stepControl",e.peerFormGroup)("editable",e.flgEditable),s.xp6(1),s.Q6J("formGroup",e.peerFormGroup),s.xp6(4),s.Q6J("ngIf",null==e.peerFormGroup.controls.peerAddress.errors?null:e.peerFormGroup.controls.peerAddress.errors.required),s.xp6(1),s.Q6J("ngIf",""!==e.peerConnectionError),s.xp6(3),s.Oqu(""!==e.peerConnectionError?"Retry":"Add Peer"),s.xp6(1),s.Q6J("stepControl",e.channelFormGroup)("editable",e.flgEditable),s.xp6(1),s.Q6J("formGroup",e.channelFormGroup),s.xp6(5),s.Q6J("step",1e3),s.xp6(2),s.hij("Remaining Bal: ",e.totalBalance-(e.channelFormGroup.controls.fundingAmount.value?e.channelFormGroup.controls.fundingAmount.value:0),""),s.xp6(3),s.Q6J("ngIf",null==e.channelFormGroup.controls.fundingAmount.errors?null:e.channelFormGroup.controls.fundingAmount.errors.required),s.xp6(1),s.Q6J("ngIf",null==e.channelFormGroup.controls.fundingAmount.errors?null:e.channelFormGroup.controls.fundingAmount.errors.min),s.xp6(1),s.Q6J("ngIf",null==e.channelFormGroup.controls.fundingAmount.errors?null:e.channelFormGroup.controls.fundingAmount.errors.max),s.xp6(7),s.Q6J("step",1)("min",0),s.xp6(1),s.Q6J("ngIf",""!==e.channelConnectionError),s.xp6(3),s.Oqu(""!==e.channelConnectionError?"Retry":"Open Channel"),s.xp6(3),s.Oqu(null!=e.newlyAddedPeer&&e.newlyAddedPeer.nodeId?"Do It Later":"Close"))},directives:[l.xw,l.yH,S.dk,l.Wh,b.lW,S.dn,Vo.Vq,Vo.C0,Zt._Y,Zt.JL,Zt.sg,Vo.VY,k.KE,yt.Nt,Zt.Fj,At.h,Zt.JJ,Zt.u,Zt.Q7,a.O5,Zt.wV,k.bx,k.R9,fi.Rr,Zt.qQ,Ct.q,k.TO,C.BN],styles:[""]}),t})();function os(t,e){1&t&&s._UZ(0,"mat-progress-bar",35)}function ss(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1," ID "),s.qZA())}const ls=function(t){return{"max-width":t}};function rs(t,e){if(1&t&&(s.TgZ(0,"td",37),s._uU(1),s.qZA()),2&t){const t=e.$implicit,n=s.oxw();s.Q6J("ngStyle",s.VKq(2,ls,n.screenSize===n.screenSizeEnum.XS?"10rem":"30rem")),s.xp6(1),s.hij(" ",null==t?null:t.nodeId," ")}}function cs(t,e){1&t&&(s.TgZ(0,"th",38),s._uU(1," Alias "),s.qZA())}const us=function(t){return{"mr-0":t}};function ds(t,e){if(1&t&&s._UZ(0,"span",42),2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,us,t.screenSize===t.screenSizeEnum.XS))}}function ps(t,e){if(1&t&&s._UZ(0,"span",43),2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,us,t.screenSize===t.screenSizeEnum.XS))}}function ms(t,e){if(1&t&&(s.TgZ(0,"td",39),s.YNc(1,ds,1,3,"span",40),s.YNc(2,ps,1,3,"span",41),s._uU(3),s.qZA()),2&t){const t=e.$implicit,n=s.oxw();s.Q6J("ngStyle",s.VKq(4,ls,n.screenSize===n.screenSizeEnum.XS?"10rem":"25rem")),s.xp6(1),s.Q6J("ngIf","CONNECTED"===t.state),s.xp6(1),s.Q6J("ngIf","DISCONNECTED"===t.state),s.xp6(1),s.hij(" ",null==t?null:t.alias," ")}}function hs(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1," State "),s.qZA())}function gs(t,e){if(1&t&&(s.TgZ(0,"td",44),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",null==t?null:t.state," ")}}function fs(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1," Network Address "),s.qZA())}function xs(t,e){if(1&t&&(s.TgZ(0,"td",44),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",null==t?null:t.address," ")}}function Zs(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1," Channels "),s.qZA())}function ys(t,e){if(1&t&&(s.TgZ(0,"td",44),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",null==t?null:t.channels," ")}}function As(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",45),s.TgZ(1,"div",46),s.TgZ(2,"mat-select",47),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",48),s.NdJ("click",function(){return s.CHM(t),s.oxw().onDownloadCSV()}),s._uU(5,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function Cs(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"mat-option",48),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw().onPeerDetach(e)}),s._uU(1,"Disconnect"),s.qZA()}}function Ts(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"mat-option",48),s.NdJ("click",function(){s.CHM(t);const e=s.oxw().$implicit;return s.oxw().onConnectPeer(e)}),s._uU(1,"Reconnect"),s.qZA()}}function Ss(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",49),s.TgZ(1,"div",46),s.TgZ(2,"mat-select",47),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",48),s.NdJ("click",function(e){const n=s.CHM(t).$implicit;return s.oxw().onPeerClick(n,e)}),s._uU(5,"View Info"),s.qZA(),s.TgZ(6,"mat-option",48),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().onOpenChannel(e)}),s._uU(7,"Open Channel"),s.qZA(),s.YNc(8,Cs,2,0,"mat-option",50),s.YNc(9,Ts,2,0,"mat-option",50),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=e.$implicit;s.xp6(8),s.Q6J("ngIf","CONNECTED"===t.state),s.xp6(1),s.Q6J("ngIf","DISCONNECTED"===t.state)}}function ws(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No connected peer."),s.qZA())}function vs(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting peers..."),s.qZA())}function bs(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.errorMessage)}}function qs(t,e){if(1&t&&(s.TgZ(0,"td",51),s.YNc(1,ws,2,0,"p",52),s.YNc(2,vs,2,0,"p",52),s.YNc(3,bs,2,1,"p",52),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",(!(null!=t.peers&&t.peers.data)||(null==t.peers||null==t.peers.data?null:t.peers.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.peers&&t.peers.data)||(null==t.peers||null==t.peers.data?null:t.peers.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.peers&&t.peers.data)||(null==t.peers||null==t.peers.data?null:t.peers.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const Ls=function(t){return{"display-none":t}};function _s(t,e){if(1&t&&s._UZ(0,"tr",53),2&t){const t=s.oxw();s.Q6J("ngClass",s.VKq(1,Ls,(null==t.peers?null:t.peers.data)&&(null==t.peers||null==t.peers.data?null:t.peers.data.length)>0))}}function Is(t,e){1&t&&s._UZ(0,"tr",54)}function Ns(t,e){1&t&&s._UZ(0,"tr",55)}const Ds=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}},Fs=function(){return["no_peer"]};let Us=(()=>{class t{constructor(t,e,n,a,i){this.logger=t,this.store=e,this.rtlEffects=n,this.actions=a,this.commonService=i,this.faUsers=g.FVb,this.newlyAddedPeer="",this.displayedColumns=[],this.peerAddress="",this.peersData=[],this.information={},this.availableBalance=0,this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.selFilter="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["alias","actions"]):this.screenSize===f.cu.SM?(this.flgSticky=!1,this.displayedColumns=["alias","nodeId","address","actions"]):this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["alias","nodeId","address","channels","actions"]):(this.flgSticky=!0,this.displayedColumns=["alias","nodeId","address","channels","actions"])}ngOnInit(){this.store.select(x.yD).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.information=t}),this.store.select(x.Bo).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.peersData=t.peers,this.loadPeersTable(this.peersData),this.logger.info(t)}),this.store.select(x.kY).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.availableBalance=t.onchainBalance.total||0}),this.actions.pipe((0,p.R)(this.unSubs[3]),(0,dt.h)(t=>t.type===f.lr.SET_PEERS_ECL)).subscribe(t=>{this.peerAddress=null})}ngAfterViewInit(){this.peersData.length>0&&this.loadPeersTable(this.peersData)}onPeerClick(t,e){const n=[[{key:"nodeId",value:t.nodeId,title:"Public Key",width:100}],[{key:"address",value:t.address,title:"Address",width:50},{key:"alias",value:t.alias,title:"Alias",width:50}],[{key:"state",value:this.commonService.titleCase(t.state),title:"State",width:50},{key:"channels",value:t.channels,title:"Channels",width:50}]];this.store.dispatch((0,It.qR)({payload:{data:{type:f.n_.INFORMATION,alertTitle:"Peer Information",showQRName:"Public Key",showQRField:t.nodeId,message:n}}}))}onConnectPeer(t){this.store.dispatch((0,It.qR)({payload:{data:{message:{peer:t.nodeId?t:null,information:this.information,balance:this.availableBalance},component:is}}}))}onOpenChannel(t){this.store.dispatch((0,It.qR)({payload:{data:{alertTitle:"Open Channel",message:{peer:t,information:this.information,balance:this.availableBalance},newlyAdded:!1,component:Ii}}}))}onPeerDetach(t){this.store.dispatch(t.channels>0?(0,It.qR)({payload:{data:{type:f.n_.ERROR,alertTitle:"Disconnect Not Allowed",titleMessage:"Channel active with this peer."}}}):(0,It.c1)({payload:{data:{type:f.n_.CONFIRM,alertTitle:"Disconnect Peer",titleMessage:"Disconnect peer: "+(t.alias?t.alias:t.nodeId),noBtnText:"Cancel",yesBtnText:"Disconnect"}}})),this.rtlEffects.closeConfirm.pipe((0,p.R)(this.unSubs[4])).subscribe(e=>{e&&this.store.dispatch((0,ft.GD)({payload:{nodeId:t.nodeId}}))})}applyFilter(){""!==this.selFilter&&(this.peers.filter=this.selFilter.trim().toLowerCase())}loadPeersTable(t){this.peers=new ht.by(t?[...t]:[]),this.peers.sort=this.sort,this.peers.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null,this.peers.filterPredicate=(t,e)=>JSON.stringify(t).toLowerCase().includes(e),this.peers.paginator=this.paginator,this.applyFilter()}onDownloadCSV(){this.peers.data&&this.peers.data.length>0&&this.commonService.downloadFile(this.peers.data,"Peers")}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(_e.V),s.Y36(xt.eX),s.Y36(A.v))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-peers"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Peers")}])],decls:42,vars:15,consts:[["fxLayout","column","fxFlex","100","fxLayoutAlign","space-between stretch"],["fxLayout","column","fxLayoutAlign","space-between stretch","fxLayout.gt-sm","row wrap"],["peersForm","ngForm"],["mat-flat-button","","color","primary","type","submit","tabindex","1",3,"click"],["fxLayout","column"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign.gt-xs","start center","fxLayoutAlign","start stretch",1,"page-sub-title-container"],["fxFlex","70"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxFlex","30"],["fxLayout","row","fxLayoutAlign","start start"],["matInput","","placeholder","Filter",3,"ngModel","keyup","ngModelChange"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","nodeId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",3,"ngStyle",4,"matCellDef"],["matColumnDef","alias"],["mat-header-cell","","mat-sort-header","","class","px-3",4,"matHeaderCellDef"],["mat-cell","","class","px-3",3,"ngStyle",4,"matCellDef"],["matColumnDef","state"],["mat-cell","",4,"matCellDef"],["matColumnDef","address"],["matColumnDef","channels"],["matColumnDef","actions"],["mat-header-cell","","class","px-3",4,"matHeaderCellDef"],["mat-cell","","fxLayoutAlign","end center","class","px-3",4,"matCellDef"],["matColumnDef","no_peer"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",3,"ngStyle"],["mat-header-cell","","mat-sort-header","",1,"px-3"],["mat-cell","",1,"px-3",3,"ngStyle"],["class","dot green","matTooltip","Connected","matTooltipPosition","right",3,"ngClass",4,"ngIf"],["class","dot red","matTooltip","Disconnected","matTooltipPosition","right",3,"ngClass",4,"ngIf"],["matTooltip","Connected","matTooltipPosition","right",1,"dot","green",3,"ngClass"],["matTooltip","Disconnected","matTooltipPosition","right",1,"dot","red",3,"ngClass"],["mat-cell",""],["mat-header-cell","",1,"px-3"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",1,"px-3"],[3,"click",4,"ngIf"],["mat-footer-cell","","colspan","4"],[4,"ngIf"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"form",1,2),s.TgZ(3,"button",3),s.NdJ("click",function(){return e.onConnectPeer({})}),s._uU(4,"Add Peer"),s.qZA(),s.qZA(),s.TgZ(5,"div",4),s.TgZ(6,"div",5),s.TgZ(7,"div",6),s._UZ(8,"fa-icon",7),s.TgZ(9,"span",8),s._uU(10,"Peers"),s.qZA(),s.qZA(),s.TgZ(11,"mat-form-field",9),s.TgZ(12,"div",10),s.TgZ(13,"input",11),s.NdJ("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.selFilter=t}),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.TgZ(14,"div",12),s.YNc(15,os,1,0,"mat-progress-bar",13),s.TgZ(16,"table",14,15),s.ynx(18,16),s.YNc(19,ss,2,0,"th",17),s.YNc(20,rs,2,4,"td",18),s.BQk(),s.ynx(21,19),s.YNc(22,cs,2,0,"th",20),s.YNc(23,ms,4,6,"td",21),s.BQk(),s.ynx(24,22),s.YNc(25,hs,2,0,"th",17),s.YNc(26,gs,2,1,"td",23),s.BQk(),s.ynx(27,24),s.YNc(28,fs,2,0,"th",17),s.YNc(29,xs,2,1,"td",23),s.BQk(),s.ynx(30,25),s.YNc(31,Zs,2,0,"th",17),s.YNc(32,ys,2,1,"td",23),s.BQk(),s.ynx(33,26),s.YNc(34,As,6,0,"th",27),s.YNc(35,Ss,10,2,"td",28),s.BQk(),s.ynx(36,29),s.YNc(37,qs,4,3,"td",30),s.BQk(),s.YNc(38,_s,1,3,"tr",31),s.YNc(39,Is,1,0,"tr",32),s.YNc(40,Ns,1,0,"tr",33),s.qZA(),s.qZA(),s._UZ(41,"mat-paginator",34),s.qZA(),s.qZA()),2&t&&(s.xp6(8),s.Q6J("icon",e.faUsers),s.xp6(5),s.Q6J("ngModel",e.selFilter),s.xp6(2),s.Q6J("ngIf",e.apiCallStatus.status===e.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",e.peers)("ngClass",s.VKq(12,Ds,""!==e.errorMessage)),s.xp6(22),s.Q6J("matFooterRowDef",s.DdM(14,Fs)),s.xp6(1),s.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",e.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",e.displayedColumns),s.xp6(1),s.Q6J("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("showFirstLastButtons",e.screenSize!==e.screenSizeEnum.XS))},directives:[l.xw,l.yH,l.Wh,Zt._Y,Zt.JL,Zt.F,b.lW,C.BN,k.KE,yt.Nt,Zt.Fj,Zt.JJ,Zt.On,M.$V,a.O5,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,a.PC,v.Zl,R.gM,Tt.gD,Tt.$L,St.ey,ht.yh,ht.Q2,ht.XQ,ht.Gk],styles:[".mat-column-alias[_ngcontent-%COMP%], .mat-column-nodeId[_ngcontent-%COMP%]{flex:1 1 10%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-column-nodeId[_ngcontent-%COMP%]{padding-right:2rem}.mat-column-address[_ngcontent-%COMP%]{flex:1 1 15%;width:15%}.mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}"]}),t})();const Os=["queryRoutesForm"];function ks(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Destination Node ID is required."),s.qZA())}function Rs(t,e){1&t&&(s.TgZ(0,"mat-error"),s._uU(1,"Amount is required."),s.qZA())}function Es(t,e){1&t&&s._UZ(0,"mat-progress-bar",31)}function Ms(t,e){1&t&&(s.TgZ(0,"th",32),s._uU(1," Alias "),s.qZA())}function Js(t,e){if(1&t&&(s.TgZ(0,"td",33),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",null==t?null:t.alias," ")}}function Ps(t,e){1&t&&(s.TgZ(0,"th",32),s._uU(1," ID "),s.qZA())}function Ys(t,e){if(1&t&&(s.TgZ(0,"td",33),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.hij(" ",null==t?null:t.nodeId," ")}}function Qs(t,e){1&t&&(s.TgZ(0,"th",34),s.TgZ(1,"span",35),s._uU(2,"Actions"),s.qZA(),s.qZA())}function Bs(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",36),s.TgZ(1,"button",37),s.NdJ("click",function(e){const n=s.CHM(t).$implicit;return s.oxw().onHopClick(n,e)}),s._uU(2,"View Info"),s.qZA(),s.qZA()}}function Hs(t,e){1&t&&s._UZ(0,"tr",38)}function zs(t,e){1&t&&s._UZ(0,"tr",39)}const Vs=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}};let Gs=(()=>{class t{constructor(t,e,n){this.store=t,this.eclEffects=e,this.commonService=n,this.nodeId="",this.amount=0,this.flgSticky=!1,this.displayedColumns=[],this.flgLoading=[!1],this.faRoute=g.FpQ,this.faExclamationTriangle=g.eHv,this.screenSize="",this.screenSizeEnum=f.cu,this.unSubs=[new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["alias","actions"]):this.screenSize===f.cu.SM||this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["alias","nodeId","actions"]):(this.flgSticky=!0,this.displayedColumns=["alias","nodeId","actions"])}ngOnInit(){this.qrHops=new ht.by([]),this.eclEffects.setQueryRoutes.pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.qrHops.data=[],t?(this.flgLoading[0]=!1,this.qrHops=new ht.by([...t]),this.qrHops.data=t):this.flgLoading[0]="error",this.qrHops.sort=this.sort,this.qrHops.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null})}onQueryRoutes(){if(!this.nodeId||!this.amount)return!0;this.qrHops.data=[],this.flgLoading[0]=!0,this.store.dispatch((0,ft.WO)({payload:{nodeId:this.nodeId,amount:1e3*this.amount}}))}resetData(){this.nodeId="",this.amount=0,this.flgLoading[0]=!1,this.qrHops.data=[],this.form.resetForm()}onHopClick(t,e){this.store.dispatch((0,It.qR)({payload:{data:{type:f.n_.INFORMATION,alertTitle:"Route Information",message:[[{key:"alias",value:t.alias,title:"Alias",width:100,type:f.Gi.STRING}],[{key:"nodeId",value:t.nodeId,title:"Node ID",width:100,type:f.Gi.STRING}]]}}}))}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(y.yh),s.Y36(pe.o),s.Y36(A.v))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-query-routes"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(Os,7)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.form=t.first)}},decls:39,vars:16,consts:[["fxLayout","column","fxFlex","100"],["fxLayout","column","fxLayoutAlign","space-between stretch","fxLayout.gt-sm","row wrap",3,"ngSubmit"],["queryRoutesForm","ngForm"],["fxFlex","100",1,"alert","alert-warn"],[1,"mr-1","alert-icon",3,"icon"],["fxFlex","69","fxLayoutAlign","start end"],["matInput","","placeholder","Destination Node ID","name","nodeId","tabindex","1","required","",3,"ngModel","ngModelChange"],["destPubkey","ngModel"],[4,"ngIf"],["fxFlex","29","fxLayoutAlign","start end"],["matInput","","placeholder","Amount (Sats)","name","amount","tabindex","2","type","number","required","",3,"ngModel","step","min","ngModelChange"],["fxLayout","row",1,"mt-2"],["mat-stroked-button","","color","primary","tabindex","3","type","reset",1,"mr-1",3,"click"],["mat-flat-button","","color","primary","type","submit","tabindex","4"],["fxLayout","row","fxLayoutAlign","start center",1,"page-sub-title-container","mt-2","mb-1"],["fxFlex","70"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],[1,"table-container","mb-6",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","alias"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nodeId"],["matColumnDef","actions"],["mat-header-cell","","class","pl-4 pr-3",4,"matHeaderCellDef"],["mat-cell","","class","pl-4",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell","",1,"pl-4","pr-3"],["fxLayoutAlign","end center"],["mat-cell","",1,"pl-4"],["mat-stroked-button","","color","primary","type","button","tabindex","4",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",0),s.TgZ(1,"form",1,2),s.NdJ("ngSubmit",function(){return s.CHM(t),s.MAs(2).form.valid&&e.onQueryRoutes()}),s.TgZ(3,"div",3),s._UZ(4,"fa-icon",4),s.TgZ(5,"span"),s._uU(6,"The actual routing fee on a payment can be different from the fee shown on query routes."),s.qZA(),s.qZA(),s.TgZ(7,"mat-form-field",5),s.TgZ(8,"input",6,7),s.NdJ("ngModelChange",function(t){return e.nodeId=t}),s.qZA(),s.YNc(10,ks,2,0,"mat-error",8),s.qZA(),s.TgZ(11,"mat-form-field",9),s.TgZ(12,"input",10),s.NdJ("ngModelChange",function(t){return e.amount=t}),s.qZA(),s.YNc(13,Rs,2,0,"mat-error",8),s.qZA(),s.TgZ(14,"div",11),s.TgZ(15,"button",12),s.NdJ("click",function(){return e.resetData()}),s._uU(16,"Clear"),s.qZA(),s.TgZ(17,"button",13),s._uU(18,"Query Route"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(19,"div",14),s.TgZ(20,"div",15),s._UZ(21,"fa-icon",16),s.TgZ(22,"span",17),s._uU(23,"Transaction Route"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(24,"div",18),s.YNc(25,Es,1,0,"mat-progress-bar",19),s.TgZ(26,"table",20,21),s.ynx(28,22),s.YNc(29,Ms,2,0,"th",23),s.YNc(30,Js,2,1,"td",24),s.BQk(),s.ynx(31,25),s.YNc(32,Ps,2,0,"th",23),s.YNc(33,Ys,2,1,"td",24),s.BQk(),s.ynx(34,26),s.YNc(35,Qs,3,0,"th",27),s.YNc(36,Bs,3,0,"td",28),s.BQk(),s.YNc(37,Hs,1,0,"tr",29),s.YNc(38,zs,1,0,"tr",30),s.qZA(),s.qZA(),s.qZA()}2&t&&(s.xp6(4),s.Q6J("icon",e.faExclamationTriangle),s.xp6(4),s.Q6J("ngModel",e.nodeId),s.xp6(2),s.Q6J("ngIf",!e.nodeId),s.xp6(2),s.Q6J("ngModel",e.amount)("step",1e3)("min",0),s.xp6(1),s.Q6J("ngIf",!e.amount),s.xp6(8),s.Q6J("icon",e.faRoute),s.xp6(4),s.Q6J("ngIf",!0===e.flgLoading[0]),s.xp6(1),s.Q6J("dataSource",e.qrHops)("ngClass",s.VKq(14,Vs,"error"===e.flgLoading[0])),s.xp6(11),s.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",e.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",e.displayedColumns))},directives:[l.xw,l.yH,Zt._Y,Zt.JL,Zt.F,l.Wh,C.BN,k.KE,yt.Nt,Zt.Fj,Zt.Q7,Zt.JJ,Zt.On,a.O5,Zt.wV,Zt.qQ,Ct.q,b.lW,M.$V,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.as,ht.nj,k.TO,r.pW,ht.ge,mt.nU,ht.ev,ht.XQ,ht.Gk],styles:[".mat-column-actions[_ngcontent-%COMP%]{flex:0 0 5%;width:5%}.mat-column-pubkey_alias[_ngcontent-%COMP%]{flex:1 1 25%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),t})();function Xs(t,e){1&t&&s._UZ(0,"mat-progress-bar",29)}function $s(t,e){1&t&&(s.TgZ(0,"th",30),s._uU(1," State "),s.qZA())}function Ws(t,e){if(1&t&&(s.TgZ(0,"span",36),s._UZ(1,"fa-icon",37),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("icon",t.faEyeSlash)}}function Ks(t,e){if(1&t&&(s.TgZ(0,"span",38),s._UZ(1,"fa-icon",37),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("icon",t.faEye)}}const js=function(t){return{"max-width":t}};function tl(t,e){if(1&t&&(s.TgZ(0,"td",31),s.TgZ(1,"div",32),s.YNc(2,Ws,2,1,"span",33),s.YNc(3,Ks,2,1,"span",34),s.TgZ(4,"span",35),s._uU(5),s.ALo(6,"titlecase"),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw();s.xp6(1),s.Q6J("ngStyle",s.VKq(6,js,n.screenSize===n.screenSizeEnum.XS?"10rem":"20rem")),s.xp6(1),s.Q6J("ngIf",0===t.channelFlags),s.xp6(1),s.Q6J("ngIf",0!==t.channelFlags),s.xp6(2),s.Oqu(s.lcZ(6,4,null==t?null:t.state))}}function el(t,e){1&t&&(s.TgZ(0,"th",30),s._uU(1," Short Channel ID "),s.qZA())}function nl(t,e){if(1&t&&(s.TgZ(0,"td",31),s._uU(1),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(null==t?null:t.shortChannelId)}}function al(t,e){1&t&&(s.TgZ(0,"th",30),s._uU(1," Alias "),s.qZA())}function il(t,e){if(1&t&&(s.TgZ(0,"td",31),s.TgZ(1,"div",32),s.TgZ(2,"span",35),s._uU(3),s.qZA(),s.qZA(),s.qZA()),2&t){const t=e.$implicit,n=s.oxw();s.xp6(1),s.Q6J("ngStyle",s.VKq(2,js,n.screenSize===n.screenSizeEnum.XS?"10rem":"20rem")),s.xp6(2),s.Oqu(t.alias)}}function ol(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1," Local Balance (Sats) "),s.qZA())}function sl(t,e){if(1&t&&(s.TgZ(0,"td",31),s.TgZ(1,"span",40),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.toLocal,"1.0-0")," ")}}function ll(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1," Remote Balance (Sats) "),s.qZA())}function rl(t,e){if(1&t&&(s.TgZ(0,"td",31),s.TgZ(1,"span",40),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.hij(" ",s.xi3(3,1,null==t?null:t.toRemote,"1.0-0")," ")}}function cl(t,e){1&t&&(s.TgZ(0,"th",41),s._uU(1,"Balance Score "),s.qZA())}function ul(t,e){if(1&t&&(s.TgZ(0,"td",42),s.TgZ(1,"div",43),s.TgZ(2,"mat-hint",44),s._uU(3),s.ALo(4,"number"),s.qZA(),s.qZA(),s._UZ(5,"mat-progress-bar",45),s.qZA()),2&t){const t=e.$implicit;s.xp6(3),s.Oqu(s.lcZ(4,2,(null==t?null:t.balancedness)||0)),s.xp6(2),s.s9C("value",t.toLocal&&t.toLocal>0?+t.toLocal/(+t.toLocal+ +t.toRemote)*100:0)}}function dl(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",46),s.TgZ(1,"div",47),s.TgZ(2,"mat-select",48),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",49),s.NdJ("click",function(){return s.CHM(t),s.oxw().onDownloadCSV()}),s._uU(5,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function pl(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",50),s.TgZ(1,"div",51),s.TgZ(2,"mat-select",52),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",49),s.NdJ("click",function(e){const n=s.CHM(t).$implicit;return s.oxw().onChannelClick(n,e)}),s._uU(5,"View Info"),s.qZA(),s.TgZ(6,"mat-option",49),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().onChannelClose(e,!0)}),s._uU(7,"Force Close"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function ml(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No inactive channel available."),s.qZA())}function hl(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting inactive channels..."),s.qZA())}function gl(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Oqu(t.errorMessage)}}function fl(t,e){if(1&t&&(s.TgZ(0,"td",53),s.YNc(1,ml,2,0,"p",54),s.YNc(2,hl,2,0,"p",54),s.YNc(3,gl,2,1,"p",54),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.channels&&t.channels.data)||(null==t.channels||null==t.channels.data?null:t.channels.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const xl=function(t){return{"display-none":t}};function Zl(t,e){if(1&t&&s._UZ(0,"tr",55),2&t){const t=s.oxw();s.Q6J("ngClass",s.VKq(1,xl,(null==t.channels?null:t.channels.data)&&(null==t.channels||null==t.channels.data?null:t.channels.data.length)>0))}}function yl(t,e){1&t&&s._UZ(0,"tr",56)}function Al(t,e){1&t&&s._UZ(0,"tr",57)}const Cl=function(t){return{"overflow-auto error-border":t,"overflow-auto":!0}},Tl=function(){return["no_channel"]};let Sl=(()=>{class t{constructor(t,e,n,a){this.logger=t,this.store=e,this.rtlEffects=n,this.commonService=a,this.faEye=g.Mdf,this.faEyeSlash=g.Aq,this.totalBalance=0,this.displayedColumns=[],this.myChanPolicy={},this.information={},this.numPeers=-1,this.feeRateTypes=f.vn,this.selFilter="",this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS||this.screenSize===f.cu.SM?(this.flgSticky=!1,this.displayedColumns=["state","alias","toLocal","toRemote","actions"]):this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["state","shortChannelId","alias","toLocal","toRemote","actions"]):(this.flgSticky=!0,this.displayedColumns=["state","shortChannelId","alias","toLocal","toRemote","balancedness","actions"])}ngOnInit(){this.store.select(x.Xz).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.inactiveChannels=t.inactiveChannels,this.loadChannelsTable(),this.logger.info(t)}),this.store.select(x.yD).pipe((0,p.R)(this.unSubs[1])).subscribe(t=>{this.information=t}),this.store.select(x.Bo).pipe((0,p.R)(this.unSubs[2])).subscribe(t=>{this.numPeers=t.peers&&t.peers.length?t.peers.length:0}),this.store.select(x.kY).pipe((0,p.R)(this.unSubs[3])).subscribe(t=>{this.totalBalance=t.onchainBalance.total})}ngAfterViewInit(){this.inactiveChannels.length>0&&this.loadChannelsTable()}onChannelClose(t,e){this.store.dispatch((0,It.c1)({payload:{data:{type:f.n_.CONFIRM,alertTitle:e?"Force Close Channel":"Close Channel",titleMessage:e?"Force closing channel: "+t.channelId:"Closing channel: "+t.channelId,noBtnText:"Cancel",yesBtnText:e?"Force Close":"Close Channel"}}})),this.rtlEffects.closeConfirm.pipe((0,p.R)(this.unSubs[4])).subscribe(n=>{n&&this.store.dispatch((0,ft.BL)({payload:{channelId:t.channelId,force:e}}))})}applyFilter(){this.channels.filter=this.selFilter.trim().toLocaleLowerCase()}onChannelClick(t,e){this.store.dispatch((0,It.qR)({payload:{data:{channel:t,channelsType:"inactive",component:Hi}}}))}loadChannelsTable(){this.inactiveChannels.sort((t,e)=>t.alias===e.alias?0:e.alias?1:-1),this.channels=new ht.by([...this.inactiveChannels]),this.channels.sort=this.sort,this.channels.sortingDataAccessor=(t,e)=>t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null,this.channels.filterPredicate=(t,e)=>JSON.stringify(t).toLowerCase().includes(e),this.channels.paginator=this.paginator,this.applyFilter(),this.logger.info(this.channels)}onDownloadCSV(){this.channels.data&&this.channels.data.length>0&&this.commonService.downloadFile(this.channels.data,"InactiveChannels")}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(y.yh),s.Y36(_e.V),s.Y36(A.v))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-channel-inactive-table"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Channels")}])],decls:36,vars:14,consts:[["fxLayout","column",1,"padding-gap"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign.gt-xs","start center","fxLayoutAlign","start stretch",1,"page-sub-title-container"],["fxFlex","70"],["fxFlex","30"],["matInput","","name","filter","placeholder","Filter",3,"ngModel","keyup","ngModelChange"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",3,"dataSource","ngClass"],["table",""],["matColumnDef","state"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","shortChannelId"],["matColumnDef","alias"],["matColumnDef","toLocal"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",4,"matHeaderCellDef"],["matColumnDef","toRemote"],["matColumnDef","balancedness"],["mat-header-cell","","mat-sort-header","","class","pl-3",4,"matHeaderCellDef"],["mat-cell","","class","pl-3",4,"matCellDef"],["matColumnDef","actions"],["mat-header-cell","","class","pl-1",4,"matHeaderCellDef"],["mat-cell","","class","pl-1","fxLayoutAlign","end center",4,"matCellDef"],["matColumnDef","no_channel"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"ellipsis-parent",3,"ngStyle"],["class","mr-1","matTooltip","Private","matTooltipPosition","right",4,"ngIf"],["class","mr-1","matTooltip","Public","matTooltipPosition","right",4,"ngIf"],[1,"ellipsis-child"],["matTooltip","Private","matTooltipPosition","right",1,"mr-1"],[3,"icon"],["matTooltip","Public","matTooltipPosition","right",1,"mr-1"],["mat-header-cell","","mat-sort-header","","arrowPosition","before"],["fxLayoutAlign","end center"],["mat-header-cell","","mat-sort-header","",1,"pl-3"],["mat-cell","",1,"pl-3"],["fxLayout","row"],["fxFlex","100","fxLayoutAlign","center center",1,"font-size-80"],["mode","determinate",3,"value"],["mat-header-cell","",1,"pl-1"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",1,"pl-1"],["fxLayoutAlign","center center",1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","2",1,"mr-0"],["mat-footer-cell","","colspan","4"],[4,"ngIf"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"div",1),s._UZ(2,"div",2),s.TgZ(3,"mat-form-field",3),s.TgZ(4,"input",4),s.NdJ("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.selFilter=t}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(5,"div",5),s.YNc(6,Xs,1,0,"mat-progress-bar",6),s.TgZ(7,"table",7,8),s.ynx(9,9),s.YNc(10,$s,2,0,"th",10),s.YNc(11,tl,7,8,"td",11),s.BQk(),s.ynx(12,12),s.YNc(13,el,2,0,"th",10),s.YNc(14,nl,2,1,"td",11),s.BQk(),s.ynx(15,13),s.YNc(16,al,2,0,"th",10),s.YNc(17,il,4,4,"td",11),s.BQk(),s.ynx(18,14),s.YNc(19,ol,2,0,"th",15),s.YNc(20,sl,4,4,"td",11),s.BQk(),s.ynx(21,16),s.YNc(22,ll,2,0,"th",15),s.YNc(23,rl,4,4,"td",11),s.BQk(),s.ynx(24,17),s.YNc(25,cl,2,0,"th",18),s.YNc(26,ul,6,4,"td",19),s.BQk(),s.ynx(27,20),s.YNc(28,dl,6,0,"th",21),s.YNc(29,pl,8,0,"td",22),s.BQk(),s.ynx(30,23),s.YNc(31,fl,4,3,"td",24),s.BQk(),s.YNc(32,Zl,1,3,"tr",25),s.YNc(33,yl,1,0,"tr",26),s.YNc(34,Al,1,0,"tr",27),s.qZA(),s.qZA(),s._UZ(35,"mat-paginator",28),s.qZA()),2&t&&(s.xp6(4),s.Q6J("ngModel",e.selFilter),s.xp6(2),s.Q6J("ngIf",e.apiCallStatus.status===e.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",e.channels)("ngClass",s.VKq(11,Cl,""!==e.errorMessage)),s.xp6(25),s.Q6J("matFooterRowDef",s.DdM(13,Tl)),s.xp6(1),s.Q6J("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",e.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",e.displayedColumns),s.xp6(1),s.Q6J("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions)("showFirstLastButtons",e.screenSize!==e.screenSizeEnum.XS))},directives:[l.xw,l.Wh,l.yH,k.KE,yt.Nt,Zt.Fj,Zt.JJ,Zt.On,M.$V,a.O5,ht.BZ,mt.YE,a.mk,v.oO,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,a.PC,v.Zl,R.gM,C.BN,k.bx,Tt.gD,Tt.$L,St.ey,ht.yh,ht.Q2,ht.XQ,ht.Gk],pipes:[a.rS,a.JJ],styles:[".mat-column-state[_ngcontent-%COMP%]{flex:0 0 15%;width:15%}.mat-column-state[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%]{display:flex}.mat-column-alias[_ngcontent-%COMP%]{flex:0 0 15%;width:15%}.mat-column-alias[_ngcontent-%COMP%]   .ellipsis-parent[_ngcontent-%COMP%]{display:flex}.mat-column-balancedness[_ngcontent-%COMP%]{padding-left:3rem;flex:0 0 20%;width:20%}.mat-column-shortChannelId[_ngcontent-%COMP%], .mat-column-toLocal[_ngcontent-%COMP%], .mat-column-toRemote[_ngcontent-%COMP%]{flex:1 1 15%;width:15%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media only screen and (max-width:37.5em){.mat-column-shortChannelId[_ngcontent-%COMP%], .mat-column-toLocal[_ngcontent-%COMP%], .mat-column-toRemote[_ngcontent-%COMP%]{white-space:unset}}.mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}.mat-column-actions[_ngcontent-%COMP%]   .bordered-box.table-actions-select[_ngcontent-%COMP%]{flex:0 0 100%}@media only screen and (max-width:37.5em){.mat-column-actions[_ngcontent-%COMP%]   .bordered-box.table-actions-select[_ngcontent-%COMP%]{flex:0 0 80%}}"]}),t})();function wl(t,e){if(1&t&&(s.TgZ(0,"div",5),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.errorMessage)}}function vl(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",6),s._UZ(1,"div",7),s.TgZ(2,"mat-form-field",8),s.TgZ(3,"input",9),s.NdJ("ngModelChange",function(e){return s.CHM(t),s.oxw().filterValue=e})("input",function(){return s.CHM(t),s.oxw().applyFilter()})("keyup",function(){return s.CHM(t),s.oxw().applyFilter()}),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(3),s.Q6J("ngModel",t.filterValue)}}function bl(t,e){1&t&&s._UZ(0,"mat-progress-bar",32)}function ql(t,e){1&t&&(s.TgZ(0,"th",33),s._uU(1,"Date/Time"),s.qZA())}function Ll(t,e){if(1&t&&(s.TgZ(0,"td",34),s._uU(1),s.ALo(2,"date"),s.qZA()),2&t){const t=e.$implicit;s.xp6(1),s.Oqu(s.xi3(2,1,null==t?null:t.timestamp,"dd/MMM/YYYY HH:mm"))}}function _l(t,e){1&t&&(s.TgZ(0,"th",33),s._uU(1,"In Channel"),s.qZA())}const Il=function(t){return{"max-width":t}};function Nl(t,e){if(1&t&&(s.TgZ(0,"td",35),s._uU(1),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("ngStyle",s.VKq(2,Il,n.screenSize===n.screenSizeEnum.XS?"10rem":"20rem")),s.xp6(1),s.Oqu(null==t?null:t.fromChannelAlias)}}function Dl(t,e){1&t&&(s.TgZ(0,"th",33),s._uU(1,"Out Channel"),s.qZA())}function Fl(t,e){if(1&t&&(s.TgZ(0,"td",35),s._uU(1),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("ngStyle",s.VKq(2,Il,n.screenSize===n.screenSizeEnum.XS?"10rem":"20rem")),s.xp6(1),s.Oqu(null==t?null:t.toChannelAlias)}}function Ul(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1,"Amount In (Sats)"),s.qZA())}function Ol(t,e){if(1&t&&(s.TgZ(0,"td",34),s.TgZ(1,"span",37),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,null==t?null:t.amountIn))}}function kl(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1,"Amount Out (Sats)"),s.qZA())}function Rl(t,e){if(1&t&&(s.TgZ(0,"td",34),s.TgZ(1,"span",37),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,null==t?null:t.amountOut))}}function El(t,e){1&t&&(s.TgZ(0,"th",36),s._uU(1,"Fee Earned (Sats)"),s.qZA())}function Ml(t,e){if(1&t&&(s.TgZ(0,"td",34),s.TgZ(1,"span",37),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,(null==t?null:t.amountIn)-(null==t?null:t.amountOut)))}}function Jl(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"th",38),s.TgZ(1,"div",39),s.TgZ(2,"mat-select",40),s._UZ(3,"mat-select-trigger"),s.TgZ(4,"mat-option",41),s.NdJ("click",function(){return s.CHM(t),s.oxw(2).onDownloadCSV()}),s._uU(5,"Download CSV"),s.qZA(),s.qZA(),s.qZA(),s.qZA()}}function Pl(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"td",42),s.TgZ(1,"button",43),s.NdJ("click",function(e){const n=s.CHM(t).$implicit;return s.oxw(2).onForwardingEventClick(n,e)}),s._uU(2,"View Info"),s.qZA(),s.qZA()}}function Yl(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No forwarding history available."),s.qZA())}function Ql(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting forwarding history..."),s.qZA())}function Bl(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Oqu(t.errorMessage)}}function Hl(t,e){if(1&t&&(s.TgZ(0,"td",44),s.YNc(1,Yl,2,0,"p",45),s.YNc(2,Ql,2,0,"p",45),s.YNc(3,Bl,2,1,"p",45),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",(!(null!=t.forwardingHistoryEvents&&t.forwardingHistoryEvents.data)||(null==t.forwardingHistoryEvents||null==t.forwardingHistoryEvents.data?null:t.forwardingHistoryEvents.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.forwardingHistoryEvents&&t.forwardingHistoryEvents.data)||(null==t.forwardingHistoryEvents||null==t.forwardingHistoryEvents.data?null:t.forwardingHistoryEvents.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.forwardingHistoryEvents&&t.forwardingHistoryEvents.data)||(null==t.forwardingHistoryEvents||null==t.forwardingHistoryEvents.data?null:t.forwardingHistoryEvents.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const zl=function(t){return{"display-none":t}};function Vl(t,e){if(1&t&&s._UZ(0,"tr",46),2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,zl,(null==t.forwardingHistoryEvents?null:t.forwardingHistoryEvents.data)&&(null==t.forwardingHistoryEvents||null==t.forwardingHistoryEvents.data?null:t.forwardingHistoryEvents.data.length)>0))}}function Gl(t,e){1&t&&s._UZ(0,"tr",47)}function Xl(t,e){1&t&&s._UZ(0,"tr",48)}const $l=function(){return["no_event"]};function Wl(t,e){if(1&t&&(s.TgZ(0,"div",10),s.YNc(1,bl,1,0,"mat-progress-bar",11),s.TgZ(2,"table",12,13),s.ynx(4,14),s.YNc(5,ql,2,0,"th",15),s.YNc(6,Ll,3,4,"td",16),s.BQk(),s.ynx(7,17),s.YNc(8,_l,2,0,"th",15),s.YNc(9,Nl,2,4,"td",18),s.BQk(),s.ynx(10,19),s.YNc(11,Dl,2,0,"th",15),s.YNc(12,Fl,2,4,"td",18),s.BQk(),s.ynx(13,20),s.YNc(14,Ul,2,0,"th",21),s.YNc(15,Ol,4,3,"td",16),s.BQk(),s.ynx(16,22),s.YNc(17,kl,2,0,"th",21),s.YNc(18,Rl,4,3,"td",16),s.BQk(),s.ynx(19,23),s.YNc(20,El,2,0,"th",21),s.YNc(21,Ml,4,3,"td",16),s.BQk(),s.ynx(22,24),s.YNc(23,Jl,6,0,"th",25),s.YNc(24,Pl,3,0,"td",26),s.BQk(),s.ynx(25,27),s.YNc(26,Hl,4,3,"td",28),s.BQk(),s.YNc(27,Vl,1,3,"tr",29),s.YNc(28,Gl,1,0,"tr",30),s.YNc(29,Xl,1,0,"tr",31),s.qZA(),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Q6J("ngIf",t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",t.forwardingHistoryEvents),s.xp6(25),s.Q6J("matFooterRowDef",s.DdM(6,$l)),s.xp6(1),s.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",t.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns)}}function Kl(t,e){if(1&t&&s._UZ(0,"mat-paginator",49),2&t){const t=s.oxw();s.Q6J("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.screenSize!==t.screenSizeEnum.XS)}}let jl=(()=>{class t{constructor(t,e,n,a){this.logger=t,this.commonService=e,this.store=n,this.datePipe=a,this.eventsData=[],this.filterValue="",this.displayedColumns=[],this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["timestamp","amountIn","actions"]):this.screenSize===f.cu.SM?(this.flgSticky=!1,this.displayedColumns=["timestamp","amountIn","fee","actions"]):this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["timestamp","amountIn","amountOut","fee","actions"]):(this.flgSticky=!0,this.displayedColumns=["timestamp","fromChannelAlias","toChannelAlias","amountIn","amountOut","fee","actions"])}ngOnInit(){this.store.select(x.PP).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{0===this.eventsData.length&&(this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.eventsData=t.payments&&t.payments.relayed?t.payments.relayed:[],this.eventsData.length>0&&this.sort&&this.paginator&&this.loadForwardingEventsTable(this.eventsData),this.logger.info(this.eventsData))})}ngAfterViewInit(){this.eventsData.length>0&&this.loadForwardingEventsTable(this.eventsData)}ngOnChanges(t){t.eventsData&&(this.apiCallStatus={status:f.Bn.COMPLETED,action:"FetchPayments"},this.eventsData=t.eventsData.currentValue,t.eventsData.firstChange||this.loadForwardingEventsTable(this.eventsData)),t.filterValue&&!t.filterValue.firstChange&&this.applyFilter()}onForwardingEventClick(t,e){const n=[[{key:"paymentHash",value:t.paymentHash,title:"Payment Hash",width:100,type:f.Gi.STRING}],[{key:"timestamp",value:Math.round(t.timestamp/1e3),title:"Date/Time",width:50,type:f.Gi.DATE_TIME},{key:"fee",value:t.amountIn-t.amountOut,title:"Fee Earned (Sats)",width:50,type:f.Gi.NUMBER}],[{key:"amountIn",value:t.amountIn,title:"Amount In (Sats)",width:50,type:f.Gi.NUMBER},{key:"amountOut",value:t.amountOut,title:"Amount Out (Sats)",width:50,type:f.Gi.NUMBER}],[{key:"fromChannelAlias",value:t.fromChannelAlias,title:"From Channel Alias",width:50,type:f.Gi.STRING},{key:"fromShortChannelId",value:t.fromShortChannelId,title:"From Short Channel ID",width:50,type:f.Gi.STRING}],[{key:"fromChannelId",value:t.fromChannelId,title:"From Channel Id",width:100,type:f.Gi.STRING}],[{key:"toChannelAlias",value:t.toChannelAlias,title:"To Channel Alias",width:50,type:f.Gi.STRING},{key:"toShortChannelId",value:t.toShortChannelId,title:"To Short Channel ID",width:50,type:f.Gi.STRING}],[{key:"toChannelId",value:t.toChannelId,title:"To Channel Id",width:100,type:f.Gi.STRING}]];this.store.dispatch((0,It.qR)({payload:{data:{type:f.n_.INFORMATION,alertTitle:"Event Information",message:n}}}))}loadForwardingEventsTable(t){this.forwardingHistoryEvents=new ht.by([...t]),this.forwardingHistoryEvents.sort=this.sort,this.forwardingHistoryEvents.sortingDataAccessor=(t,e)=>{switch(e){case"fee":return t.amountIn-t.amountOut;default:return t[e]&&isNaN(t[e])?t[e].toLocaleLowerCase():t[e]?+t[e]:null}},this.forwardingHistoryEvents.filterPredicate=(t,e)=>((t.timestamp?this.datePipe.transform(new Date(t.timestamp),"dd/MMM/YYYY HH:mm").toLowerCase():"")+JSON.stringify(t).toLowerCase()).includes(e),this.forwardingHistoryEvents.paginator=this.paginator,this.applyFilter(),this.logger.info(this.forwardingHistoryEvents)}onDownloadCSV(){this.forwardingHistoryEvents&&this.forwardingHistoryEvents.data&&this.forwardingHistoryEvents.data.length>0&&this.commonService.downloadFile(this.forwardingHistoryEvents.data,"Forwarding-history")}applyFilter(){this.forwardingHistoryEvents&&(this.forwardingHistoryEvents.filter=this.filterValue.trim().toLowerCase())}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(A.v),s.Y36(y.yh),s.Y36(a.uU))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-forwarding-history"]],viewQuery:function(t,e){if(1&t&&(s.Gf(mt.YE,5),s.Gf(pt.NW,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sort=t.first),s.iGM(t=s.CRH())&&(e.paginator=t.first)}},inputs:{eventsData:"eventsData",filterValue:"filterValue"},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Events")}]),s.TTD],decls:5,vars:4,consts:[["fxLayout","column","fxLayoutAlign","start stretch",1,"padding-gap-x"],["class","p-2 error-border my-2",4,"ngIf"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign.gt-xs","start center","fxLayoutAlign","start stretch","class","page-sub-title-container",4,"ngIf"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100","class","table-container",3,"perfectScrollbar",4,"ngIf"],["class","mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons",4,"ngIf"],[1,"p-2","error-border","my-2"],["fxLayout","column","fxLayout.gt-xs","row","fxLayoutAlign.gt-xs","start center","fxLayoutAlign","start stretch",1,"page-sub-title-container"],["fxFlex","70"],["fxFlex","30"],["matInput","","name","filter","placeholder","Filter",3,"ngModel","ngModelChange","input","keyup"],["fxLayout","column","fxLayoutAlign","start center","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","fxFlex","100","matSort","",1,"overflow-auto",3,"dataSource"],["table",""],["matColumnDef","timestamp"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fromChannelAlias"],["mat-cell","",3,"ngStyle",4,"matCellDef"],["matColumnDef","toChannelAlias"],["matColumnDef","amountIn"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",4,"matHeaderCellDef"],["matColumnDef","amountOut"],["matColumnDef","fee"],["matColumnDef","actions"],["mat-header-cell","","class","px-3",4,"matHeaderCellDef"],["mat-cell","","class","px-3","fxLayoutAlign","end center",4,"matCellDef"],["matColumnDef","no_event"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",3,"ngStyle"],["mat-header-cell","","mat-sort-header","","arrowPosition","before"],["fxLayoutAlign","end center"],["mat-header-cell","",1,"px-3"],[1,"bordered-box","table-actions-select"],["placeholder","Actions","tabindex","1",1,"mr-0"],[3,"click"],["mat-cell","","fxLayoutAlign","end center",1,"px-3"],["mat-stroked-button","","color","primary","type","button","tabindex","4",3,"click"],["mat-footer-cell","","colspan","4"],[4,"ngIf"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.YNc(1,wl,2,1,"div",1),s.YNc(2,vl,4,1,"div",2),s.YNc(3,Wl,30,7,"div",3),s.YNc(4,Kl,1,3,"mat-paginator",4),s.qZA()),2&t&&(s.xp6(1),s.Q6J("ngIf",""!==e.errorMessage),s.xp6(1),s.Q6J("ngIf",""===e.errorMessage),s.xp6(1),s.Q6J("ngIf",""===e.errorMessage),s.xp6(1),s.Q6J("ngIf",""===e.errorMessage))},directives:[l.xw,l.Wh,a.O5,l.yH,k.KE,yt.Nt,Zt.Fj,Zt.JJ,Zt.On,M.$V,ht.BZ,mt.YE,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,r.pW,ht.ge,mt.nU,ht.ev,a.PC,v.Zl,Tt.gD,Tt.$L,St.ey,b.lW,ht.yh,ht.Q2,a.mk,v.oO,ht.XQ,ht.Gk,pt.NW],pipes:[a.uU,a.JJ],styles:[".mat-column-fromAlias[_ngcontent-%COMP%]{padding-left:2rem}.mat-column-fromAlias[_ngcontent-%COMP%], .mat-column-toAlias[_ngcontent-%COMP%]{flex:1 1 20%;width:20%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-column-toAlias[_ngcontent-%COMP%]{padding-left:1rem}.mat-column-actions[_ngcontent-%COMP%]{min-height:4.8rem}"]}),t})();const tr=["tableIn"],er=["tableOut"],nr=["paginatorIn"],ar=["paginatorOut"];function ir(t,e){if(1&t&&(s.TgZ(0,"div",3),s._uU(1),s.qZA()),2&t){const t=s.oxw();s.xp6(1),s.Oqu(t.errorMessage)}}function or(t,e){1&t&&s._UZ(0,"mat-progress-bar",36)}function sr(t,e){1&t&&(s.TgZ(0,"th",37),s._uU(1,"Channel ID"),s.qZA())}const lr=function(t){return{"max-width":t}};function rr(t,e){if(1&t&&(s.TgZ(0,"td",38),s._uU(1),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("ngStyle",s.VKq(2,lr,n.screenSize===n.screenSizeEnum.XS?"5rem":"10rem")),s.xp6(1),s.Oqu(t.channelId)}}function cr(t,e){1&t&&(s.TgZ(0,"th",37),s._uU(1,"Peer Alias"),s.qZA())}function ur(t,e){if(1&t&&(s.TgZ(0,"td",38),s._uU(1),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("ngStyle",s.VKq(2,lr,n.screenSize===n.screenSizeEnum.XS?"5rem":"10rem")),s.xp6(1),s.Oqu(t.alias)}}function dr(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1,"Events"),s.qZA())}function pr(t,e){if(1&t&&(s.TgZ(0,"td",40),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,t.events))}}function mr(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1,"Amount (Sats)"),s.qZA())}function hr(t,e){if(1&t&&(s.TgZ(0,"td",40),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,t.totalAmount))}}function gr(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1,"Fee (Sats)"),s.qZA())}function fr(t,e){if(1&t&&(s.TgZ(0,"td",40),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,t.totalFee))}}function xr(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No incoming routing peer available."),s.qZA())}function Zr(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting incoming routing peers..."),s.qZA())}function yr(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Oqu(t.errorMessage)}}function Ar(t,e){if(1&t&&(s.TgZ(0,"td",42),s.YNc(1,xr,2,0,"p",43),s.YNc(2,Zr,2,0,"p",43),s.YNc(3,yr,2,1,"p",43),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",(!(null!=t.RoutingPeersIncoming&&t.RoutingPeersIncoming.data)||(null==t.RoutingPeersIncoming||null==t.RoutingPeersIncoming.data?null:t.RoutingPeersIncoming.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.RoutingPeersIncoming&&t.RoutingPeersIncoming.data)||(null==t.RoutingPeersIncoming||null==t.RoutingPeersIncoming.data?null:t.RoutingPeersIncoming.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.RoutingPeersIncoming&&t.RoutingPeersIncoming.data)||(null==t.RoutingPeersIncoming||null==t.RoutingPeersIncoming.data?null:t.RoutingPeersIncoming.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}const Cr=function(t){return{"display-none":t}};function Tr(t,e){if(1&t&&s._UZ(0,"tr",44),2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,Cr,(null==t.RoutingPeersIncoming?null:t.RoutingPeersIncoming.data)&&(null==t.RoutingPeersIncoming||null==t.RoutingPeersIncoming.data?null:t.RoutingPeersIncoming.data.length)>0))}}function Sr(t,e){1&t&&s._UZ(0,"tr",45)}function wr(t,e){1&t&&s._UZ(0,"tr",46)}function vr(t,e){1&t&&s._UZ(0,"mat-progress-bar",36)}function br(t,e){1&t&&(s.TgZ(0,"th",37),s._uU(1,"Channel ID"),s.qZA())}function qr(t,e){if(1&t&&(s.TgZ(0,"td",38),s._uU(1),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("ngStyle",s.VKq(2,lr,n.screenSize===n.screenSizeEnum.XS?"5rem":"10rem")),s.xp6(1),s.Oqu(t.channelId)}}function Lr(t,e){1&t&&(s.TgZ(0,"th",37),s._uU(1,"Peer Alias"),s.qZA())}function _r(t,e){if(1&t&&(s.TgZ(0,"td",38),s._uU(1),s.qZA()),2&t){const t=e.$implicit,n=s.oxw(2);s.Q6J("ngStyle",s.VKq(2,lr,n.screenSize===n.screenSizeEnum.XS?"5rem":"10rem")),s.xp6(1),s.Oqu(t.alias)}}function Ir(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1,"Events"),s.qZA())}function Nr(t,e){if(1&t&&(s.TgZ(0,"td",40),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,t.events))}}function Dr(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1,"Amount (Sats)"),s.qZA())}function Fr(t,e){if(1&t&&(s.TgZ(0,"td",40),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,t.totalAmount))}}function Ur(t,e){1&t&&(s.TgZ(0,"th",39),s._uU(1,"Fee (Sats)"),s.qZA())}function Or(t,e){if(1&t&&(s.TgZ(0,"td",40),s.TgZ(1,"span",41),s._uU(2),s.ALo(3,"number"),s.qZA(),s.qZA()),2&t){const t=e.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,1,t.totalFee))}}function kr(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"No outgoing routing peer available."),s.qZA())}function Rr(t,e){1&t&&(s.TgZ(0,"p"),s._uU(1,"Getting outgoing routing peers..."),s.qZA())}function Er(t,e){if(1&t&&(s.TgZ(0,"p"),s._uU(1),s.qZA()),2&t){const t=s.oxw(3);s.xp6(1),s.Oqu(t.errorMessage)}}function Mr(t,e){if(1&t&&(s.TgZ(0,"td",42),s.YNc(1,kr,2,0,"p",43),s.YNc(2,Rr,2,0,"p",43),s.YNc(3,Er,2,1,"p",43),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.Q6J("ngIf",(!(null!=t.RoutingPeersOutgoing&&t.RoutingPeersOutgoing.data)||(null==t.RoutingPeersOutgoing||null==t.RoutingPeersOutgoing.data?null:t.RoutingPeersOutgoing.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.COMPLETED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.RoutingPeersOutgoing&&t.RoutingPeersOutgoing.data)||(null==t.RoutingPeersOutgoing||null==t.RoutingPeersOutgoing.data?null:t.RoutingPeersOutgoing.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("ngIf",(!(null!=t.RoutingPeersOutgoing&&t.RoutingPeersOutgoing.data)||(null==t.RoutingPeersOutgoing||null==t.RoutingPeersOutgoing.data?null:t.RoutingPeersOutgoing.data.length)<1)&&t.apiCallStatus.status===t.apiCallStatusEnum.ERROR)}}function Jr(t,e){if(1&t&&s._UZ(0,"tr",44),2&t){const t=s.oxw(2);s.Q6J("ngClass",s.VKq(1,Cr,(null==t.RoutingPeersOutgoing?null:t.RoutingPeersOutgoing.data)&&(null==t.RoutingPeersOutgoing||null==t.RoutingPeersOutgoing.data?null:t.RoutingPeersOutgoing.data.length)>0))}}function Pr(t,e){1&t&&s._UZ(0,"tr",45)}function Yr(t,e){1&t&&s._UZ(0,"tr",46)}const Qr=function(t,e){return{"mt-2":t,"mt-1":e}},Br=function(){return["no_incoming_event"]},Hr=function(t){return{"mt-2":t}},zr=function(){return["no_outgoing_event"]};function Vr(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",4),s.TgZ(1,"div",5),s.TgZ(2,"div",6),s.TgZ(3,"div",7),s._uU(4,"Incoming"),s.qZA(),s.TgZ(5,"mat-form-field",8),s.TgZ(6,"input",9),s.NdJ("keyup",function(e){return s.CHM(t),s.oxw().applyIncomingFilter(e.target)}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"div",10),s.YNc(8,or,1,0,"mat-progress-bar",11),s.TgZ(9,"table",12,13),s.ynx(11,14),s.YNc(12,sr,2,0,"th",15),s.YNc(13,rr,2,4,"td",16),s.BQk(),s.ynx(14,17),s.YNc(15,cr,2,0,"th",15),s.YNc(16,ur,2,4,"td",16),s.BQk(),s.ynx(17,18),s.YNc(18,dr,2,0,"th",19),s.YNc(19,pr,4,3,"td",20),s.BQk(),s.ynx(20,21),s.YNc(21,mr,2,0,"th",19),s.YNc(22,hr,4,3,"td",20),s.BQk(),s.ynx(23,22),s.YNc(24,gr,2,0,"th",19),s.YNc(25,fr,4,3,"td",20),s.BQk(),s.ynx(26,23),s.YNc(27,Ar,4,3,"td",24),s.BQk(),s.YNc(28,Tr,1,3,"tr",25),s.YNc(29,Sr,1,0,"tr",26),s.YNc(30,wr,1,0,"tr",27),s.qZA(),s.qZA(),s._UZ(31,"mat-paginator",28,29),s.qZA(),s.TgZ(33,"div",30),s.TgZ(34,"div",6),s.TgZ(35,"div",7),s._uU(36,"Outgoing"),s.qZA(),s.TgZ(37,"mat-form-field",8),s.TgZ(38,"input",9),s.NdJ("keyup",function(e){return s.CHM(t),s.oxw().applyOutgoingFilter(e.target)}),s.qZA(),s.qZA(),s.qZA(),s.TgZ(39,"div",31),s.YNc(40,vr,1,0,"mat-progress-bar",11),s.TgZ(41,"table",32,33),s.ynx(43,14),s.YNc(44,br,2,0,"th",15),s.YNc(45,qr,2,4,"td",16),s.BQk(),s.ynx(46,17),s.YNc(47,Lr,2,0,"th",15),s.YNc(48,_r,2,4,"td",16),s.BQk(),s.ynx(49,18),s.YNc(50,Ir,2,0,"th",19),s.YNc(51,Nr,4,3,"td",20),s.BQk(),s.ynx(52,21),s.YNc(53,Dr,2,0,"th",19),s.YNc(54,Fr,4,3,"td",20),s.BQk(),s.ynx(55,22),s.YNc(56,Ur,2,0,"th",19),s.YNc(57,Or,4,3,"td",20),s.BQk(),s.ynx(58,34),s.YNc(59,Mr,4,3,"td",24),s.BQk(),s.YNc(60,Jr,1,3,"tr",25),s.YNc(61,Pr,1,0,"tr",26),s.YNc(62,Yr,1,0,"tr",27),s.qZA(),s._UZ(63,"mat-paginator",28,35),s.qZA(),s.qZA(),s.qZA()}if(2&t){const t=s.oxw();s.xp6(2),s.Q6J("ngClass",s.WLB(20,Qr,t.screenSize===t.screenSizeEnum.XS,t.screenSize===t.screenSizeEnum.SM)),s.xp6(6),s.Q6J("ngIf",t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",t.RoutingPeersIncoming),s.xp6(19),s.Q6J("matFooterRowDef",s.DdM(23,Br)),s.xp6(1),s.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",t.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns),s.xp6(1),s.Q6J("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.screenSize!==t.screenSizeEnum.XS),s.xp6(3),s.Q6J("ngClass",s.VKq(24,Hr,t.screenSize!==t.screenSizeEnum.LG)),s.xp6(6),s.Q6J("ngIf",t.apiCallStatus.status===t.apiCallStatusEnum.INITIATED),s.xp6(1),s.Q6J("dataSource",t.RoutingPeersOutgoing),s.xp6(19),s.Q6J("matFooterRowDef",s.DdM(26,zr)),s.xp6(1),s.Q6J("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",t.flgSticky),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns),s.xp6(1),s.Q6J("pageSize",t.pageSize)("pageSizeOptions",t.pageSizeOptions)("showFirstLastButtons",t.screenSize!==t.screenSizeEnum.XS)}}let Gr=(()=>{class t{constructor(t,e,n){this.logger=t,this.commonService=e,this.store=n,this.routingPeersData=[],this.displayedColumns=[],this.flgSticky=!1,this.pageSize=f.IV,this.pageSizeOptions=f.TJ,this.screenSize="",this.screenSizeEnum=f.cu,this.errorMessage="",this.apiCallStatus=null,this.apiCallStatusEnum=f.Bn,this.unSubs=[new d.x,new d.x,new d.x],this.screenSize=this.commonService.getScreenSize(),this.screenSize===f.cu.XS?(this.flgSticky=!1,this.displayedColumns=["alias","totalFee"]):this.screenSize===f.cu.SM?(this.flgSticky=!1,this.displayedColumns=["alias","events","totalFee"]):this.screenSize===f.cu.MD?(this.flgSticky=!1,this.displayedColumns=["alias","events","totalAmount","totalFee"]):(this.flgSticky=!0,this.displayedColumns=["channelId","alias","events","totalAmount","totalFee"])}ngOnInit(){this.store.select(x.PP).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.errorMessage="",this.apiCallStatus=t.apiCallStatus,this.apiCallStatus.status===f.Bn.ERROR&&(this.errorMessage="object"==typeof this.apiCallStatus.message?JSON.stringify(this.apiCallStatus.message):this.apiCallStatus.message),this.routingPeersData=t.payments&&t.payments.relayed?t.payments.relayed:[],this.routingPeersData.length>0&&this.sortIn&&this.paginatorIn&&this.sortOut&&this.paginatorOut&&this.loadRoutingPeersTable(this.routingPeersData),this.logger.info(t)})}ngAfterViewInit(){this.routingPeersData.length>0&&this.sortIn&&this.paginatorIn&&this.sortOut&&this.paginatorOut&&this.loadRoutingPeersTable(this.routingPeersData)}loadRoutingPeersTable(t){if(t.length>0){const e=this.groupRoutingPeers(t);this.RoutingPeersIncoming=new ht.by(e[0]),this.RoutingPeersIncoming.sort=this.sortIn,this.RoutingPeersIncoming.filterPredicate=(t,e)=>JSON.stringify(t).toLowerCase().includes(e),this.RoutingPeersIncoming.paginator=this.paginatorIn,this.logger.info(this.RoutingPeersIncoming),this.RoutingPeersOutgoing=new ht.by(e[1]),this.RoutingPeersOutgoing.sort=this.sortOut,this.RoutingPeersOutgoing.filterPredicate=(t,e)=>JSON.stringify(t).toLowerCase().includes(e),this.RoutingPeersOutgoing.paginator=this.paginatorOut,this.logger.info(this.RoutingPeersOutgoing)}else this.RoutingPeersIncoming=new ht.by([]),this.RoutingPeersOutgoing=new ht.by([])}groupRoutingPeers(t){const e=[],n=[];return t.forEach(t=>{const a=e.find(e=>e.channelId===t.fromChannelId),i=n.find(e=>e.channelId===t.toChannelId);a?(a.events++,a.totalAmount=+a.totalAmount+ +t.amountIn,a.totalFee=t.amountIn-t.amountOut+ +a.totalFee):e.push({channelId:t.fromChannelId,alias:t.fromChannelAlias,events:1,totalAmount:+t.amountIn,totalFee:t.amountIn-t.amountOut}),i?(i.events++,i.totalAmount=+i.totalAmount+ +t.amountOut,i.totalFee=t.amountIn-t.amountOut+ +i.totalFee):n.push({channelId:t.toChannelId,alias:t.toChannelAlias,events:1,totalAmount:+t.amountOut,totalFee:t.amountIn-t.amountOut})}),[this.commonService.sortDescByKey(e,"totalFee"),this.commonService.sortDescByKey(n,"totalFee")]}applyIncomingFilter(t){this.RoutingPeersIncoming.filter=t.value.trim().toLowerCase()}applyOutgoingFilter(t){this.RoutingPeersOutgoing.filter=t.value.trim().toLowerCase()}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(A.v),s.Y36(y.yh))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-routing-peers"]],viewQuery:function(t,e){if(1&t&&(s.Gf(tr,5,mt.YE),s.Gf(er,5,mt.YE),s.Gf(nr,5),s.Gf(ar,5)),2&t){let t;s.iGM(t=s.CRH())&&(e.sortIn=t.first),s.iGM(t=s.CRH())&&(e.sortOut=t.first),s.iGM(t=s.CRH())&&(e.paginatorIn=t.first),s.iGM(t=s.CRH())&&(e.paginatorOut=t.first)}},features:[s._Bn([{provide:pt.ye,useValue:(0,f.pt)("Peers")}])],decls:3,vars:2,consts:[["fxLayout","column","fxLayoutAlign","start stretch",1,"padding-gap"],["class","p-2 error-border my-2",4,"ngIf"],["fxLayout","column","fxLayout.gt-md","row","fxFlex","100","fxLayoutAlign","space-between stretch","class","page-sub-title-container",4,"ngIf"],[1,"p-2","error-border","my-2"],["fxLayout","column","fxLayout.gt-md","row","fxFlex","100","fxLayoutAlign","space-between stretch",1,"page-sub-title-container"],["fxLayout","column","fxFlex","49","fxLayoutAlign","start stretch",1,"mb-4"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","space-between center","fxLayoutAlign","start stretch",1,"page-sub-title-container","w-100",3,"ngClass"],["fxFlex","70"],["fxFlex","30"],["matInput","","placeholder","Filter",3,"keyup"],["fxLayout","column","fxLayoutAlign","start start","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mode","indeterminate",4,"ngIf"],["mat-table","","matSort","",1,"overflow-auto","incoming-table",3,"dataSource"],["tableIn",""],["matColumnDef","channelId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",3,"ngStyle",4,"matCellDef"],["matColumnDef","alias"],["matColumnDef","events"],["mat-header-cell","","mat-sort-header","","arrowPosition","before",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","totalAmount"],["matColumnDef","totalFee"],["matColumnDef","no_incoming_event"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-footer-row","",3,"ngClass",4,"matFooterRowDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mb-1",3,"pageSize","pageSizeOptions","showFirstLastButtons"],["paginatorIn",""],["fxLayout","column","fxFlex","49","fxLayoutAlign","end stretch",1,"mb-4"],["fxLayout","column","fxLayoutAlign","start end","fxFlex","100",1,"table-container",3,"perfectScrollbar"],["mat-table","","matSort","",1,"overflow-auto","outgoing-table",3,"dataSource"],["tableOut",""],["matColumnDef","no_outgoing_event"],["paginatorOut",""],["mode","indeterminate"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",3,"ngStyle"],["mat-header-cell","","mat-sort-header","","arrowPosition","before"],["mat-cell",""],["fxLayoutAlign","end center"],["mat-footer-cell","","colspan","4"],[4,"ngIf"],["mat-footer-row","",3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.YNc(1,ir,2,1,"div",1),s.YNc(2,Vr,65,27,"div",2),s.qZA()),2&t&&(s.xp6(1),s.Q6J("ngIf",""!==e.errorMessage),s.xp6(1),s.Q6J("ngIf",""===e.errorMessage))},directives:[l.xw,l.Wh,a.O5,l.yH,a.mk,v.oO,k.KE,yt.Nt,M.$V,ht.BZ,mt.YE,ht.w1,ht.fO,ht.Dz,ht.mD,ht.Ke,ht.as,ht.nj,pt.NW,r.pW,ht.ge,mt.nU,ht.ev,a.PC,v.Zl,ht.yh,ht.Q2,ht.XQ,ht.Gk],pipes:[a.JJ],styles:[".mat-column-alias[_ngcontent-%COMP%], .mat-column-channelId[_ngcontent-%COMP%]{flex:1 1 10%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]}),t})();function Xr(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"div",7),s.NdJ("click",function(){const e=s.CHM(t).$implicit;return s.oxw().activeLink=e.link}),s._uU(1),s.qZA()}if(2&t){const t=e.$implicit,n=s.oxw();s.s9C("routerLink",t.link),s.Q6J("active",n.activeLink===t.link),s.xp6(1),s.Oqu(t.name)}}let $r=(()=>{class t{constructor(t){this.router=t,this.faChartBar=g.koM,this.links=[{link:"routingfees",name:"Routing Fees"},{link:"transactions",name:"Transactions"}],this.activeLink=this.links[0].link,this.unSubs=[new d.x,new d.x,new d.x,new d.x]}ngOnInit(){const t=this.links.find(t=>this.router.url.includes(t.link));this.activeLink=t?t.link:this.links[0].link,this.router.events.pipe((0,p.R)(this.unSubs[0]),(0,dt.h)(t=>t instanceof i.Av)).subscribe(t=>{const e=this.links.find(e=>t.urlAfterRedirects.includes(e.link));this.activeLink=e?e.link:this.links[0].link})}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(i.F0))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-reports"]],decls:10,vars:2,consts:[["fxLayout","row","fxLayoutAlign","start center",1,"page-title-container"],[1,"page-title-img","mr-1",3,"icon"],[1,"page-title"],["fxLayout","column",1,"padding-gap-x"],["fxLayout","column"],["mat-tab-nav-bar",""],["role","tab","mat-tab-link","","class","mat-tab-label",3,"active","routerLink","click",4,"ngFor","ngForOf"],["role","tab","mat-tab-link","",1,"mat-tab-label",3,"active","routerLink","click"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s._UZ(1,"fa-icon",1),s.TgZ(2,"span",2),s._uU(3,"Reports"),s.qZA(),s.qZA(),s.TgZ(4,"div",3),s.TgZ(5,"mat-card"),s.TgZ(6,"mat-card-content",4),s.TgZ(7,"nav",5),s.YNc(8,Xr,2,3,"div",6),s.qZA(),s._UZ(9,"router-outlet"),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(1),s.Q6J("icon",e.faChartBar),s.xp6(7),s.Q6J("ngForOf",e.links))},directives:[l.xw,l.Wh,C.BN,S.a8,S.dn,ut.BU,a.sg,i.lC,ut.Nj,i.rH],styles:[""]}),t})();var Wr=n(4833),Kr=n(4018),jr=n(1905);function tc(t,e){if(1&t&&(s.TgZ(0,"div",8),s._uU(1),s.ALo(2,"number"),s.ALo(3,"number"),s.qZA()),2&t){const t=s.oxw();s.Q6J("@fadeIn",t.totalFeeSat),s.xp6(1),s.AsE("",s.xi3(2,3,t.totalFeeSat||0,"1.0-2")," Sats/",s.lcZ(3,6,t.filteredEventsBySelectedPeriod.length||0)," Events")}}function ec(t,e){1&t&&(s.TgZ(0,"div",9),s._uU(1,"No fee report for the selected period"),s.qZA())}function nc(t,e){if(1&t&&(s.TgZ(0,"span"),s.TgZ(1,"span",12),s._uU(2),s.ALo(3,"number"),s.qZA(),s.TgZ(4,"span",12),s._uU(5),s.ALo(6,"number"),s.qZA(),s.qZA()),2&t){const t=e.model;s.xp6(2),s.hij("Events: ",s.lcZ(3,2,t.extra.totalEvents||0),""),s.xp6(3),s.hij("Fee: ",s.xi3(6,4,t.value||0,"1.0-2"),"")}}function ac(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"ngx-charts-bar-vertical",10),s.NdJ("select",function(e){return s.CHM(t),s.oxw().onChartBarSelected(e)})("mouseup",function(e){return s.CHM(t),s.oxw().onChartMouseUp(e)}),s.YNc(1,nc,7,7,"ng-template",null,11,s.W1O),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("view",t.view)("results",t.feeReportData)("gradient",!1)("xAxis",!0)("yAxis",!0)("showXAxisLabel",!0)("showYAxisLabel",t.showYAxisLabel)("xAxisLabel",t.xAxisLabel)("yAxisLabel",t.yAxisLabel)("showGridLines",!1)("showDataLabel",!1)}}function ic(t,e){if(1&t&&s._UZ(0,"rtl-ecl-forwarding-history",13),2&t){const t=s.oxw();s.Q6J("eventsData",t.filteredEventsBySelectedPeriod)("filterValue",t.eventFilterValue)}}let oc=(()=>{class t{constructor(t,e,n){this.logger=t,this.commonService=e,this.store=n,this.reportPeriod=f.op[0],this.secondsInADay=86400,this.events=[],this.filteredEventsBySelectedPeriod=[],this.eventFilterValue="",this.totalFeeSat=null,this.today=new Date(Date.now()),this.startDate=new Date(this.today.getFullYear(),this.today.getMonth(),1,0,0,0),this.endDate=new Date(this.today.getFullYear(),this.today.getMonth(),this.getMonthDays(this.today.getMonth(),this.today.getFullYear()),23,59,59),this.feeReportData=[],this.view=[350,350],this.screenPaddingX=100,this.gradient=!0,this.xAxisLabel="Date",this.yAxisLabel="Fee (Sats)",this.showYAxisLabel=!0,this.screenSize="",this.screenSizeEnum=f.cu,this.unSubs=[new d.x,new d.x]}ngOnInit(){this.screenSize=this.commonService.getScreenSize(),this.showYAxisLabel=!(this.screenSize===f.cu.XS||this.screenSize===f.cu.SM),this.store.select(x.PP).pipe((0,p.R)(this.unSubs[0])).subscribe(t=>{this.events=t.payments&&t.payments.relayed?t.payments.relayed:[],this.filterForwardingEvents(this.startDate,this.endDate),this.logger.info(t)})}ngAfterContentInit(){const t=this.commonService.getContainerSize();switch(this.screenSize){case f.cu.MD:this.screenPaddingX=t.width/10;break;case f.cu.LG:this.screenPaddingX=t.width/16;break;default:this.screenPaddingX=t.width/20}this.view=[t.width-this.screenPaddingX,t.height/2.2]}filterForwardingEvents(t,e){const n=Math.round(t.getTime()/1e3),a=Math.round(e.getTime()/1e3);this.logger.info("Filtering Forwarding Events Starting at "+new Date(Date.now()).toLocaleString()+" From "+t.toLocaleString()+" To "+e.toLocaleString()),this.filteredEventsBySelectedPeriod=[],this.feeReportData=[],this.totalFeeSat=null,this.events&&this.events.length>0&&(this.events.forEach(t=>{Math.floor(t.timestamp/1e3)>=n&&Math.floor(t.timestamp/1e3)<a&&this.filteredEventsBySelectedPeriod.push(t)}),this.feeReportData=this.prepareFeeReport(t)),this.logger.info("Filtering Forwarding Events Finished at "+new Date(Date.now()).toLocaleString())}onChartMouseUp(t){"svg"===t.srcElement.tagName&&t.srcElement.classList.length>0&&"ngx-charts"===t.srcElement.classList[0]&&(this.eventFilterValue="")}onChartBarSelected(t){this.eventFilterValue=this.reportPeriod===f.op[1]?t.name+"/"+this.startDate.getFullYear():t.name.toString().padStart(2,"0")+"/"+f.gg[this.startDate.getMonth()].name+"/"+this.startDate.getFullYear()}prepareFeeReport(t){const e=Math.round(t.getTime()/1e3),n=[];if(this.logger.info("Fee Report Prepare Starting at "+new Date(Date.now()).toLocaleString()+" From "+t.toLocaleString()),this.reportPeriod===f.op[1]){for(let t=0;t<12;t++)n.push({name:f.gg[t].name,value:1e-9,extra:{totalEvents:0}});this.filteredEventsBySelectedPeriod.map(t=>{const e=new Date(t.timestamp).getMonth();return n[e].value=n[e].value+(t.amountIn-t.amountOut),n[e].extra.totalEvents=n[e].extra.totalEvents+1,this.totalFeeSat=(this.totalFeeSat?this.totalFeeSat:0)+(t.amountIn-t.amountOut),this.filteredEventsBySelectedPeriod})}else{for(let e=0;e<this.getMonthDays(t.getMonth(),t.getFullYear());e++)n.push({name:e+1,value:1e-9,extra:{totalEvents:0}});this.filteredEventsBySelectedPeriod.map(t=>{const a=Math.floor((Math.floor(t.timestamp/1e3)-e)/this.secondsInADay);return n[a].value=n[a].value+(t.amountIn-t.amountOut),n[a].extra.totalEvents=n[a].extra.totalEvents+1,this.totalFeeSat=(this.totalFeeSat?this.totalFeeSat:0)+(t.amountIn-t.amountOut),this.filteredEventsBySelectedPeriod})}return this.logger.info("Fee Report Prepare Finished at "+new Date(Date.now()).toLocaleString()),n}onSelectionChange(t){const e=t.selDate.getMonth(),n=t.selDate.getFullYear();this.reportPeriod=t.selScrollRange,this.reportPeriod===f.op[1]?(this.startDate=new Date(n,0,1,0,0,0),this.endDate=new Date(n,11,31,23,59,59)):(this.startDate=new Date(n,e,1,0,0,0),this.endDate=new Date(n,e,this.getMonthDays(e,n),23,59,59)),this.filterForwardingEvents(this.startDate,this.endDate),this.eventFilterValue=""}getMonthDays(t,e){return 1===t&&e%4==0?f.gg[t].days+1:f.gg[t].days}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(Z.mQ),s.Y36(A.v),s.Y36(y.yh))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-fee-report"]],hostBindings:function(t,e){1&t&&s.NdJ("mouseup",function(t){return e.onChartMouseUp(t)})},decls:9,vars:4,consts:[["fxLayout","column","fxLayoutAlign","start stretch","fxFlex","100",1,"padding-gap-x-large"],[3,"stepChanged"],["fxLayout","column","fxLayoutAlign","start stretch","fxFlex","100",1,"padding-gap-x"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100","class","font-size-120 font-bold-700 mt-1",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100","class","font-size-120 mt-1",4,"ngIf"],[1,"mt-1"],["class","one-color",3,"view","results","gradient","xAxis","yAxis","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","showGridLines","showDataLabel","select","mouseup",4,"ngIf"],[3,"eventsData","filterValue",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100",1,"font-size-120","font-bold-700","mt-1"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100",1,"font-size-120","mt-1"],[1,"one-color",3,"view","results","gradient","xAxis","yAxis","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","showGridLines","showDataLabel","select","mouseup"],["tooltipTemplate",""],[1,"tooltip-label"],[3,"eventsData","filterValue"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"rtl-horizontal-scroller",1),s.NdJ("stepChanged",function(t){return e.onSelectionChange(t)}),s.qZA(),s.TgZ(2,"div",2),s.YNc(3,tc,4,8,"div",3),s.YNc(4,ec,2,0,"div",4),s.TgZ(5,"div",5),s.YNc(6,ac,3,11,"ngx-charts-bar-vertical",6),s.qZA(),s.TgZ(7,"div",5),s.YNc(8,ic,1,2,"rtl-ecl-forwarding-history",7),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("ngIf",e.feeReportData.length>0&&e.filteredEventsBySelectedPeriod.length>0),s.xp6(1),s.Q6J("ngIf",e.feeReportData.length<=0||e.filteredEventsBySelectedPeriod.length<=0),s.xp6(2),s.Q6J("ngIf",e.feeReportData.length>0&&e.filteredEventsBySelectedPeriod.length>0),s.xp6(2),s.Q6J("ngIf",e.filteredEventsBySelectedPeriod.length>0))},directives:[l.xw,l.Wh,l.yH,Kr.D,a.O5,jr.K$,jl],pipes:[a.JJ],styles:[""],data:{animation:[Wr.J]}}),t})();var sc=n(6590);function lc(t,e){if(1&t&&(s.TgZ(0,"div",10),s._uU(1),s.ALo(2,"number"),s.ALo(3,"number"),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.AsE(" Paid ",s.xi3(2,2,t.transactionsReportSummary.amountPaidSelectedPeriod||0,"1.0-2")," Sats/",s.lcZ(3,5,t.transactionsReportSummary.paymentsSelectedPeriod)," Payments ")}}function rc(t,e){if(1&t&&(s.TgZ(0,"div",10),s._uU(1),s.ALo(2,"number"),s.ALo(3,"number"),s.qZA()),2&t){const t=s.oxw(2);s.xp6(1),s.AsE(" Received ",s.xi3(2,2,t.transactionsReportSummary.amountReceivedSelectedPeriod||0,"1.0-2")," Sats/",s.lcZ(3,5,t.transactionsReportSummary.invoicesSelectedPeriod)," Invoices ")}}function cc(t,e){if(1&t&&(s.TgZ(0,"div",8),s.YNc(1,lc,4,7,"div",9),s.YNc(2,rc,4,7,"div",9),s.qZA()),2&t){const t=s.oxw();s.Q6J("@fadeIn",t.transactionsReportSummary),s.xp6(1),s.Q6J("ngIf",t.transactionsReportSummary.paymentsSelectedPeriod),s.xp6(1),s.Q6J("ngIf",t.transactionsReportSummary.invoicesSelectedPeriod)}}function uc(t,e){1&t&&(s.TgZ(0,"div",11),s._uU(1,"No transactions report for the selected period"),s.qZA())}function dc(t,e){if(1&t&&(s.TgZ(0,"span",14),s._uU(1),s.ALo(2,"number"),s.ALo(3,"number"),s.qZA()),2&t){const t=e.model;s.xp6(1),s.HOy("",t.name,": ",s.xi3(2,4,t.value||0,"1.0-2"),"/# ","Paid"===t.name?"Payments":"Invoices",": ",s.lcZ(3,7,(null==t.extra?null:t.extra.total)||0),"")}}function pc(t,e){if(1&t){const t=s.EpF();s.TgZ(0,"ngx-charts-bar-vertical-2d",12),s.NdJ("select",function(e){return s.CHM(t),s.oxw().onChartBarSelected(e)})("mouseup",function(e){return s.CHM(t),s.oxw().onChartMouseUp(e)}),s.YNc(1,dc,4,9,"ng-template",null,13,s.W1O),s.qZA()}if(2&t){const t=s.oxw();s.Q6J("view",t.view)("results",t.transactionsReportData)("noBarWhenZero",!1)("gradient",!1)("xAxis",!0)("yAxis",!0)("showXAxisLabel",!0)("showYAxisLabel",t.showYAxisLabel)("xAxisLabel",t.xAxisLabel)("yAxisLabel",t.yAxisLabel)("showGridLines",!1)("showDataLabel",!1)("groupPadding",t.reportPeriod===t.scrollRanges[0]?2:8)}}function mc(t,e){if(1&t&&s._UZ(0,"rtl-transactions-report-table",15),2&t){const t=s.oxw();s.Q6J("dataList",t.transactionsNonZeroReportData)("dataRange",t.reportPeriod)("filterValue",t.transactionFilterValue)}}let hc=(()=>{class t{constructor(t,e){this.commonService=t,this.store=e,this.scrollRanges=f.op,this.reportPeriod=f.op[0],this.secondsInADay=86400,this.payments=[],this.invoices=[],this.transactionsReportSummary={paymentsSelectedPeriod:0,invoicesSelectedPeriod:0,amountPaidSelectedPeriod:0,amountReceivedSelectedPeriod:0},this.transactionFilterValue="",this.today=new Date(Date.now()),this.startDate=new Date(this.today.getFullYear(),this.today.getMonth(),1,0,0,0),this.endDate=new Date(this.today.getFullYear(),this.today.getMonth(),this.getMonthDays(this.today.getMonth(),this.today.getFullYear()),23,59,59),this.transactionsReportData=[],this.transactionsNonZeroReportData=[],this.view=[350,350],this.screenPaddingX=100,this.gradient=!0,this.xAxisLabel="Date",this.yAxisLabel="Amount (Sats)",this.showYAxisLabel=!0,this.screenSize="",this.screenSizeEnum=f.cu,this.unSubs=[new d.x,new d.x]}ngOnInit(){this.screenSize=this.commonService.getScreenSize(),this.showYAxisLabel=!(this.screenSize===f.cu.XS||this.screenSize===f.cu.SM),this.store.select(x.PP).pipe((0,p.R)(this.unSubs[0]),(0,m.M)(this.store.select(x.Ef))).subscribe(([t,e])=>{this.payments=t.payments.sent?t.payments.sent:[],this.invoices=e.invoices?e.invoices:[],(this.payments.length>0||this.invoices.length>0)&&(this.transactionsReportData=this.filterTransactionsForSelectedPeriod(this.startDate,this.endDate),this.transactionsNonZeroReportData=this.prepareTableData())})}ngAfterContentInit(){const t=this.commonService.getContainerSize();switch(this.screenSize){case f.cu.MD:this.screenPaddingX=t.width/10;break;case f.cu.LG:this.screenPaddingX=t.width/16;break;default:this.screenPaddingX=t.width/20}this.view=[t.width-this.screenPaddingX,t.height/2.2]}onChartMouseUp(t){"svg"===t.srcElement.tagName&&t.srcElement.classList.length>0&&"ngx-charts"===t.srcElement.classList[0]&&(this.transactionFilterValue="")}onChartBarSelected(t){this.transactionFilterValue=this.reportPeriod===f.op[1]?t.series.toString()+"/"+this.startDate.getFullYear():t.series.toString().padStart(2,"0")+"/"+f.gg[this.startDate.getMonth()].name+"/"+this.startDate.getFullYear()}filterTransactionsForSelectedPeriod(t,e){const n=Math.round(t.getTime()/1e3),a=Math.round(e.getTime()/1e3),i=[];this.transactionsReportSummary={paymentsSelectedPeriod:0,invoicesSelectedPeriod:0,amountPaidSelectedPeriod:0,amountReceivedSelectedPeriod:0};const o=this.payments.filter(t=>Math.floor(t.firstPartTimestamp/1e3)>=n&&Math.floor(t.firstPartTimestamp/1e3)<a),s=this.invoices.filter(t=>"received"===t.status&&t.timestamp>=n&&t.timestamp<a);if(this.transactionsReportSummary.paymentsSelectedPeriod=o.length,this.transactionsReportSummary.invoicesSelectedPeriod=s.length,this.reportPeriod===f.op[1]){for(let e=0;e<12;e++)i.push({name:f.gg[e].name,date:new Date(t.getFullYear(),e,1,0,0,0,0),series:[{name:"Paid",value:0,extra:{total:0}},{name:"Received",value:0,extra:{total:0}}]});o.map(t=>{const e=new Date(t.firstPartTimestamp).getMonth();return this.transactionsReportSummary.amountPaidSelectedPeriod=this.transactionsReportSummary.amountPaidSelectedPeriod+t.recipientAmount,i[e].series[0].value=i[e].series[0].value+t.recipientAmount,i[e].series[0].extra.total=i[e].series[0].extra.total+1,this.transactionsReportSummary}),s.map(t=>{const e=new Date(1e3*t.timestamp).getMonth();return this.transactionsReportSummary.amountReceivedSelectedPeriod=this.transactionsReportSummary.amountReceivedSelectedPeriod+t.amountSettled,i[e].series[1].value=i[e].series[1].value+t.amountSettled,i[e].series[1].extra.total=i[e].series[1].extra.total+1,this.transactionsReportSummary})}else{for(let e=0;e<this.getMonthDays(t.getMonth(),t.getFullYear());e++)i.push({name:(e+1).toString(),date:new Date(1e3*(e*this.secondsInADay+n)),series:[{name:"Paid",value:0,extra:{total:0}},{name:"Received",value:0,extra:{total:0}}]});o.map(t=>{const e=Math.floor((Math.floor(t.firstPartTimestamp/1e3)-n)/this.secondsInADay);return this.transactionsReportSummary.amountPaidSelectedPeriod=this.transactionsReportSummary.amountPaidSelectedPeriod+t.recipientAmount,i[e].series[0].value=i[e].series[0].value+t.recipientAmount,i[e].series[0].extra.total=i[e].series[0].extra.total+1,this.transactionsReportSummary}),s.map(t=>{const e=Math.floor((t.timestamp-n)/this.secondsInADay);return this.transactionsReportSummary.amountReceivedSelectedPeriod=this.transactionsReportSummary.amountReceivedSelectedPeriod+t.amountSettled,i[e].series[1].value=i[e].series[1].value+t.amountSettled,i[e].series[1].extra.total=i[e].series[1].extra.total+1,this.transactionsReportSummary})}return i}prepareTableData(){return this.transactionsReportData.reduce((t,e)=>e.series[0].extra.total>0||e.series[1].extra.total>0?t.concat({date:e.date,amount_paid:e.series[0].value,num_payments:e.series[0].extra.total,amount_received:e.series[1].value,num_invoices:e.series[1].extra.total}):t,[])}onSelectionChange(t){const e=t.selDate.getMonth(),n=t.selDate.getFullYear();this.reportPeriod=t.selScrollRange,this.reportPeriod===f.op[1]?(this.startDate=new Date(n,0,1,0,0,0),this.endDate=new Date(n,11,31,23,59,59)):(this.startDate=new Date(n,e,1,0,0,0),this.endDate=new Date(n,e,this.getMonthDays(e,n),23,59,59)),this.transactionsReportData=this.filterTransactionsForSelectedPeriod(this.startDate,this.endDate),this.transactionsNonZeroReportData=this.prepareTableData(),this.transactionFilterValue=""}getMonthDays(t,e){return 1===t&&e%4==0?f.gg[t].days+1:f.gg[t].days}ngOnDestroy(){this.unSubs.forEach(t=>{t.next(null),t.complete()})}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(A.v),s.Y36(y.yh))},t.\u0275cmp=s.Xpm({type:t,selectors:[["rtl-ecl-transactions-report"]],hostBindings:function(t,e){1&t&&s.NdJ("mouseup",function(t){return e.onChartMouseUp(t)})},decls:9,vars:4,consts:[["fxLayout","column","fxLayoutAlign","start stretch","fxFlex","100",1,"padding-gap-x-large"],[3,"stepChanged"],["fxLayout","column","fxLayoutAlign","start stretch","fxFlex","100",1,"padding-gap-x"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100","class","font-size-120 font-bold-700 mt-1",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100","class","font-size-120 mt-1",4,"ngIf"],[1,"mt-1"],["class","two-color",3,"view","results","noBarWhenZero","gradient","xAxis","yAxis","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","showGridLines","showDataLabel","groupPadding","select","mouseup",4,"ngIf"],[3,"dataList","dataRange","filterValue",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100",1,"font-size-120","font-bold-700","mt-1"],["fxLayout","row","fxLayoutAlign","start stretch","fxFlex","100",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start stretch","fxFlex","100"],["fxLayout","column","fxLayoutAlign","center center","fxFlex","100",1,"font-size-120","mt-1"],[1,"two-color",3,"view","results","noBarWhenZero","gradient","xAxis","yAxis","showXAxisLabel","showYAxisLabel","xAxisLabel","yAxisLabel","showGridLines","showDataLabel","groupPadding","select","mouseup"],["tooltipTemplate",""],[1,"tooltip-label"],[3,"dataList","dataRange","filterValue"]],template:function(t,e){1&t&&(s.TgZ(0,"div",0),s.TgZ(1,"rtl-horizontal-scroller",1),s.NdJ("stepChanged",function(t){return e.onSelectionChange(t)}),s.qZA(),s.TgZ(2,"div",2),s.YNc(3,cc,3,3,"div",3),s.YNc(4,uc,2,0,"div",4),s.TgZ(5,"div",5),s.YNc(6,pc,3,13,"ngx-charts-bar-vertical-2d",6),s.qZA(),s.TgZ(7,"div",5),s.YNc(8,mc,1,3,"rtl-transactions-report-table",7),s.qZA(),s.qZA(),s.qZA()),2&t&&(s.xp6(3),s.Q6J("ngIf",e.transactionsNonZeroReportData.length>0),s.xp6(1),s.Q6J("ngIf",e.transactionsNonZeroReportData.length<=0),s.xp6(2),s.Q6J("ngIf",e.transactionsNonZeroReportData.length>0),s.xp6(2),s.Q6J("ngIf",e.transactionsNonZeroReportData.length>0))},directives:[l.xw,l.Wh,l.yH,Kr.D,a.O5,jr.H5,sc.g],pipes:[a.JJ],styles:[""],data:{animation:[Wr.J]}}),t})();var gc=n(6013),fc=n(8016);const xc=i.Bz.forChild([{path:"",component:u,children:[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",component:Gn,canActivate:[gc.fY]},{path:"onchain",component:Da,canActivate:[gc.fY],children:[{path:"",pathMatch:"full",redirectTo:"receive"},{path:"receive",component:di,canActivate:[gc.fY]},{path:"send",component:pi,canActivate:[gc.fY]}]},{path:"connections",component:ka,canActivate:[gc.fY],children:[{path:"",pathMatch:"full",redirectTo:"channels"},{path:"channels",component:Ui,canActivate:[gc.fY],children:[{path:"",pathMatch:"full",redirectTo:"open"},{path:"open",component:wo,canActivate:[gc.fY]},{path:"pending",component:zo,canActivate:[gc.fY]},{path:"inactive",component:Sl,canActivate:[gc.fY]}]},{path:"peers",component:Us,data:{sweepAll:!1},canActivate:[gc.fY]}]},{path:"transactions",component:Ea,canActivate:[gc.fY],children:[{path:"",pathMatch:"full",redirectTo:"payments"},{path:"payments",component:Cn,canActivate:[gc.fY]},{path:"invoices",component:ue,canActivate:[gc.fY]},{path:"queryroutes",component:Gs,canActivate:[gc.fY]}]},{path:"routing",component:Ja,canActivate:[gc.fY],children:[{path:"",pathMatch:"full",redirectTo:"forwardinghistory"},{path:"forwardinghistory",component:jl,canActivate:[gc.fY]},{path:"peers",component:Gr,canActivate:[gc.fY]}]},{path:"reports",component:$r,canActivate:[gc.fY],children:[{path:"",pathMatch:"full",redirectTo:"routingfees"},{path:"routingfees",component:oc,canActivate:[gc.fY]},{path:"transactions",component:hc,canActivate:[gc.fY]}]},{path:"lookups",component:ci,canActivate:[gc.fY]},{path:"**",component:fc.w}]}]);var Zc=n(253);let yc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=s.oAB({type:t,bootstrap:[u]}),t.\u0275inj=s.cJS({providers:[gc.fY],imports:[[a.ez,Zc.m,xc]]}),t})()}}]);